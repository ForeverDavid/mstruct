<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>ObjCryst++: ObjCryst::PowderPatternBackgroundBayesianMinimiser Class Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">ObjCryst++
   &#160;<span id="projectnumber">1.5CVS</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="a00171.html">ObjCryst</a>      </li>
      <li class="navelem"><a class="el" href="a00064.html">PowderPatternBackgroundBayesianMinimiser</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a>  </div>
  <div class="headertitle">
<div class="title">ObjCryst::PowderPatternBackgroundBayesianMinimiser Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<!-- doxytag: class="ObjCryst::PowderPatternBackgroundBayesianMinimiser" --><!-- doxytag: inherits="ObjCryst::RefinableObj" -->
<p>This object is used to estimate the background in a powder pattern, using a Bayesian approach (David &amp; Sivia, Acta Cryst A50 (1994), 703)  
 <a href="a00064.html#details">More...</a></p>
<div class="dynheader">
Inheritance diagram for ObjCryst::PowderPatternBackgroundBayesianMinimiser:</div>
<div class="dyncontent">
 <div class="center">
  <img src="a00064.png" usemap="#ObjCryst::PowderPatternBackgroundBayesianMinimiser_map" alt=""/>
  <map id="ObjCryst::PowderPatternBackgroundBayesianMinimiser_map" name="ObjCryst::PowderPatternBackgroundBayesianMinimiser_map">
<area href="a00071.html" title="Generic Refinable Object." alt="ObjCryst::RefinableObj" shape="rect" coords="0,0,325,24"/>
</map>
 </div></div>

<p><a href="a00283.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a38fecc6393f5feed3dd22e585d2fd708"></a><!-- doxytag: member="ObjCryst::PowderPatternBackgroundBayesianMinimiser::PowderPatternBackgroundBayesianMinimiser" ref="a38fecc6393f5feed3dd22e585d2fd708" args="(PowderPatternBackground &amp;backgd)" -->
&#160;</td><td class="memItemRight" valign="bottom"><b>PowderPatternBackgroundBayesianMinimiser</b> (<a class="el" href="a00063.html">PowderPatternBackground</a> &amp;backgd)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual const string &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00064.html#a7f39f799fafc12a3bdb937b5cc9545ad">GetClassName</a> () const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Name for this class ("RefinableObj", "Crystal",...).  <a href="#a7f39f799fafc12a3bdb937b5cc9545ad"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual REAL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00064.html#a515e6c16b8900dd4360bcae023ebbd38">GetLogLikelihood</a> () const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Get -log(likelihood) of the current configuration for the object.  <a href="#a515e6c16b8900dd4360bcae023ebbd38"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static REAL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00064.html#ade871cf6919b2b3fa572d6a073b4c664">BayesianBackgroundLogLikelihood</a> (const REAL t)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the log(likelihood) of a background by marginalizing the effect of Bragg peaks, following the method described by David and Sivia (<em>J.Appl.Cryst</em>.  <a href="#ade871cf6919b2b3fa572d6a073b4c664"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab87e1261cd1824365908c4d67e9d696e"></a><!-- doxytag: member="ObjCryst::PowderPatternBackgroundBayesianMinimiser::mpBackground" ref="ab87e1261cd1824365908c4d67e9d696e" args="" -->
<a class="el" href="a00063.html">PowderPatternBackground</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>mpBackground</b></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>This object is used to estimate the background in a powder pattern, using a Bayesian approach (David &amp; Sivia, Acta Cryst A50 (1994), 703) </p>
</div><hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="ade871cf6919b2b3fa572d6a073b4c664"></a><!-- doxytag: member="ObjCryst::PowderPatternBackgroundBayesianMinimiser::BayesianBackgroundLogLikelihood" ref="ade871cf6919b2b3fa572d6a073b4c664" args="(const REAL t)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static REAL <a class="el" href="a00064.html#ade871cf6919b2b3fa572d6a073b4c664">ObjCryst::PowderPatternBackgroundBayesianMinimiser::BayesianBackgroundLogLikelihood</a> </td>
          <td>(</td>
          <td class="paramtype">const REAL&#160;</td>
          <td class="paramname"><em>t</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns the log(likelihood) of a background by marginalizing the effect of Bragg peaks, following the method described by David and Sivia (<em>J.Appl.Cryst</em>. </p>
<p><b>34</b>(2001), 318).</p>
<dl class="return"><dt><b>Returns:</b></dt><dd><ul>
<li><img class="formulaInl" alt="$ L(t) = \frac{\left(y^{calc}_{Background}-y^{obs}\right)^2}{2\sigma^2}$" src="form_22.png"/> for &lt;0</li>
<li><img class="formulaInl" alt="$ L(t) = A-\log{\int_\epsilon^{\infty} {\frac{1}{u} e^{-(t-u)^2} du}}$" src="form_23.png"/> for t&gt;0, with: <img class="formulaInl" alt="$\epsilon = 1e-6$" src="form_24.png"/>, <img class="formulaInl" alt="$ t = \frac{y^{calc}_{Background}-y^{obs}}{\sigma\sqrt{2}}$" src="form_25.png"/> and A a normalizing constant so that the function is continuous for t=0 (i.e. <em>L(0)=0</em>).</li>
</ul>
</dd></dl>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramtype">\form</td><td class="paramname">25</td><td>For small <em>t&gt;0</em> values, <em>L(t)</em> behaves like a quadratic function, and for large positive values it is equivalent to <img class="formulaInl" alt="$ \log{\frac{\sqrt{\pi}}{t}}$" src="form_26.png"/>.</td></tr>
  </table>
  </dd>
</dl>
<p>As the integral diverges for <img class="formulaInl" alt="$\epsilon=0$" src="form_27.png"/>, it is necessary to use a small, non-null <img class="formulaInl" alt="$\epsilon$" src="form_28.png"/>. The use of a smaller <img class="formulaInl" alt="$\epsilon$" src="form_28.png"/> changes the range over which the function behaves quadratically, as well as the maximum value (at <em>t=0</em>), but does not affect the asymptotic value.</p>
<p>See tabulated values in the source code. The function is approximated with a cubic spline until <em>t=8</em>, and then uses the asymptotic <img class="formulaInl" alt="$A-\log{\frac{\sqrt{\pi}}{t}}$" src="form_29.png"/> value.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>For a more strict calculation, we should include a normalizing constant (?) </dd></dl>

</div>
</div>
<a class="anchor" id="a7f39f799fafc12a3bdb937b5cc9545ad"></a><!-- doxytag: member="ObjCryst::PowderPatternBackgroundBayesianMinimiser::GetClassName" ref="a7f39f799fafc12a3bdb937b5cc9545ad" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual const string&amp; <a class="el" href="a00064.html#a7f39f799fafc12a3bdb937b5cc9545ad">ObjCryst::PowderPatternBackgroundBayesianMinimiser::GetClassName</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Name for this class ("RefinableObj", "Crystal",...). </p>
<p>This is only useful to distinguish different classes when picking up objects from the <a class="el" href="a00071.html" title="Generic Refinable Object.">RefinableObj</a> Global Registry </p>

<p>Reimplemented from <a class="el" href="a00071.html#a62968d90a7a3080738b363934616c019">ObjCryst::RefinableObj</a>.</p>

</div>
</div>
<a class="anchor" id="a515e6c16b8900dd4360bcae023ebbd38"></a><!-- doxytag: member="ObjCryst::PowderPatternBackgroundBayesianMinimiser::GetLogLikelihood" ref="a515e6c16b8900dd4360bcae023ebbd38" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual REAL <a class="el" href="a00064.html#a515e6c16b8900dd4360bcae023ebbd38">ObjCryst::PowderPatternBackgroundBayesianMinimiser::GetLogLikelihood</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get -log(likelihood) of the current configuration for the object. </p>
<p>By default (no likelihood evaluation available), this is equal to 0.</p>
<p>This call should not be recursive, it is the task of the algorithm to get the sum of likelihoods for all objects invlolved.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>contrary to the old "Cost Function" approach, with log(Likelihood) there is no 'choice' of cost function, so that it is the task of the object to give the optimized likelihood (possibly with user options).</dd></dl>
<dl class="warning"><dt><b>Warning:</b></dt><dd>: this is in under heavy development, so expect changes... </dd></dl>

<p>Reimplemented from <a class="el" href="a00071.html#a9a9a5ea2b997cd36b44ed35c2bab3245">ObjCryst::RefinableObj</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>PowderPatternBackgroundBayesianMinimiser.h</li>
</ul>
</div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Tue Apr 3 2012 18:19:58 for ObjCryst++ by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
