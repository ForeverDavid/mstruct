<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>ObjCryst++: ObjCryst::DiffractionDataSingleCrystal Class Reference</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">ObjCryst++
   &#160;<span id="projectnumber">1.5CVS</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="a00171.html">ObjCryst</a>      </li>
      <li class="navelem"><a class="el" href="a00026.html">DiffractionDataSingleCrystal</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a>  </div>
  <div class="headertitle">
<div class="title">ObjCryst::DiffractionDataSingleCrystal Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<!-- doxytag: class="ObjCryst::DiffractionDataSingleCrystal" --><!-- doxytag: inherits="ObjCryst::ScatteringData" -->
<p>DiffractionData object for Single <a class="el" href="a00020.html" title="Crystal class: Unit cell, spacegroup, scatterers.">Crystal</a> analysis.  
 <a href="a00026.html#details">More...</a></p>
<div class="dynheader">
Inheritance diagram for ObjCryst::DiffractionDataSingleCrystal:</div>
<div class="dyncontent">
 <div class="center">
  <img src="a00026.png" usemap="#ObjCryst::DiffractionDataSingleCrystal_map" alt=""/>
  <map id="ObjCryst::DiffractionDataSingleCrystal_map" name="ObjCryst::DiffractionDataSingleCrystal_map">
<area href="a00089.html" title="Class to compute structure factors for a set of reflections and a Crystal." alt="ObjCryst::ScatteringData" shape="rect" coords="0,56,228,80"/>
<area href="a00071.html" title="Generic Refinable Object." alt="ObjCryst::RefinableObj" shape="rect" coords="0,0,228,24"/>
</map>
 </div></div>

<p><a href="a00246.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#ab182bcffdd5cded6e7bd536bc71a3241">DiffractionDataSingleCrystal</a> (const bool regist=true)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Default constructor.  <a href="#ab182bcffdd5cded6e7bd536bc71a3241"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#a3fcfa9d8f263043025d4167001c2243f">DiffractionDataSingleCrystal</a> (<a class="el" href="a00020.html">Crystal</a> &amp;cryst, const bool regist=true)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor, with an assigned crystal structure.  <a href="#a3fcfa9d8f263043025d4167001c2243f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2fbe3262e7146a0c1057da102d0a9046"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::DiffractionDataSingleCrystal" ref="a2fbe3262e7146a0c1057da102d0a9046" args="(const DiffractionDataSingleCrystal &amp;old)" -->
&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#a2fbe3262e7146a0c1057da102d0a9046">DiffractionDataSingleCrystal</a> (const <a class="el" href="a00026.html">DiffractionDataSingleCrystal</a> &amp;old)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Copy constructor. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a49d006a0476d72570352e1d169200845"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::CreateCopy" ref="a49d006a0476d72570352e1d169200845" args="() const " -->
virtual <br class="typebreak"/>
<a class="el" href="a00026.html">DiffractionDataSingleCrystal</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#a49d006a0476d72570352e1d169200845">CreateCopy</a> () const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">So-called virtual copy constructor. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual const string &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#a05b1f448a143ad61036f001d09a3509f">GetClassName</a> () const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Name for this class ("RefinableObj", "Crystal",...).  <a href="#a05b1f448a143ad61036f001d09a3509f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const CrystVector_REAL &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#a5aade79d8baf1b770ab82af93fd244e6">GetIcalc</a> () const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">returns the calculated diffracted intensity.  <a href="#a5aade79d8baf1b770ab82af93fd244e6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a75e80d760a8f540aae7a0b678f3d60c6"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::GetIobs" ref="a75e80d760a8f540aae7a0b678f3d60c6" args="() const " -->
const CrystVector_REAL &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#a75e80d760a8f540aae7a0b678f3d60c6">GetIobs</a> () const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the array of observed intensities for all peaks. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aaa8dd9fa1a0f7b3b050c96540992cea1"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::SetIobs" ref="aaa8dd9fa1a0f7b3b050c96540992cea1" args="(const CrystVector_REAL &amp;)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#aaa8dd9fa1a0f7b3b050c96540992cea1">SetIobs</a> (const CrystVector_REAL &amp;)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the array of observed intensities for all peaks. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aad718f90b34f9a544ba86d5f8b02f46b"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::GetSigma" ref="aad718f90b34f9a544ba86d5f8b02f46b" args="() const " -->
const CrystVector_REAL &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#aad718f90b34f9a544ba86d5f8b02f46b">GetSigma</a> () const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the array of sigmas for observed intensities, for all peaks. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="afec714c8df5dc6a7cf68858dbf70742b"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::SetSigma" ref="afec714c8df5dc6a7cf68858dbf70742b" args="(const CrystVector_REAL &amp;)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#afec714c8df5dc6a7cf68858dbf70742b">SetSigma</a> (const CrystVector_REAL &amp;)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the array of sigmas for observed intensities, for all peaks. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa741c9f638e305ca800cf4ce0e31a615"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::SetIobsToIcalc" ref="aa741c9f638e305ca800cf4ce0e31a615" args="()" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#aa741c9f638e305ca800cf4ce0e31a615">SetIobsToIcalc</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Set Iobs to current values of Icalc. Mostly used for tests. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab602d46a7bb6020229b2f8587171ae6a"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::GetWeight" ref="ab602d46a7bb6020229b2f8587171ae6a" args="() const " -->
const CrystVector_REAL &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#ab602d46a7bb6020229b2f8587171ae6a">GetWeight</a> () const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the weights (for each reflection) used for computing Rw. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad30750b0b14e9b01427c311af560705c"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::SetWeight" ref="ad30750b0b14e9b01427c311af560705c" args="(const CrystVector_REAL &amp;)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#ad30750b0b14e9b01427c311af560705c">SetWeight</a> (const CrystVector_REAL &amp;)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Change the weights (for each reflection) used for computing Rw. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#a0d13ab934c60c9bd0aebbb285a92c5cb">SetHklIobs</a> (const CrystVector_long &amp;h, const CrystVector_long &amp;k, const CrystVector_long &amp;l, const CrystVector_REAL &amp;iObs, const CrystVector_REAL &amp;sigma)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">input H,K,L, Iobs and Sigma  <a href="#a0d13ab934c60c9bd0aebbb285a92c5cb"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#ac306439389c8eab225dd8dd87aa8f189">ImportHklIobs</a> (const string &amp;fileName, const long nbRefl, const int skipLines=0)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Import h,k,l,I from a file.  <a href="#ac306439389c8eab225dd8dd87aa8f189"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#a041f22715b9b4d1f2beb2b7e387fa682">ImportHklIobsSigma</a> (const string &amp;fileName, const long nbRefl, const int skipLines=0)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Import h,k,l,I,Sigma from a file.  <a href="#a041f22715b9b4d1f2beb2b7e387fa682"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#a5721769a1b4a8e33664c3b0867c05086">ImportHklIobsSigmaJanaM91</a> (const string &amp;fileName)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Import h,k,l,I,Sigma from a Jana98 '*.m91' file.  <a href="#a5721769a1b4a8e33664c3b0867c05086"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#af590310eb70814be523947dc7ddc695c">ImportHklIobsGroup</a> (const string &amp;fileName, const unsigned int skipLines=0)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Import h,k,l and grouped intensities from a file.  <a href="#af590310eb70814be523947dc7ddc695c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual REAL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#addee789ac9e373d7080bd0fc395e68e8">GetRw</a> () const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the <a class="el" href="a00020.html" title="Crystal class: Unit cell, spacegroup, scatterers.">Crystal</a> R-factor (weighted)  <a href="#addee789ac9e373d7080bd0fc395e68e8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual REAL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#a52253e2e3a9e0e1a8200c6e042d6f8c9">GetR</a> () const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Return the <a class="el" href="a00020.html" title="Crystal class: Unit cell, spacegroup, scatterers.">Crystal</a> R-factor (unweighted)  <a href="#a52253e2e3a9e0e1a8200c6e042d6f8c9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual REAL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#a406a2e413ed8c0a6afd92f384246d36c">GetChi2</a> () const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Return conventionnal Chi^2.  <a href="#a406a2e413ed8c0a6afd92f384246d36c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#a82c8acf2a3f315091d97ad154a74e17b">FitScaleFactorForRw</a> () const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the best scale factor minimising Rw.  <a href="#a82c8acf2a3f315091d97ad154a74e17b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#a97e666eeeb9e3b97a36145415e3f959e">FitScaleFactorForR</a> () const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the best scale factor minimising R.  <a href="#a97e666eeeb9e3b97a36145415e3f959e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual REAL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#a9f4bedb3f24193c14a39ad97ef074948">GetBestRFactor</a> () const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the best scale factor to minimize R, apply this scale factor and return the R value obtained.  <a href="#a9f4bedb3f24193c14a39ad97ef074948"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#a55b89595cdd1305f69b725ba49dd9855">SetSigmaToSqrtIobs</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Set sigma for all observed intensities to sqrt(obs)  <a href="#a55b89595cdd1305f69b725ba49dd9855"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#a1b2bf6486f5030fa0cf59d057e8501b0">SetWeightToInvSigma2</a> (const REAL minRelatSigma=1e-4)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the weight for all observed intensities to 1/sigma^2.  <a href="#a1b2bf6486f5030fa0cf59d057e8501b0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a92da5b55bca84f7923d117e0794d9689"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::GetScaleFactor" ref="a92da5b55bca84f7923d117e0794d9689" args="() const " -->
REAL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#a92da5b55bca84f7923d117e0794d9689">GetScaleFactor</a> () const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Scale factor (applied to Icalc to match Iobs) <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#ad3c0c4361b81a2f7e786ed16968c6d88">PrintObsData</a> () const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Print H, K, L Iobs sigma for all reflections.  <a href="#ad3c0c4361b81a2f7e786ed16968c6d88"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a17da834176b793bc5edb3915f243a960"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::PrintObsCalcData" ref="a17da834176b793bc5edb3915f243a960" args="() const " -->
virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#a17da834176b793bc5edb3915f243a960">PrintObsCalcData</a> () const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Print H, K, L Iobs sigma Icalc for all reflections Iobs and sigma (if given) are scaled to Icalc (if available). <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="abfcedd24e1485124423b6e14aafb2b55"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::SetUseOnlyLowAngleData" ref="abfcedd24e1485124423b6e14aafb2b55" args="(const bool useOnlyLowAngle, const REAL angle=0.)" -->
virtual void&#160;</td><td class="memItemRight" valign="bottom"><b>SetUseOnlyLowAngleData</b> (const bool useOnlyLowAngle, const REAL angle=0.)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#af220156c564b8d602b0c05ba222fba03">SaveHKLIobsIcalc</a> (const string &amp;filename=&quot;hklIobsIcalc.out&quot;)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Save H,K,L Iobs Icalc to a file, text format, 3 columns theta Iobs Icalc.  <a href="#af220156c564b8d602b0c05ba222fba03"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#a9f19efd0a77a471666ddd5b4be421ffa">GlobalOptRandomMove</a> (const REAL mutationAmplitude, const <a class="el" href="a00080.html">RefParType</a> *type=<a class="el" href="a00171.html#a92ed37a804903dfb302d70309b7bc474">gpRefParTypeObjCryst</a>)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Make a random move of the current configuration.  <a href="#a9f19efd0a77a471666ddd5b4be421ffa"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual REAL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#ad42c5159763eb136fadfb653067d1a7b">GetLogLikelihood</a> () const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Get -log(likelihood) of the current configuration for the object.  <a href="#ad42c5159763eb136fadfb653067d1a7b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af3fbd99a3fc7abe6450d9adcb59fc314"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::GetNbLSQFunction" ref="af3fbd99a3fc7abe6450d9adcb59fc314" args="() const " -->
virtual unsigned int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#af3fbd99a3fc7abe6450d9adcb59fc314">GetNbLSQFunction</a> () const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of LSQ functions. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad13c33ef47af441539b95e11b6347054"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::GetLSQCalc" ref="ad13c33ef47af441539b95e11b6347054" args="(const unsigned int) const " -->
virtual const CrystVector_REAL &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#ad13c33ef47af441539b95e11b6347054">GetLSQCalc</a> (const unsigned int) const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the current calculated value for the LSQ function. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a339318a2481faa122f22fce3fce08a70"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::GetLSQObs" ref="a339318a2481faa122f22fce3fce08a70" args="(const unsigned int) const " -->
virtual const CrystVector_REAL &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#a339318a2481faa122f22fce3fce08a70">GetLSQObs</a> (const unsigned int) const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the observed values for the LSQ function. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab7ce20d0a0d849f2d0304c7abad11b7f"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::GetLSQWeight" ref="ab7ce20d0a0d849f2d0304c7abad11b7f" args="(const unsigned int) const " -->
virtual const CrystVector_REAL &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#ab7ce20d0a0d849f2d0304c7abad11b7f">GetLSQWeight</a> (const unsigned int) const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the weight values for the LSQ function. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#a59dadf9f6dedc3a84e858ee96268526e">XMLOutput</a> (ostream &amp;os, int indent=0) const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Output to stream in well-formed XML.  <a href="#a59dadf9f6dedc3a84e858ee96268526e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#a3b1edc7d3c612fa20cb658ef1d084c00">XMLInput</a> (istream &amp;is, const <a class="el" href="a00151.html">XMLCrystTag</a> &amp;tag)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Input From stream.  <a href="#a3b1edc7d3c612fa20cb658ef1d084c00"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a334973e747b95a62fb7b2fc67ebb40d3"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::GetRadiation" ref="a334973e747b95a62fb7b2fc67ebb40d3" args="() const " -->
virtual const <a class="el" href="a00069.html">Radiation</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#a334973e747b95a62fb7b2fc67ebb40d3">GetRadiation</a> () const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the radiation object for this data. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aaf39551c91d7849d49604012eba2a10c"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::GetRadiation" ref="aaf39551c91d7849d49604012eba2a10c" args="()" -->
<a class="el" href="a00069.html">Radiation</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>GetRadiation</b> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3c96d35001fef3833731910f4ed4690f"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::SetRadiationType" ref="a3c96d35001fef3833731910f4ed4690f" args="(const RadiationType radiation)" -->
virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#a3c96d35001fef3833731910f4ed4690f">SetRadiationType</a> (const <a class="el" href="a00171.html#a48fe50a094c607f8897378934d3d73ef">RadiationType</a> radiation)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Set : neutron or x-ray experiment ? Wavelength ? <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a19d588f3fd7ca539d89d87e7420438e1"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::SetWavelength" ref="a19d588f3fd7ca539d89d87e7420438e1" args="(const REAL)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#a19d588f3fd7ca539d89d87e7420438e1">SetWavelength</a> (const REAL)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the (monochromatic) wavelength of the beam. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#a231437207dca7389aa593b1fd4fd9f1b">SetWavelength</a> (const string &amp;XRayTubeElementName, const REAL alpha2Alpha2ratio=0.5)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">\ brief Set X-Ray tube radiation.  <a href="#a231437207dca7389aa593b1fd4fd9f1b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4fa3e393b4b643bd02d184c043954def"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::SetEnergy" ref="a4fa3e393b4b643bd02d184c043954def" args="(const REAL)" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#a4fa3e393b4b643bd02d184c043954def">SetEnergy</a> (const REAL)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the (monochromatic) energy of the beam. <br/></td></tr>
<tr><td colspan="2"><h2><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="afe663c6aa23f64956d0b985fea65a0a5"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::InitRefParList" ref="afe663c6aa23f64956d0b985fea65a0a5" args="()" -->
virtual void&#160;</td><td class="memItemRight" valign="bottom"><b>InitRefParList</b> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad8480ba2ebf761c8dafea7a8c05f2a33"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::CalcIcalc" ref="ad8480ba2ebf761c8dafea7a8c05f2a33" args="() const " -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#ad8480ba2ebf761c8dafea7a8c05f2a33">CalcIcalc</a> () const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calc intensities. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual CrystVector_long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#aeac660426ee4c5aa52d494b449a164f9">SortReflectionBySinThetaOverLambda</a> (const REAL maxTheta=-1.)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3eafc2c0206c365024f40d4302c1257f"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::InitOptions" ref="a3eafc2c0206c365024f40d4302c1257f" args="()" -->
void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#a3eafc2c0206c365024f40d4302c1257f">InitOptions</a> ()</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Init options (currently only twinning). <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#a7cc9b7b685ef9031f6e6176a5da1ed63">PrepareTwinningCalc</a> () const </td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine the index of reflections to be summed because of twinning (GroupOption==1) The reflections <em>must</em> have been sorted by increasing theta beforehand.  <a href="#a7cc9b7b685ef9031f6e6176a5da1ed63"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6509d08699c990b10bacae56e1c81da9"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::mHasObservedData" ref="a6509d08699c990b10bacae56e1c81da9" args="" -->
bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#a6509d08699c990b10bacae56e1c81da9">mHasObservedData</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Are there observed intensities ? <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">CrystVector_REAL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#a376708cee05a5d49ff22282748ef491b">mObsIntensity</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Observed intensity (after ABS and LP corrections)  <a href="#a376708cee05a5d49ff22282748ef491b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac944ecba535c9edb0c19adc503e014ec"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::mObsSigma" ref="ac944ecba535c9edb0c19adc503e014ec" args="" -->
CrystVector_REAL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#ac944ecba535c9edb0c19adc503e014ec">mObsSigma</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Sigma for observed intensities (either individual reflections or spectrum) <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5856abdb592d801b220d3833d9306d88"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::mWeight" ref="a5856abdb592d801b220d3833d9306d88" args="" -->
CrystVector_REAL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#a5856abdb592d801b220d3833d9306d88">mWeight</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">weight for computing R-Factor, for each observed value. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a41450ac0f53bff0e8672ac69a7f63795"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::mCalcIntensity" ref="a41450ac0f53bff0e8672ac69a7f63795" args="" -->
CrystVector_REAL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#a41450ac0f53bff0e8672ac69a7f63795">mCalcIntensity</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculated intensities. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">REAL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#a4de0d528fa61c01cff4a0c78f5f5f1c3">mScaleFactor</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Scale factor.  <a href="#a4de0d528fa61c01cff4a0c78f5f5f1c3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1ec5ae2f5102440a06f436c06938d78a"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::mChi2" ref="a1ec5ae2f5102440a06f436c06938d78a" args="" -->
REAL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#a1ec5ae2f5102440a06f436c06938d78a">mChi2</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Chi^2. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a92796e78d88ba827bc39fd9278ea0d2d"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::mClockIcalc" ref="a92796e78d88ba827bc39fd9278ea0d2d" args="" -->
<a class="el" href="a00072.html">RefinableObjClock</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#a92796e78d88ba827bc39fd9278ea0d2d">mClockIcalc</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Last time Icalc was computed. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a082df0e2c370d12dae3e84ca4be0c985"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::mClockScaleFactor" ref="a082df0e2c370d12dae3e84ca4be0c985" args="" -->
<a class="el" href="a00072.html">RefinableObjClock</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#a082df0e2c370d12dae3e84ca4be0c985">mClockScaleFactor</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Last modification of the scale factor. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a600bb857f6648a262adbaeae67acb119"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::mClockChi2" ref="a600bb857f6648a262adbaeae67acb119" args="" -->
<a class="el" href="a00072.html">RefinableObjClock</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#a600bb857f6648a262adbaeae67acb119">mClockChi2</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Clock the last time Chi^2 was computed. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2173fb98cd1d27617eb8305ef12ad607"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::mGroupOption" ref="a2173fb98cd1d27617eb8305ef12ad607" args="" -->
<a class="el" href="a00078.html">RefObjOpt</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#a2173fb98cd1d27617eb8305ef12ad607">mGroupOption</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Option for the type of grouping (0:no, 1:by theta values (twinning), 2:user-supplied groups) <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a40173c931093085373ad6fd304f202b8"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::mGroupIobs" ref="a40173c931093085373ad6fd304f202b8" args="" -->
CrystVector_REAL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#a40173c931093085373ad6fd304f202b8">mGroupIobs</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The observed intensities summed on all reflections that are (or could be) overlapped dur to a twinning. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac741c4954e3b89b81693c80afaec1576"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::mGroupSigma" ref="ac741c4954e3b89b81693c80afaec1576" args="" -->
CrystVector_REAL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#ac741c4954e3b89b81693c80afaec1576">mGroupSigma</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The uncertainty on observed grouped intensities. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a079d62283adb291b74d6c19e5d114eb4"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::mGroupIcalc" ref="a079d62283adb291b74d6c19e5d114eb4" args="" -->
CrystVector_REAL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#a079d62283adb291b74d6c19e5d114eb4">mGroupIcalc</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The calculated intensities summed on all reflections that are grouped. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">CrystVector_REAL&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#a800c45f228a27bf7915e312ae05048dc">mGroupWeight</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The weight on each reflection sum in case of grouped reflections.  <a href="#a800c45f228a27bf7915e312ae05048dc"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">CrystVector_long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#a44eb55c673c51633521b38af7a489abe">mGroupIndex</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">The index of reflections which need to be summed.  <a href="#a44eb55c673c51633521b38af7a489abe"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3ebc7c0b1cd1a13247920f7264903009"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::mNbGroup" ref="a3ebc7c0b1cd1a13247920f7264903009" args="" -->
long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#a3ebc7c0b1cd1a13247920f7264903009">mNbGroup</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of groups. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="abc5c636a84c000d831fab9e506904077"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::mNbGroupUsed" ref="abc5c636a84c000d831fab9e506904077" args="" -->
long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#abc5c636a84c000d831fab9e506904077">mNbGroupUsed</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of groups below max[sin(theta)/lambda]. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a03be010eb090d416b9c191f37e876ae6"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::mClockPrepareTwinningCorr" ref="a03be010eb090d416b9c191f37e876ae6" args="" -->
<a class="el" href="a00072.html">RefinableObjClock</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00026.html#a03be010eb090d416b9c191f37e876ae6">mClockPrepareTwinningCorr</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Clock for twinning, when the preparation of twinning correction was last made. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a82c829f88648010c963ea6ca80f5916f"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::mRadiation" ref="a82c829f88648010c963ea6ca80f5916f" args="" -->
<a class="el" href="a00069.html">Radiation</a>&#160;</td><td class="memItemRight" valign="bottom"><b>mRadiation</b></td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<div class="textblock"><p>DiffractionData object for Single <a class="el" href="a00020.html" title="Crystal class: Unit cell, spacegroup, scatterers.">Crystal</a> analysis. </p>
<p>Currently this handles only in the simplest way single crystal dat: ie only data which has been completely corrected for Lorentz/Polarization and absorption.</p>
<p>What needs to be developped: define the geometry of the experiment (incident and emerging angles), the polarization of the beam, etc... </p>
</div><hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="ab182bcffdd5cded6e7bd536bc71a3241"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::DiffractionDataSingleCrystal" ref="ab182bcffdd5cded6e7bd536bc71a3241" args="(const bool regist=true)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00026.html#ab182bcffdd5cded6e7bd536bc71a3241">ObjCryst::DiffractionDataSingleCrystal::DiffractionDataSingleCrystal</a> </td>
          <td>(</td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>regist</em> = <code>true</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Default constructor. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">regist,:</td><td>if false, do not add to the global registry of single crystal data or refinable objects - this is only useful for data to be used internally only.</td></tr>
  </table>
  </dd>
</dl>
<dl class="deprecated"><dt><b><a class="el" href="a00223.html#_deprecated000001">Deprecated:</a></b></dt><dd>Use the constructor passing a crystal structure instead. </dd></dl>

</div>
</div>
<a class="anchor" id="a3fcfa9d8f263043025d4167001c2243f"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::DiffractionDataSingleCrystal" ref="a3fcfa9d8f263043025d4167001c2243f" args="(Crystal &amp;cryst, const bool regist=true)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00026.html#ab182bcffdd5cded6e7bd536bc71a3241">ObjCryst::DiffractionDataSingleCrystal::DiffractionDataSingleCrystal</a> </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00020.html">Crystal</a> &amp;&#160;</td>
          <td class="paramname"><em>cryst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>regist</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Constructor, with an assigned crystal structure. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">regist,:</td><td>if false, do not add to the global registry of single crystal data or refinable objects - this is only useful for data to be used internally only. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a97e666eeeb9e3b97a36145415e3f959e"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::FitScaleFactorForR" ref="a97e666eeeb9e3b97a36145415e3f959e" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual void <a class="el" href="a00026.html#a97e666eeeb9e3b97a36145415e3f959e">ObjCryst::DiffractionDataSingleCrystal::FitScaleFactorForR</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Compute the best scale factor minimising R. </p>
<p>The computed scale factor is <em>immediatly</em> applied to Icalc </p>

</div>
</div>
<a class="anchor" id="a82c8acf2a3f315091d97ad154a74e17b"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::FitScaleFactorForRw" ref="a82c8acf2a3f315091d97ad154a74e17b" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual void <a class="el" href="a00026.html#a82c8acf2a3f315091d97ad154a74e17b">ObjCryst::DiffractionDataSingleCrystal::FitScaleFactorForRw</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Compute the best scale factor minimising Rw. </p>
<p>The computed scale factor is <em>immediatly</em> applied to Icalc </p>

</div>
</div>
<a class="anchor" id="a9f4bedb3f24193c14a39ad97ef074948"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::GetBestRFactor" ref="a9f4bedb3f24193c14a39ad97ef074948" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual REAL <a class="el" href="a00026.html#a9f4bedb3f24193c14a39ad97ef074948">ObjCryst::DiffractionDataSingleCrystal::GetBestRFactor</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Compute the best scale factor to minimize R, apply this scale factor and return the R value obtained. </p>

</div>
</div>
<a class="anchor" id="a406a2e413ed8c0a6afd92f384246d36c"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::GetChi2" ref="a406a2e413ed8c0a6afd92f384246d36c" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual REAL <a class="el" href="a00026.html#a406a2e413ed8c0a6afd92f384246d36c">ObjCryst::DiffractionDataSingleCrystal::GetChi2</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Return conventionnal Chi^2. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd><img class="formulaInl" alt="$ \chi^2 = \sum_i w_i \left(I_i^{obs}-I_i^{calc} \right)^2 $" src="form_2.png"/> </dd></dl>

</div>
</div>
<a class="anchor" id="a05b1f448a143ad61036f001d09a3509f"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::GetClassName" ref="a05b1f448a143ad61036f001d09a3509f" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual const string&amp; <a class="el" href="a00026.html#a05b1f448a143ad61036f001d09a3509f">ObjCryst::DiffractionDataSingleCrystal::GetClassName</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Name for this class ("RefinableObj", "Crystal",...). </p>
<p>This is only useful to distinguish different classes when picking up objects from the <a class="el" href="a00071.html" title="Generic Refinable Object.">RefinableObj</a> Global Registry </p>

<p>Reimplemented from <a class="el" href="a00071.html#a62968d90a7a3080738b363934616c019">ObjCryst::RefinableObj</a>.</p>

</div>
</div>
<a class="anchor" id="a5aade79d8baf1b770ab82af93fd244e6"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::GetIcalc" ref="a5aade79d8baf1b770ab82af93fd244e6" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const CrystVector_REAL&amp; <a class="el" href="a00026.html#a5aade79d8baf1b770ab82af93fd244e6">ObjCryst::DiffractionDataSingleCrystal::GetIcalc</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>returns the calculated diffracted intensity. </p>
<p>This is an array of calculated intensities for each reflections in the single crystal case, and the array with the full powder powder profile for powder diffraction. </p>

</div>
</div>
<a class="anchor" id="ad42c5159763eb136fadfb653067d1a7b"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::GetLogLikelihood" ref="ad42c5159763eb136fadfb653067d1a7b" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual REAL <a class="el" href="a00026.html#ad42c5159763eb136fadfb653067d1a7b">ObjCryst::DiffractionDataSingleCrystal::GetLogLikelihood</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get -log(likelihood) of the current configuration for the object. </p>
<p>By default (no likelihood evaluation available), this is equal to 0.</p>
<p>This call should not be recursive, it is the task of the algorithm to get the sum of likelihoods for all objects invlolved.</p>
<dl class="note"><dt><b>Note:</b></dt><dd>contrary to the old "Cost Function" approach, with log(Likelihood) there is no 'choice' of cost function, so that it is the task of the object to give the optimized likelihood (possibly with user options).</dd></dl>
<dl class="warning"><dt><b>Warning:</b></dt><dd>: this is in under heavy development, so expect changes... </dd></dl>

<p>Reimplemented from <a class="el" href="a00071.html#a9a9a5ea2b997cd36b44ed35c2bab3245">ObjCryst::RefinableObj</a>.</p>

</div>
</div>
<a class="anchor" id="a52253e2e3a9e0e1a8200c6e042d6f8c9"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::GetR" ref="a52253e2e3a9e0e1a8200c6e042d6f8c9" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual REAL <a class="el" href="a00026.html#a52253e2e3a9e0e1a8200c6e042d6f8c9">ObjCryst::DiffractionDataSingleCrystal::GetR</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Return the <a class="el" href="a00020.html" title="Crystal class: Unit cell, spacegroup, scatterers.">Crystal</a> R-factor (unweighted) </p>
<dl class="return"><dt><b>Returns:</b></dt><dd><img class="formulaInl" alt="$ R= \sqrt {\frac{\sum_i \left( I_i^{obs}-I_i^{calc} \right)^2} {\sum_i (I_i^{obs})^2} }$" src="form_1.png"/> </dd></dl>

</div>
</div>
<a class="anchor" id="addee789ac9e373d7080bd0fc395e68e8"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::GetRw" ref="addee789ac9e373d7080bd0fc395e68e8" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual REAL <a class="el" href="a00026.html#addee789ac9e373d7080bd0fc395e68e8">ObjCryst::DiffractionDataSingleCrystal::GetRw</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Return the <a class="el" href="a00020.html" title="Crystal class: Unit cell, spacegroup, scatterers.">Crystal</a> R-factor (weighted) </p>
<dl class="return"><dt><b>Returns:</b></dt><dd><img class="formulaInl" alt="$ R_{w}= \sqrt {\frac{\sum_i w_i\left( I_i^{obs}-I_i^{calc} \right)^2} {\sum_i w_i (I_i^{obs})^2} }$" src="form_0.png"/> </dd></dl>

</div>
</div>
<a class="anchor" id="a9f19efd0a77a471666ddd5b4be421ffa"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::GlobalOptRandomMove" ref="a9f19efd0a77a471666ddd5b4be421ffa" args="(const REAL mutationAmplitude, const RefParType *type=gpRefParTypeObjCryst)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual void <a class="el" href="a00026.html#a9f19efd0a77a471666ddd5b4be421ffa">ObjCryst::DiffractionDataSingleCrystal::GlobalOptRandomMove</a> </td>
          <td>(</td>
          <td class="paramtype">const REAL&#160;</td>
          <td class="paramname"><em>mutationAmplitude</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="a00080.html">RefParType</a> *&#160;</td>
          <td class="paramname"><em>type</em> = <code><a class="el" href="a00171.html#a92ed37a804903dfb302d70309b7bc474">gpRefParTypeObjCryst</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Make a random move of the current configuration. </p>
<p>This is for global optimization algorithms. the moves for each parameter are less than their global optimization step, multiplied by the mutation amplitude.</p>
<dl class="warning"><dt><b>Warning:</b></dt><dd>: this makes a random move for the parameter declared for this object, and it is the duty of the object to decide whether the included objects should be moved and how. (eg an algorithm should only call for a move with the top object, and this object decides how he and his sub-objects moves). By default (<a class="el" href="a00071.html" title="Generic Refinable Object.">RefinableObj</a> implementation) all included objects are moved recursively.</dd></dl>
<p><a class="el" href="a00071.html" title="Generic Refinable Object.">RefinableObj</a>:: </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">mutationAmplitude,:</td><td>multiplier for the maximum move amplitude, for all parameters </td></tr>
    <tr><td class="paramname">type,:</td><td>restrain the change exclusively to parameters of a given type (same type or descendant from this <a class="el" href="a00080.html" title="class of refinable parameter types.">RefParType</a>). </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented from <a class="el" href="a00071.html#a18375c8525ae38c481ba77e9cf9d67c1">ObjCryst::RefinableObj</a>.</p>

</div>
</div>
<a class="anchor" id="ac306439389c8eab225dd8dd87aa8f189"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::ImportHklIobs" ref="ac306439389c8eab225dd8dd87aa8f189" args="(const string &amp;fileName, const long nbRefl, const int skipLines=0)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="a00026.html#ac306439389c8eab225dd8dd87aa8f189">ObjCryst::DiffractionDataSingleCrystal::ImportHklIobs</a> </td>
          <td>(</td>
          <td class="paramtype">const string &amp;&#160;</td>
          <td class="paramname"><em>fileName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const long&#160;</td>
          <td class="paramname"><em>nbRefl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>skipLines</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Import h,k,l,I from a file. </p>
<p>The file is assumed to correspond to a single crystal diffraction file. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">fileName</td><td>The name of the data file. This file should be formatted with H,k,l, Iobs separated by spaces. </td></tr>
    <tr><td class="paramname">nbRefl</td><td>The number of reflections to extract. </td></tr>
    <tr><td class="paramname">skipLines</td><td>The number of lines to skip at the beginning of the file. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="af590310eb70814be523947dc7ddc695c"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::ImportHklIobsGroup" ref="af590310eb70814be523947dc7ddc695c" args="(const string &amp;fileName, const unsigned int skipLines=0)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="a00026.html#af590310eb70814be523947dc7ddc695c">ObjCryst::DiffractionDataSingleCrystal::ImportHklIobsGroup</a> </td>
          <td>(</td>
          <td class="paramtype">const string &amp;&#160;</td>
          <td class="paramname"><em>fileName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>skipLines</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Import h,k,l and grouped intensities from a file. </p>
<p>The file is assumed to correspond to a single crystal diffraction file. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">fileName</td><td>The name of the data file. This file should be formatted with H,k,l, Iobs separated by spaces. </td></tr>
    <tr><td class="paramname">skipLines</td><td>The number of lines to skip at the beginning of the file.</td></tr>
  </table>
  </dd>
</dl>
<p>File format (the reflection which has an intensity entry marks the end of the group) h k l Igroup -2 4 2 -2 -4 2 100.4 2 -4 1 2 4 1 193.2 ... </p>

</div>
</div>
<a class="anchor" id="a041f22715b9b4d1f2beb2b7e387fa682"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::ImportHklIobsSigma" ref="a041f22715b9b4d1f2beb2b7e387fa682" args="(const string &amp;fileName, const long nbRefl, const int skipLines=0)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="a00026.html#a041f22715b9b4d1f2beb2b7e387fa682">ObjCryst::DiffractionDataSingleCrystal::ImportHklIobsSigma</a> </td>
          <td>(</td>
          <td class="paramtype">const string &amp;&#160;</td>
          <td class="paramname"><em>fileName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const long&#160;</td>
          <td class="paramname"><em>nbRefl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>skipLines</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Import h,k,l,I,Sigma from a file. </p>
<p>The file is assumed to correspond to a single crystal diffraction file. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">fileName</td><td>The name of the data file. This file should be formatted with H,k,l, Iobs and Sigma separated by spaces. </td></tr>
    <tr><td class="paramname">nbRefl</td><td>The number of reflections to extract. </td></tr>
    <tr><td class="paramname">skipLines</td><td>The number of lines to skip at the beginning of the file. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a5721769a1b4a8e33664c3b0867c05086"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::ImportHklIobsSigmaJanaM91" ref="a5721769a1b4a8e33664c3b0867c05086" args="(const string &amp;fileName)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="a00026.html#a5721769a1b4a8e33664c3b0867c05086">ObjCryst::DiffractionDataSingleCrystal::ImportHklIobsSigmaJanaM91</a> </td>
          <td>(</td>
          <td class="paramtype">const string &amp;&#160;</td>
          <td class="paramname"><em>fileName</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Import h,k,l,I,Sigma from a Jana98 '*.m91' file. </p>
<p>The file is assumed to correspond to a single crystal diffraction file. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">fileName</td><td>The name of the data file. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a7cc9b7b685ef9031f6e6176a5da1ed63"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::PrepareTwinningCalc" ref="a7cc9b7b685ef9031f6e6176a5da1ed63" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="a00026.html#a7cc9b7b685ef9031f6e6176a5da1ed63">ObjCryst::DiffractionDataSingleCrystal::PrepareTwinningCalc</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Determine the index of reflections to be summed because of twinning (GroupOption==1) The reflections <em>must</em> have been sorted by increasing theta beforehand. </p>

</div>
</div>
<a class="anchor" id="ad3c0c4361b81a2f7e786ed16968c6d88"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::PrintObsData" ref="ad3c0c4361b81a2f7e786ed16968c6d88" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual void <a class="el" href="a00026.html#ad3c0c4361b81a2f7e786ed16968c6d88">ObjCryst::DiffractionDataSingleCrystal::PrintObsData</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Print H, K, L Iobs sigma for all reflections. </p>

</div>
</div>
<a class="anchor" id="af220156c564b8d602b0c05ba222fba03"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::SaveHKLIobsIcalc" ref="af220156c564b8d602b0c05ba222fba03" args="(const string &amp;filename=&quot;hklIobsIcalc.out&quot;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="a00026.html#af220156c564b8d602b0c05ba222fba03">ObjCryst::DiffractionDataSingleCrystal::SaveHKLIobsIcalc</a> </td>
          <td>(</td>
          <td class="paramtype">const string &amp;&#160;</td>
          <td class="paramname"><em>filename</em> = <code>&quot;hklIobsIcalc.out&quot;</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Save H,K,L Iobs Icalc to a file, text format, 3 columns theta Iobs Icalc. </p>
<p>If Iobs is missing, the column is omitted. </p>

</div>
</div>
<a class="anchor" id="a0d13ab934c60c9bd0aebbb285a92c5cb"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::SetHklIobs" ref="a0d13ab934c60c9bd0aebbb285a92c5cb" args="(const CrystVector_long &amp;h, const CrystVector_long &amp;k, const CrystVector_long &amp;l, const CrystVector_REAL &amp;iObs, const CrystVector_REAL &amp;sigma)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="a00026.html#a0d13ab934c60c9bd0aebbb285a92c5cb">ObjCryst::DiffractionDataSingleCrystal::SetHklIobs</a> </td>
          <td>(</td>
          <td class="paramtype">const CrystVector_long &amp;&#160;</td>
          <td class="paramname"><em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const CrystVector_long &amp;&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const CrystVector_long &amp;&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const CrystVector_REAL &amp;&#160;</td>
          <td class="paramname"><em>iObs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const CrystVector_REAL &amp;&#160;</td>
          <td class="paramname"><em>sigma</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>input H,K,L, Iobs and Sigma </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">h,k,l,:</td><td>REAL arrays (vectors with NbRefl elements -same size) with the h, k and l coordinates of all reflections. </td></tr>
    <tr><td class="paramname">iobs,sigma,:</td><td>REAL arrays (vectors with NbRefl elements -same size) with the Observed intensity and sigma for all reflections. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a55b89595cdd1305f69b725ba49dd9855"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::SetSigmaToSqrtIobs" ref="a55b89595cdd1305f69b725ba49dd9855" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual void <a class="el" href="a00026.html#a55b89595cdd1305f69b725ba49dd9855">ObjCryst::DiffractionDataSingleCrystal::SetSigmaToSqrtIobs</a> </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Set sigma for all observed intensities to sqrt(obs) </p>

</div>
</div>
<a class="anchor" id="a231437207dca7389aa593b1fd4fd9f1b"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::SetWavelength" ref="a231437207dca7389aa593b1fd4fd9f1b" args="(const string &amp;XRayTubeElementName, const REAL alpha2Alpha2ratio=0.5)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="a00026.html#a19d588f3fd7ca539d89d87e7420438e1">ObjCryst::DiffractionDataSingleCrystal::SetWavelength</a> </td>
          <td>(</td>
          <td class="paramtype">const string &amp;&#160;</td>
          <td class="paramname"><em>XRayTubeElementName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const REAL&#160;</td>
          <td class="paramname"><em>alpha2Alpha2ratio</em> = <code>0.5</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>\ brief Set X-Ray tube radiation. </p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">XRayTubeElementName</td><td>: name of the anticathode element name. Known ones are Cr, Fe, Cu, Mo, Ag. </td></tr>
    <tr><td class="paramname">alpha2Alpha2ratio,:</td><td>Kalpha2/Kalpha1 ratio (0.5 by default)</td></tr>
  </table>
  </dd>
</dl>
<p>the average wavelength is calculated using the alpha2/alpha1 weight. All structure factors computation are made using the average wavelength, and for powder diffraction, profiles are output at the alpha1 and alpha2 ratio for the calculated pattern.</p>
<p>NOTE : if the name of the wavelength is generic (eg"Cu"), then the program considers that there are both Alpha1 and Alpha2, and thus automatically changes the WavelengthType to WAVELENGTH_ALPHA12. If instead either alpha1 or alpha2 (eg "CuA1") is asked for, the WavelengthType is set to WAVELENGTH_MONOCHROMATIC. In both cases, the radiation type is set to X-Ray. </p>

</div>
</div>
<a class="anchor" id="a1b2bf6486f5030fa0cf59d057e8501b0"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::SetWeightToInvSigma2" ref="a1b2bf6486f5030fa0cf59d057e8501b0" args="(const REAL minRelatSigma=1e&#45;4)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual void <a class="el" href="a00026.html#a1b2bf6486f5030fa0cf59d057e8501b0">ObjCryst::DiffractionDataSingleCrystal::SetWeightToInvSigma2</a> </td>
          <td>(</td>
          <td class="paramtype">const REAL&#160;</td>
          <td class="paramname"><em>minRelatSigma</em> = <code>1e-4</code></td><td>)</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Set the weight for all observed intensities to 1/sigma^2. </p>
<p>For sigmas which are smaller than minRelatSigma times the max value of sigma, the output weight is set to 0. </p>

</div>
</div>
<a class="anchor" id="aeac660426ee4c5aa52d494b449a164f9"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::SortReflectionBySinThetaOverLambda" ref="aeac660426ee4c5aa52d494b449a164f9" args="(const REAL maxTheta=&#45;1.)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual CrystVector_long <a class="el" href="a00026.html#aeac660426ee4c5aa52d494b449a164f9">ObjCryst::DiffractionDataSingleCrystal::SortReflectionBySinThetaOverLambda</a> </td>
          <td>(</td>
          <td class="paramtype">const REAL&#160;</td>
          <td class="paramname"><em>maxSTOL</em> = <code>-1.</code></td><td>)</td>
          <td><code> [private, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>sort reflections by theta values (also get rid of [0,0,0] if present) If maxSTOL &gt;0, then only reflections where sin(theta)/lambda&lt;maxSTOL are kept </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>an array with the subscript of the kept reflections (for inherited classes) </dd></dl>

<p>Reimplemented from <a class="el" href="a00089.html#a4b843c3350e25d4d0c52da3400768fb7">ObjCryst::ScatteringData</a>.</p>

</div>
</div>
<a class="anchor" id="a3b1edc7d3c612fa20cb658ef1d084c00"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::XMLInput" ref="a3b1edc7d3c612fa20cb658ef1d084c00" args="(istream &amp;is, const XMLCrystTag &amp;tag)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual void <a class="el" href="a00026.html#a3b1edc7d3c612fa20cb658ef1d084c00">ObjCryst::DiffractionDataSingleCrystal::XMLInput</a> </td>
          <td>(</td>
          <td class="paramtype">istream &amp;&#160;</td>
          <td class="paramname"><em>is</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="a00151.html">XMLCrystTag</a> &amp;&#160;</td>
          <td class="paramname"><em>tag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Input From stream. </p>
<dl class="todo"><dt><b><a class="el" href="a00222.html#_todo000027">Todo:</a></b></dt><dd>Add an bool XMLInputTag(is,tag) function to recognize all the tags from the stream. So that each inherited class can use the XMLInputTag function from its parent (ie take advantage of inheritance). The children class would first try to interpret the tag, then if unsuccessful would pass it to its parent (thus allowing overloading), etc... </dd></dl>

<p>Reimplemented from <a class="el" href="a00071.html#ac13a4045c3f187879443c8615c38d623">ObjCryst::RefinableObj</a>.</p>

</div>
</div>
<a class="anchor" id="a59dadf9f6dedc3a84e858ee96268526e"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::XMLOutput" ref="a59dadf9f6dedc3a84e858ee96268526e" args="(ostream &amp;os, int indent=0) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual void <a class="el" href="a00026.html#a59dadf9f6dedc3a84e858ee96268526e">ObjCryst::DiffractionDataSingleCrystal::XMLOutput</a> </td>
          <td>(</td>
          <td class="paramtype">ostream &amp;&#160;</td>
          <td class="paramname"><em>os</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>indent</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Output to stream in well-formed XML. </p>
<dl class="todo"><dt><b><a class="el" href="a00222.html#_todo000026">Todo:</a></b></dt><dd>Use inheritance.. as for XMLInputTag()... </dd></dl>

<p>Reimplemented from <a class="el" href="a00071.html#a7b9b6ed0f8dcf753d398c35e073de973">ObjCryst::RefinableObj</a>.</p>

</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="a44eb55c673c51633521b38af7a489abe"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::mGroupIndex" ref="a44eb55c673c51633521b38af7a489abe" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CrystVector_long <a class="el" href="a00026.html#a44eb55c673c51633521b38af7a489abe">ObjCryst::DiffractionDataSingleCrystal::mGroupIndex</a><code> [mutable, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The index of reflections which need to be summed. </p>
<p>They must have been sorted by increasing theta values. Each entry (the reflection index) marks the beginning of a new batch of reflections to be summed.</p>
<p>Here only the groups of reflections are <em>roughly</em> sorted by sin(theta)/lambda. It is assumed, howver, that grouped reflections are of approximately the same d_hkl. After <a class="el" href="a00089.html#aac8034f8b0f6980c619e595ce6ba1d65" title="Recalc, and get the number of reflections which should be actually used, due to the maximuml sin(thet...">ScatteringData::GetNbReflBelowMaxSinThetaOvLambda()</a>, the number of groups for which *all* reflections are below the limit are taken into account for the statistics.</p>
<p>Note that  <a class="el" href="a00026.html#aeac660426ee4c5aa52d494b449a164f9">DiffractionDataSingleCrystal::SortReflectionBySinThetaOverLambda()</a> is called (i.e. immediately after importing the reflections) </p>

</div>
</div>
<a class="anchor" id="a800c45f228a27bf7915e312ae05048dc"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::mGroupWeight" ref="a800c45f228a27bf7915e312ae05048dc" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CrystVector_REAL <a class="el" href="a00026.html#a800c45f228a27bf7915e312ae05048dc">ObjCryst::DiffractionDataSingleCrystal::mGroupWeight</a><code> [mutable, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The weight on each reflection sum in case of grouped reflections. </p>
<p>The sum is the inverse of the sum of all sigma^2 </p>

</div>
</div>
<a class="anchor" id="a376708cee05a5d49ff22282748ef491b"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::mObsIntensity" ref="a376708cee05a5d49ff22282748ef491b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CrystVector_REAL <a class="el" href="a00026.html#a376708cee05a5d49ff22282748ef491b">ObjCryst::DiffractionDataSingleCrystal::mObsIntensity</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Observed intensity (after ABS and LP corrections) </p>
<p>In the single crystal case, this is a list of intensity corresponding to (h,k,l). For a powder sample, this is a list of all peaks intensities. </p>

</div>
</div>
<a class="anchor" id="a4de0d528fa61c01cff4a0c78f5f5f1c3"></a><!-- doxytag: member="ObjCryst::DiffractionDataSingleCrystal::mScaleFactor" ref="a4de0d528fa61c01cff4a0c78f5f5f1c3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">REAL <a class="el" href="a00026.html#a4de0d528fa61c01cff4a0c78f5f5f1c3">ObjCryst::DiffractionDataSingleCrystal::mScaleFactor</a><code> [mutable, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Scale factor. </p>
<p>It is applied when computing intensities. The scale applies to intensities </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>DiffractionDataSingleCrystal.h</li>
</ul>
</div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Tue Apr 3 2012 18:19:55 for ObjCryst++ by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
