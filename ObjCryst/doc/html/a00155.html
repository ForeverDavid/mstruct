<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>ObjCryst++: ObjCryst::ZScatterer Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.2-20100208 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="classes.html"><span>Class&nbsp;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="a00170.html">ObjCryst</a>::<a class="el" href="a00155.html">ZScatterer</a>
  </div>
</div>
<div class="contents">
<h1>ObjCryst::ZScatterer Class Reference</h1><!-- doxytag: class="ObjCryst::ZScatterer" --><!-- doxytag: inherits="ObjCryst::Scatterer" -->
<p><a class="el" href="a00155.html" title="ZScatterer: the basic type of complex scatterers, where atom positions are defined...">ZScatterer</a>: the basic type of complex scatterers, where atom positions are defined using a standard "Z-Matrix" description.  
<a href="#_details">More...</a></p>
<div class="dynheader">
Inheritance diagram for ObjCryst::ZScatterer:</div>
<div class="dynsection">
 <div class="center">
  <img src="a00155.png" usemap="#ObjCryst::ZScatterer_map" alt=""/>
  <map id="ObjCryst::ZScatterer_map" name="ObjCryst::ZScatterer_map">
<area href="a00084.html" alt="ObjCryst::Scatterer" shape="rect" coords="0,56,142,80"/>
<area href="a00070.html" alt="ObjCryst::RefinableObj" shape="rect" coords="0,0,142,24"/>
<area href="a00154.html" alt="ObjCryst::ZPolyhedron" shape="rect" coords="0,168,142,192"/>
</map>
 </div>
</div>

<p><a href="a00309.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#a2798124784744758620d1b7838b82af0">ZScatterer</a> (const string &amp;name, <a class="el" href="a00020.html">Crystal</a> &amp;cryst, const REAL x=0., const REAL y=0., const REAL z=0., const REAL phi=0., const REAL chi=0., const REAL psi=0.)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><a class="el" href="a00155.html" title="ZScatterer: the basic type of complex scatterers, where atom positions are defined...">ZScatterer</a> constructor.  <a href="#a2798124784744758620d1b7838b82af0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#aa371bd36d61fe7200753cd3a3e1076c8">ZScatterer</a> (const <a class="el" href="a00155.html">ZScatterer</a> &amp;old)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Copy constructor.  <a href="#aa371bd36d61fe7200753cd3a3e1076c8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="a00155.html">ZScatterer</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#a6cf9f5891cf87e865efa971d36599d24">CreateCopy</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual const string &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#a610a62c221ed289e1ce4d68adac921ee">GetClassName</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Name for this class ("RefinableObj", "Crystal",.  <a href="#a610a62c221ed289e1ce4d68adac921ee"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#abe2114dff3bb1a170b4a0a855ba8bafa">AddAtom</a> (const string &amp;name, const <a class="el" href="a00089.html">ScatteringPower</a> *pow, const long atomBond, const REAL bondLength, const long atomAngle, const REAL bondAngle, const long atomDihedral, const REAL dihedralAngle, const REAL popu=1.)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add an atom to the Zscatterer.  <a href="#abe2114dff3bb1a170b4a0a855ba8bafa"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3aede3e309f7e77bcc4b0013619c922e"></a><!-- doxytag: member="ObjCryst::ZScatterer::GetNbComponent" ref="a3aede3e309f7e77bcc4b0013619c922e" args="() const " -->
virtual int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#a3aede3e309f7e77bcc4b0013619c922e">GetNbComponent</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Number of components in the scatterer (eg number of point scatterers). <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual const <br class="typebreak"/>
<a class="el" href="a00086.html">ScatteringComponentList</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#aadfeeafb618aad01ea80f099dd7c3299">GetScatteringComponentList</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the list of all scattering components for this scatterer.  <a href="#aadfeeafb618aad01ea80f099dd7c3299"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#a44e9bf9d72e256ef8bc39ea2cf0eef4e">GetComponentName</a> (const int i) const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Name for the i-th component of this scatterer.  <a href="#a44e9bf9d72e256ef8bc39ea2cf0eef4e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a70dbf802482ce7d8139651375464b4a0"></a><!-- doxytag: member="ObjCryst::ZScatterer::Print" ref="a70dbf802482ce7d8139651375464b4a0" args="() const " -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#a70dbf802482ce7d8139651375464b4a0">Print</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Print a single line of information about this scatterer. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a70468c7a09000a061ac8db15da391f02"></a><!-- doxytag: member="ObjCryst::ZScatterer::GetPhi" ref="a70468c7a09000a061ac8db15da391f02" args="() const " -->
REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#a70468c7a09000a061ac8db15da391f02">GetPhi</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Access to phi parameter (overall orientation of the scatterer). <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5e528512fe57a35c7ef594d437f311cc"></a><!-- doxytag: member="ObjCryst::ZScatterer::GetChi" ref="a5e528512fe57a35c7ef594d437f311cc" args="() const " -->
REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#a5e528512fe57a35c7ef594d437f311cc">GetChi</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Access to chi parameter (overall orientation of the scatterer). <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1c86cb34c5c3005281b8207a93fbcf58"></a><!-- doxytag: member="ObjCryst::ZScatterer::GetPsi" ref="a1c86cb34c5c3005281b8207a93fbcf58" args="() const " -->
REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#a1c86cb34c5c3005281b8207a93fbcf58">GetPsi</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Access to psi parameter (overall orientation of the scatterer). <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a887dbc07697df53f50fe4546563c8a07"></a><!-- doxytag: member="ObjCryst::ZScatterer::SetPhi" ref="a887dbc07697df53f50fe4546563c8a07" args="(const REAL)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#a887dbc07697df53f50fe4546563c8a07">SetPhi</a> (const REAL)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Access to phi parameter (overall orientation of the scatterer). <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac1cced93f67978157b93ae72b3fba644"></a><!-- doxytag: member="ObjCryst::ZScatterer::SetChi" ref="ac1cced93f67978157b93ae72b3fba644" args="(const REAL)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#ac1cced93f67978157b93ae72b3fba644">SetChi</a> (const REAL)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Access to chi parameter (overall orientation of the scatterer). <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aeb0b5e2ceae975ef762857659cb30fbd"></a><!-- doxytag: member="ObjCryst::ZScatterer::SetPsi" ref="aeb0b5e2ceae975ef762857659cb30fbd" args="(const REAL)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#aeb0b5e2ceae975ef762857659cb30fbd">SetPsi</a> (const REAL)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Access to psi parameter (overall orientation of the scatterer). <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad535a440d13dc28139406588874b4b27"></a><!-- doxytag: member="ObjCryst::ZScatterer::GetZAtomX" ref="ad535a440d13dc28139406588874b4b27" args="(const int i) const " -->
REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#ad535a440d13dc28139406588874b4b27">GetZAtomX</a> (const int i) const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the X fractionnal coordinate of atom i. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aeaf52b41121b4878be2c4be4d83a17f7"></a><!-- doxytag: member="ObjCryst::ZScatterer::GetZAtomY" ref="aeaf52b41121b4878be2c4be4d83a17f7" args="(const int i) const " -->
REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#aeaf52b41121b4878be2c4be4d83a17f7">GetZAtomY</a> (const int i) const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the Y fractionnal coordinate of atom i. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a53e5bb949403eccbc64fe3c28661d7bf"></a><!-- doxytag: member="ObjCryst::ZScatterer::GetZAtomZ" ref="a53e5bb949403eccbc64fe3c28661d7bf" args="(const int i) const " -->
REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#a53e5bb949403eccbc64fe3c28661d7bf">GetZAtomZ</a> (const int i) const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the Z fractionnal coordinate of atom i. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6f6ec32bc2df1901c92c381cd7be5906"></a><!-- doxytag: member="ObjCryst::ZScatterer::GetZBondAtom" ref="a6f6ec32bc2df1901c92c381cd7be5906" args="(const int i) const " -->
long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#a6f6ec32bc2df1901c92c381cd7be5906">GetZBondAtom</a> (const int i) const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Index of the 1st atom used to define the i-th atom in the Z-Matrix (the one from which the bondlength is calculated). <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0a17a16b8ac41efd2c5f18d2a32bfed2"></a><!-- doxytag: member="ObjCryst::ZScatterer::GetZAngleAtom" ref="a0a17a16b8ac41efd2c5f18d2a32bfed2" args="(const int i) const " -->
long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#a0a17a16b8ac41efd2c5f18d2a32bfed2">GetZAngleAtom</a> (const int i) const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Index of the 2nd atom used to define the i-th atom in the Z-Matrix (the one from which the angle is calculated). <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac4d8facb2659e79e09d002788b9fab7a"></a><!-- doxytag: member="ObjCryst::ZScatterer::GetZDihedralAngleAtom" ref="ac4d8facb2659e79e09d002788b9fab7a" args="(const int i) const " -->
long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#ac4d8facb2659e79e09d002788b9fab7a">GetZDihedralAngleAtom</a> (const int i) const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Index of the 3rd atom used to define the i-th atom in the Z-Matrix (the one from which the dihedral angle is calculated). <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3ec611e17c6cb9ddd39b991cfbc28a36"></a><!-- doxytag: member="ObjCryst::ZScatterer::GetZBondLength" ref="a3ec611e17c6cb9ddd39b991cfbc28a36" args="(const int i) const " -->
REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#a3ec611e17c6cb9ddd39b991cfbc28a36">GetZBondLength</a> (const int i) const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Const access to bondlength parameter, for the i-th row in the Z-Matrix. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a655f049e0b556a8374cc8d8b792e974f"></a><!-- doxytag: member="ObjCryst::ZScatterer::GetZAngle" ref="a655f049e0b556a8374cc8d8b792e974f" args="(const int i) const " -->
REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#a655f049e0b556a8374cc8d8b792e974f">GetZAngle</a> (const int i) const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Const access to the angle parameter, for the i-th row in the Z-Matrix. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a976a7cb7196028bdf4b43f89eeaa8945"></a><!-- doxytag: member="ObjCryst::ZScatterer::GetZDihedralAngle" ref="a976a7cb7196028bdf4b43f89eeaa8945" args="(const int i) const " -->
REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#a976a7cb7196028bdf4b43f89eeaa8945">GetZDihedralAngle</a> (const int i) const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Const access to the dihedral angle parameter, for the i-th row in the Z-Matrix. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="acbad23f36916911878e3179fb70c62ba"></a><!-- doxytag: member="ObjCryst::ZScatterer::SetZBondLength" ref="acbad23f36916911878e3179fb70c62ba" args="(const int i, const REAL)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#acbad23f36916911878e3179fb70c62ba">SetZBondLength</a> (const int i, const REAL)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Access to bondlength parameter, for the i-th row in the Z-Matrix. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a20e056b613cfcb83be567c672df7fca6"></a><!-- doxytag: member="ObjCryst::ZScatterer::SetZAngle" ref="a20e056b613cfcb83be567c672df7fca6" args="(const int i, const REAL)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#a20e056b613cfcb83be567c672df7fca6">SetZAngle</a> (const int i, const REAL)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Access to the angle parameter, for the i-th row in the Z-Matrix. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a75a9bc717dd7c1fae40ad53176017bd6"></a><!-- doxytag: member="ObjCryst::ZScatterer::SetZDihedralAngle" ref="a75a9bc717dd7c1fae40ad53176017bd6" args="(const int i, const REAL)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#a75a9bc717dd7c1fae40ad53176017bd6">SetZDihedralAngle</a> (const int i, const REAL)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Access to the dihedral angle parameter, for the i-th row in the Z-Matrix. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2b076a4f65d4d2718c0c850d08e6ad6f"></a><!-- doxytag: member="ObjCryst::ZScatterer::GetZAtomRegistry" ref="a2b076a4f65d4d2718c0c850d08e6ad6f" args="() const " -->
const <a class="el" href="a00053.html">ObjRegistry</a>&lt; <a class="el" href="a00152.html">ZAtom</a> &gt; &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#a2b076a4f65d4d2718c0c850d08e6ad6f">GetZAtomRegistry</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Access to the registry of ZAtoms. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual ostream &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#a6dd20fe536310e622c1a30fb1d5a788f">POVRayDescription</a> (ostream &amp;os, const <a class="el" href="a00021.html">CrystalPOVRayOptions</a> &amp;options) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#a17fb665a72c2d694410580e3b33ea1a9">GLInitDisplayList</a> (const bool onlyIndependentAtoms=false, const REAL xMin=-.1, const REAL xMax=1.1, const REAL yMin=-.1, const REAL yMax=1.1, const REAL zMin=-.1, const REAL zMax=1.1, const bool displayEnantiomer=false, const bool displayNames=false) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#a6796374831dcd7a7d3a04dfcc2be1a83">SetUseGlobalScatteringPower</a> (const bool useIt)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">use a Global scattering power for this scatterer ?  <a href="#a6796374831dcd7a7d3a04dfcc2be1a83"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#a406d107bfd110c5c3de61208348d4ad0">XMLOutput</a> (ostream &amp;os, int indent=0) const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Output to stream in well-formed XML.  <a href="#a406d107bfd110c5c3de61208348d4ad0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#afb23d2cf7f8fd74f790d7dd0835256b1">XMLInput</a> (istream &amp;is, const <a class="el" href="a00150.html">XMLCrystTag</a> &amp;tag)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Input From stream.  <a href="#afb23d2cf7f8fd74f790d7dd0835256b1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#ae8143bbd71decab10138ddadf0e8b220">GetGeneGroup</a> (const <a class="el" href="a00070.html">RefinableObj</a> &amp;obj, CrystVector_uint &amp;groupIndex, unsigned int &amp;firstGroup) const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the gene group assigned to each parameter.  <a href="#ae8143bbd71decab10138ddadf0e8b220"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#a6df5359190e4cf5dc45a5e72c9a5a9a0">GlobalOptRandomMove</a> (const REAL mutationAmplitude, const <a class="el" href="a00079.html">RefParType</a> *type=<a class="el" href="a00170.html#a92ed37a804903dfb302d70309b7bc474">gpRefParTypeObjCryst</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Make a random move of the current configuration.  <a href="#a6df5359190e4cf5dc45a5e72c9a5a9a0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0a784d02541c6ffe762b7c40404c4b78"></a><!-- doxytag: member="ObjCryst::ZScatterer::GetXCoord" ref="a0a784d02541c6ffe762b7c40404c4b78" args="() const " -->
const CrystVector_REAL &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#a0a784d02541c6ffe762b7c40404c4b78">GetXCoord</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the list of all <a class="el" href="a00152.html" title="Class for individual atoms in a ZScatterer Object.">ZAtom</a> cartesian x coordinates. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0a6b34606c81d58c3bd0d837ff4a57ea"></a><!-- doxytag: member="ObjCryst::ZScatterer::GetYCoord" ref="a0a6b34606c81d58c3bd0d837ff4a57ea" args="() const " -->
const CrystVector_REAL &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#a0a6b34606c81d58c3bd0d837ff4a57ea">GetYCoord</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the list of all <a class="el" href="a00152.html" title="Class for individual atoms in a ZScatterer Object.">ZAtom</a> cartesian x coordinates. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1f8123a22d88198db465fb5ffeb533b3"></a><!-- doxytag: member="ObjCryst::ZScatterer::GetZCoord" ref="a1f8123a22d88198db465fb5ffeb533b3" args="() const " -->
const CrystVector_REAL &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#a1f8123a22d88198db465fb5ffeb533b3">GetZCoord</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the list of all <a class="el" href="a00152.html" title="Class for individual atoms in a ZScatterer Object.">ZAtom</a> cartesian x coordinates. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#a5742d1fa13b1300c92359ef1250753c3">EndOptimization</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This should be called by any optimization class at the end of an optimization.  <a href="#a5742d1fa13b1300c92359ef1250753c3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#a097d27206e6e54259bb987a06d65f71c">ImportFenskeHallZMatrix</a> (istream &amp;is, bool named=false)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Import "Fenske-Hall" ZMatrix file (fhz in the babel program <a href="http://www.eyesopen.com/babel.html">http://www.eyesopen.com/babel.html</a>\ example: use "./babel -ipdb foo.pdb -ofhz foo.fhz -d", to convert a pdb file to a Z-Matrix file (the -d removes hydrogen atoms).  <a href="#a097d27206e6e54259bb987a06d65f71c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#a551fabc1d57cab02e957946dcfa1aae7">ExportFenskeHallZMatrix</a> (ostream &amp;os)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Export to Fenske-Hall ZMatrix file.  <a href="#a551fabc1d57cab02e957946dcfa1aae7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a225e9fe8e640555f24bfbb5f6ec2fe25"></a><!-- doxytag: member="ObjCryst::ZScatterer::SetCenterAtomIndex" ref="a225e9fe8e640555f24bfbb5f6ec2fe25" args="(const unsigned int)" -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#a225e9fe8e640555f24bfbb5f6ec2fe25">SetCenterAtomIndex</a> (const unsigned int)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set the index of the central atom (around which the rotation is made). <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1495e1783ae1658579f03162bdaaa4e5"></a><!-- doxytag: member="ObjCryst::ZScatterer::GetCenterAtomIndex" ref="a1495e1783ae1658579f03162bdaaa4e5" args="() const " -->
unsigned int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#a1495e1783ae1658579f03162bdaaa4e5">GetCenterAtomIndex</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the index of the central atom (around which the rotation is made). <br/></td></tr>
<tr><td colspan="2"><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#a762bdaa10f81d266f545a88e857b1f56">UpdateCoordinates</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Update the atom coordinates (in real units, in Angstroems).  <a href="#a762bdaa10f81d266f545a88e857b1f56"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="adf587a20fb3c36e5cf276fe1c0fa81ab"></a><!-- doxytag: member="ObjCryst::ZScatterer::UpdateScattCompList" ref="adf587a20fb3c36e5cf276fe1c0fa81ab" args="() const " -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#adf587a20fb3c36e5cf276fe1c0fa81ab">UpdateScattCompList</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Update the scattering component list, ie compute all atom positions from the bonds/angles/dihedral angles, and convert the coordinates to fractionnal coordinates of the <a class="el" href="a00020.html" title="Crystal class: Unit cell, spacegroup, scatterers.">Crystal</a>. <br/></td></tr>
<tr><td colspan="2"><h2>Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">CrystMatrix_long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#aa02e92087f85784a74d1bdcebf178da9">m3DDisplayIndex</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">For 3D display of the structure, bonds, triangular and quadric faces can be displayed.  <a href="#aa02e92087f85784a74d1bdcebf178da9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa7f8346399e0039aa37a13ec9ff3a408"></a><!-- doxytag: member="ObjCryst::ZScatterer::mScattCompList" ref="aa7f8346399e0039aa37a13ec9ff3a408" args="" -->
<a class="el" href="a00086.html">ScatteringComponentList</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#aa7f8346399e0039aa37a13ec9ff3a408">mScattCompList</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The list of scattering components. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af4c3961f3b36c0aff6bb644f0831aa01"></a><!-- doxytag: member="ObjCryst::ZScatterer::mNbAtom" ref="af4c3961f3b36c0aff6bb644f0831aa01" args="" -->
long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#af4c3961f3b36c0aff6bb644f0831aa01">mNbAtom</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Total number of atoms in the structure. <br/></td></tr>
<tr><td colspan="2"><h2>Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a36839536bcb14d3a8dd581baf168f3d7"></a><!-- doxytag: member="ObjCryst::ZScatterer::InitRefParList" ref="a36839536bcb14d3a8dd581baf168f3d7" args="()" -->
virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#a36839536bcb14d3a8dd581baf168f3d7">InitRefParList</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Prepare refinable parameters for the scatterer object. <br/></td></tr>
<tr><td colspan="2"><h2>Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad07df797a68c2e153db0b809dc86b75d"></a><!-- doxytag: member="ObjCryst::ZScatterer::mNbDummyAtom" ref="ad07df797a68c2e153db0b809dc86b75d" args="" -->
long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#ad07df797a68c2e153db0b809dc86b75d">mNbDummyAtom</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Number of "dummy" atoms in the structure. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">CrystVector_int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#ab78108309d3a213454c7ac7d06da4dca">mComponentIndex</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Index of atoms in the <a class="el" href="a00086.html" title="list of scattering positions in a crystal, associated with the corresponding occupancy...">ScatteringComponentList</a>.  <a href="#ab78108309d3a213454c7ac7d06da4dca"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#a42fe9734108865176b2f5ddf12e7ccff">mPhi</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Angles giving the orientation of the <a class="el" href="a00155.html" title="ZScatterer: the basic type of complex scatterers, where atom positions are defined...">ZScatterer</a> (stored in radian).  <a href="#a42fe9734108865176b2f5ddf12e7ccff"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a478083578583445743cc65a4017a1b58"></a><!-- doxytag: member="ObjCryst::ZScatterer::mChi" ref="a478083578583445743cc65a4017a1b58" args="" -->
REAL&nbsp;</td><td class="memItemRight" valign="bottom"><b>mChi</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="afbf06c2d9f3d83474524e048ce569229"></a><!-- doxytag: member="ObjCryst::ZScatterer::mPsi" ref="afbf06c2d9f3d83474524e048ce569229" args="" -->
REAL&nbsp;</td><td class="memItemRight" valign="bottom"><b>mPsi</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9045886980786a8d5603d1a679ac3e67"></a><!-- doxytag: member="ObjCryst::ZScatterer::mZAtomRegistry" ref="a9045886980786a8d5603d1a679ac3e67" args="" -->
<a class="el" href="a00053.html">ObjRegistry</a>&lt; <a class="el" href="a00152.html">ZAtom</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#a9045886980786a8d5603d1a679ac3e67">mZAtomRegistry</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Registry for ZAtoms in this <a class="el" href="a00084.html" title="Generic type of scatterer: can be an atom, or a more complex assembly of atoms.">Scatterer</a>. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#a613abbb7f015620587e0bdaa750e5d03">mCenterAtomIndex</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Index of the atom used as a pivot (the scatterer is rotated around this atom).  <a href="#a613abbb7f015620587e0bdaa750e5d03"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae3d1682b34d1efc5d8dd9277eda50ab1"></a><!-- doxytag: member="ObjCryst::ZScatterer::mPhiChiPsiMatrix" ref="ae3d1682b34d1efc5d8dd9277eda50ab1" args="" -->
CrystMatrix_REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#ae3d1682b34d1efc5d8dd9277eda50ab1">mPhiChiPsiMatrix</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Rotation matrix for the orientation of the scatterer. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#a971f73bdfed4eb3a9243fcdd7d20bcf3">mUseGlobalScattPow</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Does the <a class="el" href="a00155.html" title="ZScatterer: the basic type of complex scatterers, where atom positions are defined...">ZScatterer</a> use a global scattering power ?  <a href="#a971f73bdfed4eb3a9243fcdd7d20bcf3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00034.html">GlobalScatteringPower</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#a41e3dd665f7b096851b1f8109c56cd23">mpGlobalScattPow</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">the global scattering power used, if mUseGlobalScattPow=true  <a href="#a41e3dd665f7b096851b1f8109c56cd23"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">CrystVector_REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#a69918a0d5561e4076064e263616c4ed1">mXCoord</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Storage for Cartesian coordinates.  <a href="#a69918a0d5561e4076064e263616c4ed1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5df8241a2fc731c20efdcaa46f975133"></a><!-- doxytag: member="ObjCryst::ZScatterer::mYCoord" ref="a5df8241a2fc731c20efdcaa46f975133" args="" -->
CrystVector_REAL&nbsp;</td><td class="memItemRight" valign="bottom"><b>mYCoord</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab5aab7523839746ab4ff6a9216c827ac"></a><!-- doxytag: member="ObjCryst::ZScatterer::mZCoord" ref="ab5aab7523839746ab4ff6a9216c827ac" args="" -->
CrystVector_REAL&nbsp;</td><td class="memItemRight" valign="bottom"><b>mZCoord</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a595d35d75bff97e19a79f75e2f1a84d7"></a><!-- doxytag: member="ObjCryst::ZScatterer::mClockCoord" ref="a595d35d75bff97e19a79f75e2f1a84d7" args="" -->
<a class="el" href="a00071.html">RefinableObjClock</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00155.html#a595d35d75bff97e19a79f75e2f1a84d7">mClockCoord</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Last time the cartesian coordinates were computed. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa17adf3c664004b62b051f4222b917eb"></a><!-- doxytag: member="ObjCryst::ZScatterer::mpZMoveMinimizer" ref="aa17adf3c664004b62b051f4222b917eb" args="" -->
<a class="el" href="a00153.html">ZMoveMinimizer</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><b>mpZMoveMinimizer</b></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p><a class="el" href="a00155.html" title="ZScatterer: the basic type of complex scatterers, where atom positions are defined...">ZScatterer</a>: the basic type of complex scatterers, where atom positions are defined using a standard "Z-Matrix" description. </p>
<p>This is used to describe inorganic polyhedras, as well as molecules. </p>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a2798124784744758620d1b7838b82af0"></a><!-- doxytag: member="ObjCryst::ZScatterer::ZScatterer" ref="a2798124784744758620d1b7838b82af0" args="(const string &amp;name, Crystal &amp;cryst, const REAL x=0., const REAL y=0., const REAL z=0., const REAL phi=0., const REAL chi=0., const REAL psi=0.)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ObjCryst::ZScatterer::ZScatterer </td>
          <td>(</td>
          <td class="paramtype">const string &amp;&nbsp;</td>
          <td class="paramname"> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00020.html">Crystal</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>cryst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const REAL&nbsp;</td>
          <td class="paramname"> <em>x</em> = <code>0.</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const REAL&nbsp;</td>
          <td class="paramname"> <em>y</em> = <code>0.</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const REAL&nbsp;</td>
          <td class="paramname"> <em>z</em> = <code>0.</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const REAL&nbsp;</td>
          <td class="paramname"> <em>phi</em> = <code>0.</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const REAL&nbsp;</td>
          <td class="paramname"> <em>chi</em> = <code>0.</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const REAL&nbsp;</td>
          <td class="paramname"> <em>psi</em> = <code>0.</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><a class="el" href="a00155.html" title="ZScatterer: the basic type of complex scatterers, where atom positions are defined...">ZScatterer</a> constructor. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>name,:</em>&nbsp;</td><td>the name of the scatterer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>cryst,:</em>&nbsp;</td><td>the crystal in which the scatterer is (needed to convert from cartesian to fractionnal coordinates). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>x,y,z,:</em>&nbsp;</td><td>fractionnal coordinates of the scatterer </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>phi,chi,:</em>&nbsp;</td><td>angles defining the orientation of the scatterer </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="aa371bd36d61fe7200753cd3a3e1076c8"></a><!-- doxytag: member="ObjCryst::ZScatterer::ZScatterer" ref="aa371bd36d61fe7200753cd3a3e1076c8" args="(const ZScatterer &amp;old)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ObjCryst::ZScatterer::ZScatterer </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="a00155.html">ZScatterer</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>old</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Copy constructor. </p>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="abe2114dff3bb1a170b4a0a855ba8bafa"></a><!-- doxytag: member="ObjCryst::ZScatterer::AddAtom" ref="abe2114dff3bb1a170b4a0a855ba8bafa" args="(const string &amp;name, const ScatteringPower *pow, const long atomBond, const REAL bondLength, const long atomAngle, const REAL bondAngle, const long atomDihedral, const REAL dihedralAngle, const REAL popu=1.)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ObjCryst::ZScatterer::AddAtom </td>
          <td>(</td>
          <td class="paramtype">const string &amp;&nbsp;</td>
          <td class="paramname"> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="a00089.html">ScatteringPower</a> *&nbsp;</td>
          <td class="paramname"> <em>pow</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const long&nbsp;</td>
          <td class="paramname"> <em>atomBond</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const REAL&nbsp;</td>
          <td class="paramname"> <em>bondLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const long&nbsp;</td>
          <td class="paramname"> <em>atomAngle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const REAL&nbsp;</td>
          <td class="paramname"> <em>bondAngle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const long&nbsp;</td>
          <td class="paramname"> <em>atomDihedral</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const REAL&nbsp;</td>
          <td class="paramname"> <em>dihedralAngle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const REAL&nbsp;</td>
          <td class="paramname"> <em>popu</em> = <code>1.</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Add an atom to the Zscatterer. </p>
<p>If &amp;ScatteringPower=0, then it is a 'dummy' atom and will be ignored for any scattering analysis. The 'name' supplied may not be respected, and can be replaced by 'ZScatterer_name'+'AtomNum'+'ScattPowName' </p>

</div>
</div>
<a class="anchor" id="a6cf9f5891cf87e865efa971d36599d24"></a><!-- doxytag: member="ObjCryst::ZScatterer::CreateCopy" ref="a6cf9f5891cf87e865efa971d36599d24" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual <a class="el" href="a00155.html">ZScatterer</a>* ObjCryst::ZScatterer::CreateCopy </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><b>For internal use only.</b></p>
<p>
so-called Virtual copy constructor, needed to make copies of arrays of Scatterers </p>

<p>Implements <a class="el" href="a00084.html#a4d374adcff97163a24492d362f6def73">ObjCryst::Scatterer</a>.</p>

<p>Reimplemented in <a class="el" href="a00154.html#a83436a907a22d794259e5fea9b7670ce">ObjCryst::ZPolyhedron</a>.</p>

</div>
</div>
<a class="anchor" id="a5742d1fa13b1300c92359ef1250753c3"></a><!-- doxytag: member="ObjCryst::ZScatterer::EndOptimization" ref="a5742d1fa13b1300c92359ef1250753c3" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual void ObjCryst::ZScatterer::EndOptimization </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This should be called by any optimization class at the end of an optimization. </p>
<p>This also affects all sub-objects. </p>
<dl class="note"><dt><b>Note:</b></dt><dd>this may be called several time for some objects which are used by several other objects. </dd></dl>

<p>Reimplemented from <a class="el" href="a00070.html#ab0035f6164cb24ace67b51b11993a851">ObjCryst::RefinableObj</a>.</p>

</div>
</div>
<a class="anchor" id="a551fabc1d57cab02e957946dcfa1aae7"></a><!-- doxytag: member="ObjCryst::ZScatterer::ExportFenskeHallZMatrix" ref="a551fabc1d57cab02e957946dcfa1aae7" args="(ostream &amp;os)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ObjCryst::ZScatterer::ExportFenskeHallZMatrix </td>
          <td>(</td>
          <td class="paramtype">ostream &amp;&nbsp;</td>
          <td class="paramname"> <em>os</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Export to Fenske-Hall ZMatrix file. </p>
<dl class="todo"><dt><b><a class="el" href="a00221.html#_todo000018">Todo:</a></b></dt><dd>USe more strict formatting than space-delimited. </dd></dl>

</div>
</div>
<a class="anchor" id="a610a62c221ed289e1ce4d68adac921ee"></a><!-- doxytag: member="ObjCryst::ZScatterer::GetClassName" ref="a610a62c221ed289e1ce4d68adac921ee" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual const string&amp; ObjCryst::ZScatterer::GetClassName </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Name for this class ("RefinableObj", "Crystal",. </p>
<p>..). This is only useful to distinguish different classes when picking up objects from the <a class="el" href="a00070.html" title="Generic Refinable Object.">RefinableObj</a> Global Registry </p>

<p>Reimplemented from <a class="el" href="a00084.html#a374fc1bb2887ab1f61d456326d97c05f">ObjCryst::Scatterer</a>.</p>

</div>
</div>
<a class="anchor" id="a44e9bf9d72e256ef8bc39ea2cf0eef4e"></a><!-- doxytag: member="ObjCryst::ZScatterer::GetComponentName" ref="a44e9bf9d72e256ef8bc39ea2cf0eef4e" args="(const int i) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual string ObjCryst::ZScatterer::GetComponentName </td>
          <td>(</td>
          <td class="paramtype">const int&nbsp;</td>
          <td class="paramname"> <em>i</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Name for the i-th component of this scatterer. </p>
<p>If the component is an <a class="el" href="a00008.html" title="The basic atom scatterer, in a crystal.">Atom</a>, Then the name is that of the atom. Else, it is the name of the scatterer plus the component number in the scatterer plus the name of the <a class="el" href="a00089.html" title="Abstract Base Class to describe the scattering power of any Scatterer component in...">ScatteringPower</a>. </p>
<dl class="note"><dt><b>Note:</b></dt><dd>It would be better to return a reference, but we don't want to keep a name for all components... Weeelll, needs some more thinking... see what performance hit results (if any).</dd></dl>
<dl class="bug"><dt><b><a class="el" href="a00223.html#_bug000001">Bug:</a></b></dt><dd>does not take into account dummy atoms !! </dd></dl>

<p>Implements <a class="el" href="a00084.html#a42bdf508da6a90859a5a61e16c27d47e">ObjCryst::Scatterer</a>.</p>

</div>
</div>
<a class="anchor" id="ae8143bbd71decab10138ddadf0e8b220"></a><!-- doxytag: member="ObjCryst::ZScatterer::GetGeneGroup" ref="ae8143bbd71decab10138ddadf0e8b220" args="(const RefinableObj &amp;obj, CrystVector_uint &amp;groupIndex, unsigned int &amp;firstGroup) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual void ObjCryst::ZScatterer::GetGeneGroup </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="a00070.html">RefinableObj</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>obj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CrystVector_uint &amp;&nbsp;</td>
          <td class="paramname"> <em>groupIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int &amp;&nbsp;</td>
          <td class="paramname"> <em>firstGroup</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the gene group assigned to each parameter. </p>
<p>Each parameter (a <em>gene</em> in terms of genetic algorithms) can be assigned to a gene group. Thus when mating two configurations, genes will be exchanged by groups. By default (in the base RefinabeObj class), each parameter is alone in its group. Derived classes can group genes for a better s** life.</p>
<p>The number identifying a gene group only has a meaning in a given object. It can also change on subsequent calls, and thus is not unique.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>obj</em>&nbsp;</td><td>the , supplied by an algorithm class (<a class="el" href="a00054.html" title="Base object for Optimization methods.">OptimizationObj</a>,..), which contains a list of parameters, some of which (but possibly all or none) are parameters belonging to this object. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>groupIndex</em>&nbsp;</td><td>a vector of unsigned integers, one for each parameter in the input object, giving an unsigned integer value as gene group index. At the beginning this vector should contain only zeros (no group assigned). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>firstGroup</em>&nbsp;</td><td>this is the number of groups which have already been assigned, plus one. The gene groups returned by this object will start from this value, and increment <b>firstGroup</b> for each gene group used, so that different <a class="el" href="a00070.html" title="Generic Refinable Object.">RefinableObj</a> cannot share a gene group. </td></tr>
  </table>
  </dd>
</dl>
<dl class="note"><dt><b>Note:</b></dt><dd>this function is not optimized, and should only be called at the beginning of a refinement. </dd></dl>

<p>Reimplemented from <a class="el" href="a00070.html#ad59c8ad2b0d7ee59fa3f399a54f05e54">ObjCryst::RefinableObj</a>.</p>

</div>
</div>
<a class="anchor" id="aadfeeafb618aad01ea80f099dd7c3299"></a><!-- doxytag: member="ObjCryst::ZScatterer::GetScatteringComponentList" ref="aadfeeafb618aad01ea80f099dd7c3299" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual const <a class="el" href="a00086.html">ScatteringComponentList</a>&amp; ObjCryst::ZScatterer::GetScatteringComponentList </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the list of all scattering components for this scatterer. </p>
<p>This is the most important function of this class, giving the list of scattering positions along with the associated <a class="el" href="a00089.html" title="Abstract Base Class to describe the scattering power of any Scatterer component in...">ScatteringPower</a>. </p>

<p>Implements <a class="el" href="a00084.html#aca0e08e3793cc69d31fce53e481c2a67">ObjCryst::Scatterer</a>.</p>

</div>
</div>
<a class="anchor" id="a17fb665a72c2d694410580e3b33ea1a9"></a><!-- doxytag: member="ObjCryst::ZScatterer::GLInitDisplayList" ref="a17fb665a72c2d694410580e3b33ea1a9" args="(const bool onlyIndependentAtoms=false, const REAL xMin=&#45;.1, const REAL xMax=1.1, const REAL yMin=&#45;.1, const REAL yMax=1.1, const REAL zMin=&#45;.1, const REAL zMax=1.1, const bool displayEnantiomer=false, const bool displayNames=false) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual void ObjCryst::ZScatterer::GLInitDisplayList </td>
          <td>(</td>
          <td class="paramtype">const bool&nbsp;</td>
          <td class="paramname"> <em>noSymmetrics</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const REAL&nbsp;</td>
          <td class="paramname"> <em>xMin</em> = <code>-.1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const REAL&nbsp;</td>
          <td class="paramname"> <em>xMax</em> = <code>1.1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const REAL&nbsp;</td>
          <td class="paramname"> <em>yMin</em> = <code>-.1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const REAL&nbsp;</td>
          <td class="paramname"> <em>yMax</em> = <code>1.1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const REAL&nbsp;</td>
          <td class="paramname"> <em>zMin</em> = <code>-.1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const REAL&nbsp;</td>
          <td class="paramname"> <em>zMax</em> = <code>1.1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&nbsp;</td>
          <td class="paramname"> <em>displayEnantiomer</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&nbsp;</td>
          <td class="paramname"> <em>displayNames</em> = <code>false</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><b>For internal use only.</b></p>
<p>
Create an OpenGL Display List of the scatterer. This should only be called by a <a class="el" href="a00020.html" title="Crystal class: Unit cell, spacegroup, scatterers.">Crystal</a> object.<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>noSymmetrics,:</em>&nbsp;</td><td>if false (the default), then all symmetrics are shown in the 3D display, within the limits defined by the min/max parameters \ param xMin,xMax,yMin,yMax,zMin,zMax: in fractionnal coordinates, the region in which we want scaterrer to be displayed. The test is made on the center of the scatterer (eg a <a class="el" href="a00155.html" title="ZScatterer: the basic type of complex scatterers, where atom positions are defined...">ZScatterer</a> (molecule) will not be 'cut' on the border). </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>displayNames,:</em>&nbsp;</td><td>if true, only the names of the scatterers will be displayed, at the position of the scatterers (to actually see them, they will have to be translated with respect to the drawing of the scatterers). </td></tr>
  </table>
  </dd>
</dl>
</p>

<p>Implements <a class="el" href="a00084.html#a4eaf9cf9780bef83e40155810db120a0">ObjCryst::Scatterer</a>.</p>

</div>
</div>
<a class="anchor" id="a6df5359190e4cf5dc45a5e72c9a5a9a0"></a><!-- doxytag: member="ObjCryst::ZScatterer::GlobalOptRandomMove" ref="a6df5359190e4cf5dc45a5e72c9a5a9a0" args="(const REAL mutationAmplitude, const RefParType *type=gpRefParTypeObjCryst)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual void ObjCryst::ZScatterer::GlobalOptRandomMove </td>
          <td>(</td>
          <td class="paramtype">const REAL&nbsp;</td>
          <td class="paramname"> <em>mutationAmplitude</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="a00079.html">RefParType</a> *&nbsp;</td>
          <td class="paramname"> <em>type</em> = <code><a class="el" href="a00170.html#a92ed37a804903dfb302d70309b7bc474">gpRefParTypeObjCryst</a></code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Make a random move of the current configuration. </p>
<p>This is for global optimization algorithms. the moves for each parameter are less than their global optimization step, multiplied by the mutation amplitude.</p>
<dl class="warning"><dt><b>Warning:</b></dt><dd>: this makes a random move for the parameter declared for this object, and it is the duty of the object to decide whether the included objects should be moved and how. (eg an algorithm should only call for a move with the top object, and this object decides how he and his sub-objects moves). By default (<a class="el" href="a00070.html" title="Generic Refinable Object.">RefinableObj</a> implementation) all included objects are moved recursively.</dd></dl>
<p><a class="el" href="a00070.html" title="Generic Refinable Object.">RefinableObj</a>:: </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>mutationAmplitude,:</em>&nbsp;</td><td>multiplier for the maximum move amplitude, for all parameters </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>type,:</em>&nbsp;</td><td>restrain the change exclusively to parameters of a given type (same type or descendant from this <a class="el" href="a00079.html" title="class of refinable parameter types.">RefParType</a>). </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented from <a class="el" href="a00070.html#a18375c8525ae38c481ba77e9cf9d67c1">ObjCryst::RefinableObj</a>.</p>

</div>
</div>
<a class="anchor" id="a097d27206e6e54259bb987a06d65f71c"></a><!-- doxytag: member="ObjCryst::ZScatterer::ImportFenskeHallZMatrix" ref="a097d27206e6e54259bb987a06d65f71c" args="(istream &amp;is, bool named=false)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ObjCryst::ZScatterer::ImportFenskeHallZMatrix </td>
          <td>(</td>
          <td class="paramtype">istream &amp;&nbsp;</td>
          <td class="paramname"> <em>is</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>named</em> = <code>false</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Import "Fenske-Hall" ZMatrix file (fhz in the babel program <a href="http://www.eyesopen.com/babel.html">http://www.eyesopen.com/babel.html</a>\ example: use "./babel -ipdb foo.pdb -ofhz foo.fhz -d", to convert a pdb file to a Z-Matrix file (the -d removes hydrogen atoms). </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>is,:</em>&nbsp;</td><td>the input stream from which to read the z-matrix </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>names,:</em>&nbsp;</td><td>if true, instead of reading a standard Fenske-Hall z-matrix, the file will be read with names, i.e. with an added first column with the names of the atoms, and the number used to reference the bond, bond angle and dihedral angle atoms are replaced by the names of the atoms.</td></tr>
  </table>
  </dd>
</dl>
<dl class="warning"><dt><b>Warning:</b></dt><dd>: this should be called <em>before</em> any atom has been added (if there are already atoms, they should be removed but this has not been tested...)</dd></dl>
<dl class="note"><dt><b>Note:</b></dt><dd>: this will search in the <a class="el" href="a00020.html" title="Crystal class: Unit cell, spacegroup, scatterers.">Crystal</a> associated with this <a class="el" href="a00155.html" title="ZScatterer: the basic type of complex scatterers, where atom positions are defined...">ZScatterer</a> the relevant <a class="el" href="a00090.html" title="The Scattering Power for an Atom.">ScatteringPowerAtom</a>, which should have the name of the corresponding symbol (eg 'H', 'C',...) if these are not found then they will be added to the <a class="el" href="a00020.html" title="Crystal class: Unit cell, spacegroup, scatterers.">Crystal</a> with a default isotropic B-factor equal to 1. </dd>
<dd>
: this also sets relative limits of +/-.03 Angstroems for all bond distances, and +/-3.6 degress for bond and dihedral angles. </dd></dl>
<dl class="todo"><dt><b><a class="el" href="a00221.html#_todo000017">Todo:</a></b></dt><dd>: identify which dihedral angles should <em>not</em> be limited, by analysing a coordination table. </dd></dl>

</div>
</div>
<a class="anchor" id="a6dd20fe536310e622c1a30fb1d5a788f"></a><!-- doxytag: member="ObjCryst::ZScatterer::POVRayDescription" ref="a6dd20fe536310e622c1a30fb1d5a788f" args="(ostream &amp;os, const CrystalPOVRayOptions &amp;options) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual ostream&amp; ObjCryst::ZScatterer::POVRayDescription </td>
          <td>(</td>
          <td class="paramtype">ostream &amp;&nbsp;</td>
          <td class="paramname"> <em>os</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="a00021.html">CrystalPOVRayOptions</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>options</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<dl class="warning"><dt><b>Warning:</b></dt><dd>Not implemented for <a class="el" href="a00155.html" title="ZScatterer: the basic type of complex scatterers, where atom positions are defined...">ZScatterer</a> </dd></dl>

<p>Implements <a class="el" href="a00084.html#a708cc857f82c9af4cbdf4d9334449d0f">ObjCryst::Scatterer</a>.</p>

</div>
</div>
<a class="anchor" id="a6796374831dcd7a7d3a04dfcc2be1a83"></a><!-- doxytag: member="ObjCryst::ZScatterer::SetUseGlobalScatteringPower" ref="a6796374831dcd7a7d3a04dfcc2be1a83" args="(const bool useIt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual void ObjCryst::ZScatterer::SetUseGlobalScatteringPower </td>
          <td>(</td>
          <td class="paramtype">const bool&nbsp;</td>
          <td class="paramname"> <em>useIt</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>use a Global scattering power for this scatterer ? </p>
<p>If true, then the overall scattering power of this <a class="el" href="a00155.html" title="ZScatterer: the basic type of complex scatterers, where atom positions are defined...">ZScatterer</a> will be approximated to an isotropic scattering power computed for this scatterer. Of course, only use this if the "isotropic" approximation is reasonable for this scatterer (typically true for 'large' polyhedra). See <a class="el" href="a00034.html" title="Global Scattering Power.">GlobalScatteringPower</a>.</p>
<dl class="warning"><dt><b>Warning:</b></dt><dd>EXPERIMENTAL </dd></dl>

</div>
</div>
<a class="anchor" id="a762bdaa10f81d266f545a88e857b1f56"></a><!-- doxytag: member="ObjCryst::ZScatterer::UpdateCoordinates" ref="a762bdaa10f81d266f545a88e857b1f56" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ObjCryst::ZScatterer::UpdateCoordinates </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Update the atom coordinates (in real units, in Angstroems). </p>
<p>This takes into account the translation and global rotation of the scatterer (ie this does not generate 'internal coordinates). </p>

</div>
</div>
<a class="anchor" id="afb23d2cf7f8fd74f790d7dd0835256b1"></a><!-- doxytag: member="ObjCryst::ZScatterer::XMLInput" ref="afb23d2cf7f8fd74f790d7dd0835256b1" args="(istream &amp;is, const XMLCrystTag &amp;tag)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual void ObjCryst::ZScatterer::XMLInput </td>
          <td>(</td>
          <td class="paramtype">istream &amp;&nbsp;</td>
          <td class="paramname"> <em>is</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="a00150.html">XMLCrystTag</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>tag</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Input From stream. </p>
<dl class="todo"><dt><b><a class="el" href="a00221.html#_todo000027">Todo:</a></b></dt><dd>Add an bool XMLInputTag(is,tag) function to recognize all the tags from the stream. So that each inherited class can use the XMLInputTag function from its parent (ie take advantage of inheritance). The children class would first try to interpret the tag, then if unsuccessful would pass it to its parent (thus allowing overloading), etc... </dd></dl>

<p>Reimplemented from <a class="el" href="a00070.html#ac13a4045c3f187879443c8615c38d623">ObjCryst::RefinableObj</a>.</p>

</div>
</div>
<a class="anchor" id="a406d107bfd110c5c3de61208348d4ad0"></a><!-- doxytag: member="ObjCryst::ZScatterer::XMLOutput" ref="a406d107bfd110c5c3de61208348d4ad0" args="(ostream &amp;os, int indent=0) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual void ObjCryst::ZScatterer::XMLOutput </td>
          <td>(</td>
          <td class="paramtype">ostream &amp;&nbsp;</td>
          <td class="paramname"> <em>os</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>indent</em> = <code>0</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Output to stream in well-formed XML. </p>
<dl class="todo"><dt><b><a class="el" href="a00221.html#_todo000026">Todo:</a></b></dt><dd>Use inheritance.. as for XMLInputTag()... </dd></dl>

<p>Reimplemented from <a class="el" href="a00070.html#a7b9b6ed0f8dcf753d398c35e073de973">ObjCryst::RefinableObj</a>.</p>

</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="aa02e92087f85784a74d1bdcebf178da9"></a><!-- doxytag: member="ObjCryst::ZScatterer::m3DDisplayIndex" ref="aa02e92087f85784a74d1bdcebf178da9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CrystMatrix_long <a class="el" href="a00155.html#aa02e92087f85784a74d1bdcebf178da9">ObjCryst::ZScatterer::m3DDisplayIndex</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>For 3D display of the structure, bonds, triangular and quadric faces can be displayed. </p>
<p>This matrix determines what is drawn. This is a 5-column matrix. The first column indicates the type of drawing (0: : nothing, 1: display the atom (a sphere), 2: bond, 3: triangular face, 4: quadric face) the other columns indicate the index of the atoms involved in the drawing (2 atoms for a bond, 3 for....)</p>
<p>If the matrix is empty only the individual atoms are displayed.</p>
<dl class="todo"><dt><b><a class="el" href="a00221.html#_todo000019">Todo:</a></b></dt><dd>This is still experimental. This is only used for the display of <a class="el" href="a00154.html" title="ZPolyhedron: a Scatterer to describe polyhedras such as octahedron, tetrahedron,...">ZPolyhedron</a>, and should be more developped (and it should also be saved in XML files !) </dd></dl>

</div>
</div>
<a class="anchor" id="a613abbb7f015620587e0bdaa750e5d03"></a><!-- doxytag: member="ObjCryst::ZScatterer::mCenterAtomIndex" ref="a613abbb7f015620587e0bdaa750e5d03" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long <a class="el" href="a00155.html#a613abbb7f015620587e0bdaa750e5d03">ObjCryst::ZScatterer::mCenterAtomIndex</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Index of the atom used as a pivot (the scatterer is rotated around this atom). </p>
<p>This should more or less be at the center of the <a class="el" href="a00084.html" title="Generic type of scatterer: can be an atom, or a more complex assembly of atoms.">Scatterer</a>. </p>

</div>
</div>
<a class="anchor" id="ab78108309d3a213454c7ac7d06da4dca"></a><!-- doxytag: member="ObjCryst::ZScatterer::mComponentIndex" ref="ab78108309d3a213454c7ac7d06da4dca" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CrystVector_int <a class="el" href="a00155.html#ab78108309d3a213454c7ac7d06da4dca">ObjCryst::ZScatterer::mComponentIndex</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Index of atoms in the <a class="el" href="a00086.html" title="list of scattering positions in a crystal, associated with the corresponding occupancy...">ScatteringComponentList</a>. </p>
<p>We need this list because Dummy atoms are not included in it. So this is an integer array with [ 0 1 2 4 5 6].. where the missing '3' marks a Dummy atom. Thus to get the name of component 'i' in the component list, you must take the mComponentIndex(i) atom in the <a class="el" href="a00152.html" title="Class for individual atoms in a ZScatterer Object.">ZAtom</a> Registry. </p>

</div>
</div>
<a class="anchor" id="a41e3dd665f7b096851b1f8109c56cd23"></a><!-- doxytag: member="ObjCryst::ZScatterer::mpGlobalScattPow" ref="a41e3dd665f7b096851b1f8109c56cd23" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00034.html">GlobalScatteringPower</a>* <a class="el" href="a00155.html#a41e3dd665f7b096851b1f8109c56cd23">ObjCryst::ZScatterer::mpGlobalScattPow</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>the global scattering power used, if mUseGlobalScattPow=true </p>
<dl class="warning"><dt><b>Warning:</b></dt><dd>EXPERIMENTAL. </dd></dl>

</div>
</div>
<a class="anchor" id="a42fe9734108865176b2f5ddf12e7ccff"></a><!-- doxytag: member="ObjCryst::ZScatterer::mPhi" ref="a42fe9734108865176b2f5ddf12e7ccff" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">REAL <a class="el" href="a00155.html#a42fe9734108865176b2f5ddf12e7ccff">ObjCryst::ZScatterer::mPhi</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Angles giving the orientation of the <a class="el" href="a00155.html" title="ZScatterer: the basic type of complex scatterers, where atom positions are defined...">ZScatterer</a> (stored in radian). </p>
<p>The position of any atom can be transformed from internal coordinates (orthonormal coordinates derived from the ZMatrix, with first atom at (0,0,0), second atom at (x,0,0), third atom at (x,y,0),...) to orthonormal coordinates in the crystal reference frame (ie with orientation of the <a class="el" href="a00155.html" title="ZScatterer: the basic type of complex scatterers, where atom positions are defined...">ZScatterer</a>) using : </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \left[ \begin{array}{c} x(i) \\ y(i) \\ z(i) \end{array} \right]_{orthonormal} = \left[ \begin{array}{ccc} \cos(\chi) &amp; 0 &amp; -\sin(\chi) \\ 0 &amp; 1 &amp; 0 \\ \sin(\chi) &amp; 0 &amp; \cos(\chi) \end{array} \right] \times \left[ \begin{array}{ccc} \cos(\phi) &amp; -\sin(\phi) &amp; 0 \\ \sin(\phi) &amp; \cos(\phi) &amp; 0 \\ 0 &amp; 0 &amp; 1 \end{array} \right] \times \left[ \begin{array}{ccc} 1 &amp; 0 &amp; 0 \\ 0 &amp; \cos(\psi) &amp; -\sin(\psi) \\ 0 &amp; \sin(\psi) &amp; \cos(\psi) \end{array} \right] \times \left[ \begin{array}{c} x_0(i) \\ y_0(i) \\ z_0(i) \end{array} \right] \]" src="form_39.png"/>
</p>
<p> , where x0(i), y0(i) and z0(i) describe the position for atom (i) in internal coordinates, and x(i), y(i), z(i) are coordinates of the rotated <a class="el" href="a00155.html" title="ZScatterer: the basic type of complex scatterers, where atom positions are defined...">ZScatterer</a>.</p>
<p>The rotation is performed around a 'pivot' atom (see ZScatterer::mPivotAtom) </p>

</div>
</div>
<a class="anchor" id="a971f73bdfed4eb3a9243fcdd7d20bcf3"></a><!-- doxytag: member="ObjCryst::ZScatterer::mUseGlobalScattPow" ref="a971f73bdfed4eb3a9243fcdd7d20bcf3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="a00155.html#a971f73bdfed4eb3a9243fcdd7d20bcf3">ObjCryst::ZScatterer::mUseGlobalScattPow</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Does the <a class="el" href="a00155.html" title="ZScatterer: the basic type of complex scatterers, where atom positions are defined...">ZScatterer</a> use a global scattering power ? </p>
<dl class="warning"><dt><b>Warning:</b></dt><dd>EXPERIMENTAL. </dd></dl>

</div>
</div>
<a class="anchor" id="a69918a0d5561e4076064e263616c4ed1"></a><!-- doxytag: member="ObjCryst::ZScatterer::mXCoord" ref="a69918a0d5561e4076064e263616c4ed1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CrystVector_REAL <a class="el" href="a00155.html#a69918a0d5561e4076064e263616c4ed1">ObjCryst::ZScatterer::mXCoord</a><code> [mutable, private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Storage for Cartesian coordinates. </p>
<p>The (0,0,0) is on the central atom. This includes Dummy atoms. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>ZScatterer.h</li>
</ul>
</div>
<hr class="footer"/><address style="text-align: right;"><small>Generated by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.2-20100208 </small></address>
</body>
</html>
