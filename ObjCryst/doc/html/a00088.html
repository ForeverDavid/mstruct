<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>ObjCryst++: ObjCryst::ScatteringData Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.2-20100208 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="classes.html"><span>Class&nbsp;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="a00170.html">ObjCryst</a>::<a class="el" href="a00088.html">ScatteringData</a>
  </div>
</div>
<div class="contents">
<h1>ObjCryst::ScatteringData Class Reference</h1><!-- doxytag: class="ObjCryst::ScatteringData" --><!-- doxytag: inherits="ObjCryst::RefinableObj" -->
<p>Class to compute structure factors for a set of reflections and a <a class="el" href="a00020.html" title="Crystal class: Unit cell, spacegroup, scatterers.">Crystal</a>.  
<a href="#_details">More...</a></p>
<div class="dynheader">
Inheritance diagram for ObjCryst::ScatteringData:</div>
<div class="dynsection">
 <div class="center">
  <img src="a00088.png" usemap="#ObjCryst::ScatteringData_map" alt=""/>
  <map id="ObjCryst::ScatteringData_map" name="ObjCryst::ScatteringData_map">
<area href="a00070.html" alt="ObjCryst::RefinableObj" shape="rect" coords="119,0,347,24"/>
<area href="a00026.html" alt="ObjCryst::DiffractionDataSingleCrystal" shape="rect" coords="0,112,228,136"/>
<area href="a00065.html" alt="ObjCryst::PowderPatternDiffraction" shape="rect" coords="238,112,466,136"/>
</map>
 </div>
</div>

<p><a href="a00294.html">List of all members.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a903a77bd764277db294220be8c560fbf"></a><!-- doxytag: member="ObjCryst::ScatteringData::ScatteringData" ref="a903a77bd764277db294220be8c560fbf" args="(const ScatteringData &amp;old)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><b>ScatteringData</b> (const <a class="el" href="a00088.html">ScatteringData</a> &amp;old)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9356e72bc7a48184692100d0d1ee8ea1"></a><!-- doxytag: member="ObjCryst::ScatteringData::CreateCopy" ref="a9356e72bc7a48184692100d0d1ee8ea1" args="() const =0" -->
virtual <a class="el" href="a00088.html">ScatteringData</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a9356e72bc7a48184692100d0d1ee8ea1">CreateCopy</a> () const =0</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">So-called virtual copy constructor. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#aada0135fdf333760b7b2627b6f36206c">SetHKL</a> (const CrystVector_REAL &amp;h, const CrystVector_REAL &amp;k, const CrystVector_REAL &amp;l)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">input H,K,L  <a href="#aada0135fdf333760b7b2627b6f36206c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#acfb56224331e834478baf240813f7432">GenHKLFullSpace2</a> (const REAL maxsithsl, const bool unique=false)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Generate a list of h,k,l to describe a full reciprocal space, up to a given maximum theta value.  <a href="#acfb56224331e834478baf240813f7432"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a5fee409771ee116fae73d7cc530aee6a">GenHKLFullSpace</a> (const REAL maxTheta, const bool unique=false)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Generate a list of h,k,l to describe a full reciprocal space, up to a given maximum theta value.  <a href="#a5fee409771ee116fae73d7cc530aee6a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a20166ceef04122ede9bd6534cf645a86"></a><!-- doxytag: member="ObjCryst::ScatteringData::GetRadiationType" ref="a20166ceef04122ede9bd6534cf645a86" args="() const " -->
<a class="el" href="a00170.html#a48fe50a094c607f8897378934d3d73ef">RadiationType</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a20166ceef04122ede9bd6534cf645a86">GetRadiationType</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Neutron or x-ray experiment ? Wavelength ? <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a14deaa47d5b79d12369ed5d8d4afbfbe"></a><!-- doxytag: member="ObjCryst::ScatteringData::GetRadiation" ref="a14deaa47d5b79d12369ed5d8d4afbfbe" args="() const =0" -->
virtual const <a class="el" href="a00068.html">Radiation</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a14deaa47d5b79d12369ed5d8d4afbfbe">GetRadiation</a> () const =0</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the radiation object for this data. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a75ea37efc16db856fff9b8832b524284">SetCrystal</a> (<a class="el" href="a00020.html">Crystal</a> &amp;crystal)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set the crystal for this experiment.  <a href="#a75ea37efc16db856fff9b8832b524284"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a966649e9385039c2c351bdea78b031e8"></a><!-- doxytag: member="ObjCryst::ScatteringData::GetCrystal" ref="a966649e9385039c2c351bdea78b031e8" args="() const " -->
const <a class="el" href="a00020.html">Crystal</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a966649e9385039c2c351bdea78b031e8">GetCrystal</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Const access to the data's crystal. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a66a413655f9de7de6ed058ce3824a241"></a><!-- doxytag: member="ObjCryst::ScatteringData::GetCrystal" ref="a66a413655f9de7de6ed058ce3824a241" args="()" -->
<a class="el" href="a00020.html">Crystal</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a66a413655f9de7de6ed058ce3824a241">GetCrystal</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Access to the data's crystal. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a11d7f74e603192b865cf370bbb5468b8"></a><!-- doxytag: member="ObjCryst::ScatteringData::GetNbRefl" ref="a11d7f74e603192b865cf370bbb5468b8" args="() const " -->
long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a11d7f74e603192b865cf370bbb5468b8">GetNbRefl</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the number of reflections in this experiment. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2c9dcb826c09824f9ea6d00496926e42"></a><!-- doxytag: member="ObjCryst::ScatteringData::GetH" ref="a2c9dcb826c09824f9ea6d00496926e42" args="() const " -->
const CrystVector_REAL &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a2c9dcb826c09824f9ea6d00496926e42">GetH</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the 1D array of H coordinates for all reflections. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad12390677c09a1d61a239de80fc60ec0"></a><!-- doxytag: member="ObjCryst::ScatteringData::GetK" ref="ad12390677c09a1d61a239de80fc60ec0" args="() const " -->
const CrystVector_REAL &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#ad12390677c09a1d61a239de80fc60ec0">GetK</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the 1D array of K coordinates for all reflections. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3e20ec3ee12beaa5f9f58a475d145866"></a><!-- doxytag: member="ObjCryst::ScatteringData::GetL" ref="a3e20ec3ee12beaa5f9f58a475d145866" args="() const " -->
const CrystVector_REAL &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a3e20ec3ee12beaa5f9f58a475d145866">GetL</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the 1D array of L coordinates for all reflections. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const CrystVector_REAL &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#ad79b3ec44d9dcf512c2015f55c72bf67">GetH2Pi</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the 1D array of H coordinates for all reflections, multiplied by 2*pi.  <a href="#ad79b3ec44d9dcf512c2015f55c72bf67"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const CrystVector_REAL &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a092d2c4539f4d318cd5dbfa423d0c2fb">GetK2Pi</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the 1D array of K coordinates for all reflections, multiplied by 2*pi.  <a href="#a092d2c4539f4d318cd5dbfa423d0c2fb"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const CrystVector_REAL &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a27efeb3532f93c273e6d53af74fd8804">GetL2Pi</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the 1D array of L coordinates for all reflections, multiplied by 2*pi.  <a href="#a27efeb3532f93c273e6d53af74fd8804"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a10dfb4fe4da3445503bba6a40f39b354"></a><!-- doxytag: member="ObjCryst::ScatteringData::GetReflX" ref="a10dfb4fe4da3445503bba6a40f39b354" args="() const " -->
const CrystVector_REAL &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a10dfb4fe4da3445503bba6a40f39b354">GetReflX</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the 1D array of orthonormal x coordinates for all reflections (recipr. space). <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a30bb85e249b057d592c4c0b5262c8ec1"></a><!-- doxytag: member="ObjCryst::ScatteringData::GetReflY" ref="a30bb85e249b057d592c4c0b5262c8ec1" args="() const " -->
const CrystVector_REAL &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a30bb85e249b057d592c4c0b5262c8ec1">GetReflY</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the 1D array of orthonormal y coordinates for all reflections (recipr. space). <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2802607e29950c125742b45e2085e551"></a><!-- doxytag: member="ObjCryst::ScatteringData::GetReflZ" ref="a2802607e29950c125742b45e2085e551" args="() const " -->
const CrystVector_REAL &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a2802607e29950c125742b45e2085e551">GetReflZ</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the 1D array of orthonormal z coordinates for all reflections (recipr. space). <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3150d51e5ec7adb1a842fa2055e70537"></a><!-- doxytag: member="ObjCryst::ScatteringData::GetSinThetaOverLambda" ref="a3150d51e5ec7adb1a842fa2055e70537" args="() const " -->
const CrystVector_REAL &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a3150d51e5ec7adb1a842fa2055e70537">GetSinThetaOverLambda</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return an array with <img class="formulaInl" alt="$ \frac{sin(\theta)}{\lambda} = \frac{1}{2d_{hkl}}$" src="form_31.png"/> for all reflections. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aede7a50a0ac03fe15557191059ba552b"></a><!-- doxytag: member="ObjCryst::ScatteringData::GetTheta" ref="aede7a50a0ac03fe15557191059ba552b" args="() const " -->
const CrystVector_REAL &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#aede7a50a0ac03fe15557191059ba552b">GetTheta</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return an array with theta values for all reflections. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aca474e1e20c1a56ff4bfc8421b6425a0"></a><!-- doxytag: member="ObjCryst::ScatteringData::GetClockTheta" ref="aca474e1e20c1a56ff4bfc8421b6425a0" args="() const " -->
const <a class="el" href="a00071.html">RefinableObjClock</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#aca474e1e20c1a56ff4bfc8421b6425a0">GetClockTheta</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Clock the last time the sin(theta)/lambda and theta arrays were re-computed. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9e36c9b59ed495c594619e4483fa9079"></a><!-- doxytag: member="ObjCryst::ScatteringData::GetFhklCalcSq" ref="a9e36c9b59ed495c594619e4483fa9079" args="() const " -->
const CrystVector_REAL &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a9e36c9b59ed495c594619e4483fa9079">GetFhklCalcSq</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the Array of calculated |F(hkl)|^2 for all reflections. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a19ffd12fa3dc8a24a48b0f33aeef3f1b"></a><!-- doxytag: member="ObjCryst::ScatteringData::GetFhklCalcReal" ref="a19ffd12fa3dc8a24a48b0f33aeef3f1b" args="() const " -->
const CrystVector_REAL &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a19ffd12fa3dc8a24a48b0f33aeef3f1b">GetFhklCalcReal</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Access to real part of F(hkl)calc. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab6589249a39e310dc8b9b69da8b5d6a8"></a><!-- doxytag: member="ObjCryst::ScatteringData::GetFhklCalcImag" ref="ab6589249a39e310dc8b9b69da8b5d6a8" args="() const " -->
const CrystVector_REAL &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#ab6589249a39e310dc8b9b69da8b5d6a8">GetFhklCalcImag</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Access to imaginary part of F(hkl)calc. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="afe5d217f0775fe7c65d7eb84ed4213ac"></a><!-- doxytag: member="ObjCryst::ScatteringData::GetFhklObsSq" ref="afe5d217f0775fe7c65d7eb84ed4213ac" args="() const " -->
const CrystVector_REAL &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#afe5d217f0775fe7c65d7eb84ed4213ac">GetFhklObsSq</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the Array of observed |F(hkl)|^2 for all reflections. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6415646188e66a451624e78d32999d05"></a><!-- doxytag: member="ObjCryst::ScatteringData::GetScatteringFactor" ref="a6415646188e66a451624e78d32999d05" args="() const " -->
const map&lt; const <br class="typebreak"/>
<a class="el" href="a00089.html">ScatteringPower</a> <br class="typebreak"/>
*, CrystVector_REAL &gt; &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a6415646188e66a451624e78d32999d05">GetScatteringFactor</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Scattering factors for each <a class="el" href="a00089.html" title="Abstract Base Class to describe the scattering power of any Scatterer component in...">ScatteringPower</a>, as vectors with NbRefl elements. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0f0c7dc22a095e2c861c79440fed9b93"></a><!-- doxytag: member="ObjCryst::ScatteringData::GetWavelength" ref="a0f0c7dc22a095e2c861c79440fed9b93" args="() const " -->
CrystVector_REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a0f0c7dc22a095e2c861c79440fed9b93">GetWavelength</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">wavelength of the experiment (in Angstroems) <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#ae126b860d309daa78e975b8b6d8a3ec0">SetIsIgnoringImagScattFact</a> (const bool b)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">If true, then the imaginary part of the scattering factor is ignored during Structure factor computation.  <a href="#ae126b860d309daa78e975b8b6d8a3ec0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a24cdbd2eb620d7d972ce4b6ccf23a0b0">IsIgnoringImagScattFact</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">If true, then the imaginary part of the scattering factor is ignored during Structure factor computation.  <a href="#a24cdbd2eb620d7d972ce4b6ccf23a0b0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#ace1458ac95c287fffa89049f58ac0a41">PrintFhklCalc</a> (ostream &amp;os=cout) const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Print H, K, L F^2 Re(F) Im(F) theta sin(theta)/lambda for all reflections.  <a href="#ace1458ac95c287fffa89049f58ac0a41"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad5519dfdb73da540c705173218905309"></a><!-- doxytag: member="ObjCryst::ScatteringData::PrintFhklCalcDetail" ref="ad5519dfdb73da540c705173218905309" args="(ostream &amp;os=cout) const " -->
virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#ad5519dfdb73da540c705173218905309">PrintFhklCalcDetail</a> (ostream &amp;os=cout) const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Print H, K, L sin(theta)/lambda theta F^2 Re(F) Im(F) [Re(F) Im(F)]_i, where [Re(F) Im(F)]_i are the real and imaginary contribution of the different scattering powers to the overall structure factor. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a6b0f18996edafa21a03bf9550dcf8981">BeginOptimization</a> (const bool allowApproximations=false, const bool enableRestraints=false)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This should be called by any optimization class at the begining of an optimization.  <a href="#a6b0f18996edafa21a03bf9550dcf8981"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a782e0caf5c6f2941ca64d17293b1e8b4">EndOptimization</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">This should be called by any optimization class at the end of an optimization.  <a href="#a782e0caf5c6f2941ca64d17293b1e8b4"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a109ed8c2e8dc676e77aa80feafa91071">SetApproximationFlag</a> (const bool allow)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Enable or disable numerical approximations.  <a href="#a109ed8c2e8dc676e77aa80feafa91071"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a54629fa52fe111d2867797ae1204ddf8">SetMaxSinThetaOvLambda</a> (const REAL max)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set the maximum value for sin(theta)/lambda.  <a href="#a54629fa52fe111d2867797ae1204ddf8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad682b6879c751fd4d241a198b1893e6e"></a><!-- doxytag: member="ObjCryst::ScatteringData::GetMaxSinThetaOvLambda" ref="ad682b6879c751fd4d241a198b1893e6e" args="() const " -->
REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#ad682b6879c751fd4d241a198b1893e6e">GetMaxSinThetaOvLambda</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the maximum value for sin(theta)/lambda. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#aac8034f8b0f6980c619e595ce6ba1d65">GetNbReflBelowMaxSinThetaOvLambda</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Recalc, and get the number of reflections which should be actually used, due to the maximuml sin(theta)/lambda value set.  <a href="#aac8034f8b0f6980c619e595ce6ba1d65"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a44e729df21dc6710d222724b55ab4254"></a><!-- doxytag: member="ObjCryst::ScatteringData::GetClockNbReflBelowMaxSinThetaOvLambda" ref="a44e729df21dc6710d222724b55ab4254" args="() const " -->
const <a class="el" href="a00071.html">RefinableObjClock</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a44e729df21dc6710d222724b55ab4254">GetClockNbReflBelowMaxSinThetaOvLambda</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Clock the last time the number of reflections used was changed. <br/></td></tr>
<tr><td colspan="2"><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a0c01e0c2ffbe9bfbb92d7b5751e420e2">PrepareHKLarrays</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual CrystVector_long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a4b843c3350e25d4d0c52da3400768fb7">SortReflectionBySinThetaOverLambda</a> (const REAL maxSTOL=-1.)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">CrystVector_long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#ac8cc7361579cd633ae295823a235813c">EliminateExtinctReflections</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a36f66ab4f80103384551fa5c649eac8c">CalcSinThetaLambda</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#aa15aa0bf6efdecc4843bb2924a197be8">CalcScattFactor</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#ab9073f536aa7312de2ceb97e1b1ddcbd">CalcTemperatureFactor</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a4189bd87d77c86063609bb8f2c56a62f">CalcResonantScattFactor</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a324662c4eb164b080ac06c92a4627f1f"></a><!-- doxytag: member="ObjCryst::ScatteringData::CalcGlobalTemperatureFactor" ref="a324662c4eb164b080ac06c92a4627f1f" args="() const " -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a324662c4eb164b080ac06c92a4627f1f">CalcGlobalTemperatureFactor</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute the overall temperature factor affecting all reflections. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#aceb9551affff0a8c53c6d0e80d0536a2">CalcStructFactor</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute the overall structure factor (real <b>and</b> imaginary part).  <a href="#aceb9551affff0a8c53c6d0e80d0536a2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#abbb21a3870c4ad22501a5ed95fa8f1f9">CalcGeomStructFactor</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Compute the 'Geometrical Structure Factor' for each <a class="el" href="a00089.html" title="Abstract Base Class to describe the scattering power of any Scatterer component in...">ScatteringPower</a> of the <a class="el" href="a00020.html" title="Crystal class: Unit cell, spacegroup, scatterers.">Crystal</a>.  <a href="#abbb21a3870c4ad22501a5ed95fa8f1f9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2f49b0c18be65eb9fbe3d78210f662c3"></a><!-- doxytag: member="ObjCryst::ScatteringData::CalcLuzzatiFactor" ref="a2f49b0c18be65eb9fbe3d78210f662c3" args="() const " -->
void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a2f49b0c18be65eb9fbe3d78210f662c3">CalcLuzzatiFactor</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Calculate the Luzzati factor associated to each <a class="el" href="a00089.html" title="Abstract Base Class to describe the scattering power of any Scatterer component in...">ScatteringPower</a> and each reflection, for maximum likelihood optimization. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a86079e8b7f2f5a9f8bccfdd0a6ecc25a">CalcStructFactVariance</a> () const </td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Calculate the variance associated to the calculated structure factor.  <a href="#a86079e8b7f2f5a9f8bccfdd0a6ecc25a"></a><br/></td></tr>
<tr><td colspan="2"><h2>Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aba357b481cf3c012da758218da7ff726"></a><!-- doxytag: member="ObjCryst::ScatteringData::mNbRefl" ref="aba357b481cf3c012da758218da7ff726" args="" -->
long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#aba357b481cf3c012da758218da7ff726">mNbRefl</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Number of H,K,L reflections. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac589707de5e5d4f0122314d4ba034572"></a><!-- doxytag: member="ObjCryst::ScatteringData::mH" ref="ac589707de5e5d4f0122314d4ba034572" args="" -->
CrystVector_REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#ac589707de5e5d4f0122314d4ba034572">mH</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">H,K,L coordinates. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a880e2a060579e815eadbbeefcbba7084"></a><!-- doxytag: member="ObjCryst::ScatteringData::mK" ref="a880e2a060579e815eadbbeefcbba7084" args="" -->
CrystVector_REAL&nbsp;</td><td class="memItemRight" valign="bottom"><b>mK</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a836d6399a8f5735af724694e63a31d34"></a><!-- doxytag: member="ObjCryst::ScatteringData::mL" ref="a836d6399a8f5735af724694e63a31d34" args="" -->
CrystVector_REAL&nbsp;</td><td class="memItemRight" valign="bottom"><b>mL</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac6300cac304360f11ce20a340a786aee"></a><!-- doxytag: member="ObjCryst::ScatteringData::mIntH" ref="ac6300cac304360f11ce20a340a786aee" args="" -->
CrystVector_long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#ac6300cac304360f11ce20a340a786aee">mIntH</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">H,K,L integer coordinates. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a42ee2b356e4f1621a32a5f7f495fd0c7"></a><!-- doxytag: member="ObjCryst::ScatteringData::mIntK" ref="a42ee2b356e4f1621a32a5f7f495fd0c7" args="" -->
CrystVector_long&nbsp;</td><td class="memItemRight" valign="bottom"><b>mIntK</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4f86b449b7e9e0e6ff9a804ebdd598b9"></a><!-- doxytag: member="ObjCryst::ScatteringData::mIntL" ref="a4f86b449b7e9e0e6ff9a804ebdd598b9" args="" -->
CrystVector_long&nbsp;</td><td class="memItemRight" valign="bottom"><b>mIntL</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af9ccd5e0d976d303fb8d84e27d799cdf"></a><!-- doxytag: member="ObjCryst::ScatteringData::mH2Pi" ref="af9ccd5e0d976d303fb8d84e27d799cdf" args="" -->
CrystVector_REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#af9ccd5e0d976d303fb8d84e27d799cdf">mH2Pi</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">H,K,L coordinates, multiplied by 2PI. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0d08c79a1293a32afa79908533cc94d3"></a><!-- doxytag: member="ObjCryst::ScatteringData::mK2Pi" ref="a0d08c79a1293a32afa79908533cc94d3" args="" -->
CrystVector_REAL&nbsp;</td><td class="memItemRight" valign="bottom"><b>mK2Pi</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1b551f2ee693eb56a69bd99f58831927"></a><!-- doxytag: member="ObjCryst::ScatteringData::mL2Pi" ref="a1b551f2ee693eb56a69bd99f58831927" args="" -->
CrystVector_REAL&nbsp;</td><td class="memItemRight" valign="bottom"><b>mL2Pi</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a93547f7f9c1c8d69222e501aee68b07d"></a><!-- doxytag: member="ObjCryst::ScatteringData::mX" ref="a93547f7f9c1c8d69222e501aee68b07d" args="" -->
CrystVector_REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a93547f7f9c1c8d69222e501aee68b07d">mX</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">reflection coordinates in an orthonormal base <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5aeecfc21d47eb84e60d9ea1900aa6c0"></a><!-- doxytag: member="ObjCryst::ScatteringData::mY" ref="a5aeecfc21d47eb84e60d9ea1900aa6c0" args="" -->
CrystVector_REAL&nbsp;</td><td class="memItemRight" valign="bottom"><b>mY</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af4b63c112d8865006db7660516859a69"></a><!-- doxytag: member="ObjCryst::ScatteringData::mZ" ref="af4b63c112d8865006db7660516859a69" args="" -->
CrystVector_REAL&nbsp;</td><td class="memItemRight" valign="bottom"><b>mZ</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="affaae453ef7ac110ab7a1f0abb2c50a7"></a><!-- doxytag: member="ObjCryst::ScatteringData::mMultiplicity" ref="affaae453ef7ac110ab7a1f0abb2c50a7" args="" -->
CrystVector_int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#affaae453ef7ac110ab7a1f0abb2c50a7">mMultiplicity</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Multiplicity for each reflections (mostly for powder diffraction). <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">CrystVector_int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a8296cf05015c7c4bbfc1dc7b443e3096">mExpectedIntensityFactor</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Expected intensity factor for all reflections.  <a href="#a8296cf05015c7c4bbfc1dc7b443e3096"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8544897db01ff8f9cb7a245c49c7a4e4"></a><!-- doxytag: member="ObjCryst::ScatteringData::mFhklCalcReal" ref="a8544897db01ff8f9cb7a245c49c7a4e4" args="" -->
CrystVector_REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a8544897db01ff8f9cb7a245c49c7a4e4">mFhklCalcReal</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">real &amp;imaginary parts of F(HKL)calc <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a048112ed1fa83eeb209843140e86a41c"></a><!-- doxytag: member="ObjCryst::ScatteringData::mFhklCalcImag" ref="a048112ed1fa83eeb209843140e86a41c" args="" -->
CrystVector_REAL&nbsp;</td><td class="memItemRight" valign="bottom"><b>mFhklCalcImag</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5c61007b1d35f8af192cbb86da7c1ba9"></a><!-- doxytag: member="ObjCryst::ScatteringData::mFhklCalcSq" ref="a5c61007b1d35f8af192cbb86da7c1ba9" args="" -->
CrystVector_REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a5c61007b1d35f8af192cbb86da7c1ba9">mFhklCalcSq</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">F(HKL)^2 calc for each reflection. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="a00020.html">Crystal</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a8c4e778a97e93098d585ffdc597dbb54">mpCrystal</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Pointer to the crystal corresponding to this experiment.  <a href="#a8c4e778a97e93098d585ffdc597dbb54"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a15f71120c0eabe7b1bd768663a176752"></a><!-- doxytag: member="ObjCryst::ScatteringData::mGlobalBiso" ref="a15f71120c0eabe7b1bd768663a176752" args="" -->
REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a15f71120c0eabe7b1bd768663a176752">mGlobalBiso</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Global Biso, affecting the overall structure factor for all reflections (but not the structure factors of individual atoms or type of atomes). <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af12d3e0312ba9dc9488ca1db7f35be56"></a><!-- doxytag: member="ObjCryst::ScatteringData::mGlobalTemperatureFactor" ref="af12d3e0312ba9dc9488ca1db7f35be56" args="" -->
CrystVector_REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#af12d3e0312ba9dc9488ca1db7f35be56">mGlobalTemperatureFactor</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Global Biso factor. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a7a3fa9e9ea5c3a1dc6076f69ad584ad7">mUseFastLessPreciseFunc</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Use faster, but less precise, approximations for functions? (integer approximations to compute sin and cos in structure factors, and also to compute interatomic distances).  <a href="#a7a3fa9e9ea5c3a1dc6076f69ad584ad7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a06804c1df56b267a8ecb0218e061bdb4"></a><!-- doxytag: member="ObjCryst::ScatteringData::mSinThetaLambda" ref="a06804c1df56b267a8ecb0218e061bdb4" args="" -->
CrystVector_REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a06804c1df56b267a8ecb0218e061bdb4">mSinThetaLambda</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><img class="formulaInl" alt="$ \frac{sin(\theta)}{\lambda} = \frac{1}{2d_{hkl}}$" src="form_31.png"/> for the crystal and the reflections in ReciprSpace <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae7b30bacb0d4bd5e1e54590b7567392f"></a><!-- doxytag: member="ObjCryst::ScatteringData::mTheta" ref="ae7b30bacb0d4bd5e1e54590b7567392f" args="" -->
CrystVector_REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#ae7b30bacb0d4bd5e1e54590b7567392f">mTheta</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">theta for the crystal and the HKL in ReciprSpace (in radians) <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">map&lt; const <a class="el" href="a00089.html">ScatteringPower</a> <br class="typebreak"/>
*, REAL &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a13e1ec375416a17f94370a4cf4bd5583">mvFprime</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Anomalous X-Ray scattering term f' and f" are stored here for each <a class="el" href="a00089.html" title="Abstract Base Class to describe the scattering power of any Scatterer component in...">ScatteringPower</a> We store here only a value.  <a href="#a13e1ec375416a17f94370a4cf4bd5583"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a57882d7477ac1567e1c2caf72f56e9d2"></a><!-- doxytag: member="ObjCryst::ScatteringData::mvFsecond" ref="a57882d7477ac1567e1c2caf72f56e9d2" args="" -->
map&lt; const <a class="el" href="a00089.html">ScatteringPower</a> <br class="typebreak"/>
*, REAL &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><b>mvFsecond</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a66d5208047bdd6bf1eb066926adc676f"></a><!-- doxytag: member="ObjCryst::ScatteringData::mvTemperatureFactor" ref="a66d5208047bdd6bf1eb066926adc676f" args="" -->
map&lt; const <a class="el" href="a00089.html">ScatteringPower</a> <br class="typebreak"/>
*, CrystVector_REAL &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a66d5208047bdd6bf1eb066926adc676f">mvTemperatureFactor</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Thermic factors for each <a class="el" href="a00089.html" title="Abstract Base Class to describe the scattering power of any Scatterer component in...">ScatteringPower</a>, as vectors with NbRefl elements. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a130783a5c9beffd3791ee1885953b4cd"></a><!-- doxytag: member="ObjCryst::ScatteringData::mvScatteringFactor" ref="a130783a5c9beffd3791ee1885953b4cd" args="" -->
map&lt; const <a class="el" href="a00089.html">ScatteringPower</a> <br class="typebreak"/>
*, CrystVector_REAL &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a130783a5c9beffd3791ee1885953b4cd">mvScatteringFactor</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Scattering factors for each <a class="el" href="a00089.html" title="Abstract Base Class to describe the scattering power of any Scatterer component in...">ScatteringPower</a>, as vectors with NbRefl elements. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a938a4a024e6fd830786bb22d1171c084"></a><!-- doxytag: member="ObjCryst::ScatteringData::mvRealGeomSF" ref="a938a4a024e6fd830786bb22d1171c084" args="" -->
map&lt; const <a class="el" href="a00089.html">ScatteringPower</a> <br class="typebreak"/>
*, CrystVector_REAL &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a938a4a024e6fd830786bb22d1171c084">mvRealGeomSF</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Geometrical Structure factor for each <a class="el" href="a00089.html" title="Abstract Base Class to describe the scattering power of any Scatterer component in...">ScatteringPower</a>, as vectors with NbRefl elements. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5dbceac44c1e2f76279dc4e6160c47eb"></a><!-- doxytag: member="ObjCryst::ScatteringData::mvImagGeomSF" ref="a5dbceac44c1e2f76279dc4e6160c47eb" args="" -->
map&lt; const <a class="el" href="a00089.html">ScatteringPower</a> <br class="typebreak"/>
*, CrystVector_REAL &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><b>mvImagGeomSF</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="afad19f562c1f34565391c0a05028516f"></a><!-- doxytag: member="ObjCryst::ScatteringData::mClockHKL" ref="afad19f562c1f34565391c0a05028516f" args="" -->
<a class="el" href="a00071.html">RefinableObjClock</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#afad19f562c1f34565391c0a05028516f">mClockHKL</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Clock for the list of hkl. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a182f20f79682668151ee46092dce98a2"></a><!-- doxytag: member="ObjCryst::ScatteringData::mClockStructFactor" ref="a182f20f79682668151ee46092dce98a2" args="" -->
<a class="el" href="a00071.html">RefinableObjClock</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a182f20f79682668151ee46092dce98a2">mClockStructFactor</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Clock for the structure factor. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a65bf8a4033d331408ba09548eaa202d2"></a><!-- doxytag: member="ObjCryst::ScatteringData::mClockStructFactorSq" ref="a65bf8a4033d331408ba09548eaa202d2" args="" -->
<a class="el" href="a00071.html">RefinableObjClock</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a65bf8a4033d331408ba09548eaa202d2">mClockStructFactorSq</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Clock for the square modulus of the structure factor. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a22e1b86b0bc485070ebe11bf1461bbe3"></a><!-- doxytag: member="ObjCryst::ScatteringData::mClockTheta" ref="a22e1b86b0bc485070ebe11bf1461bbe3" args="" -->
<a class="el" href="a00071.html">RefinableObjClock</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a22e1b86b0bc485070ebe11bf1461bbe3">mClockTheta</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Clock the last time theta was computed. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8ce62b5bfb1fcd804c67dbd930b1f548"></a><!-- doxytag: member="ObjCryst::ScatteringData::mClockScattFactor" ref="a8ce62b5bfb1fcd804c67dbd930b1f548" args="" -->
<a class="el" href="a00071.html">RefinableObjClock</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a8ce62b5bfb1fcd804c67dbd930b1f548">mClockScattFactor</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Clock the last time scattering factors were computed. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af3c0765a73ec998573658cce33ccb2c1"></a><!-- doxytag: member="ObjCryst::ScatteringData::mClockScattFactorResonant" ref="af3c0765a73ec998573658cce33ccb2c1" args="" -->
<a class="el" href="a00071.html">RefinableObjClock</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#af3c0765a73ec998573658cce33ccb2c1">mClockScattFactorResonant</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Clock the last time resonant scattering factors were computed. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="adae75c08082bf39716f00acf417a661c"></a><!-- doxytag: member="ObjCryst::ScatteringData::mClockGeomStructFact" ref="adae75c08082bf39716f00acf417a661c" args="" -->
<a class="el" href="a00071.html">RefinableObjClock</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#adae75c08082bf39716f00acf417a661c">mClockGeomStructFact</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Clock the last time the geometrical structure factors were computed. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4295811a2c12d31985b51e2ab6c40088"></a><!-- doxytag: member="ObjCryst::ScatteringData::mClockThermicFact" ref="a4295811a2c12d31985b51e2ab6c40088" args="" -->
<a class="el" href="a00071.html">RefinableObjClock</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a4295811a2c12d31985b51e2ab6c40088">mClockThermicFact</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Clock the last time temperature factors were computed. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aabaceea890c524c14ca3e6c898d27f8f"></a><!-- doxytag: member="ObjCryst::ScatteringData::mClockGlobalBiso" ref="aabaceea890c524c14ca3e6c898d27f8f" args="" -->
<a class="el" href="a00071.html">RefinableObjClock</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#aabaceea890c524c14ca3e6c898d27f8f">mClockGlobalBiso</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">last time the global Biso factor was modified <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a20c193cc38f93c26926dd0d362066ec0"></a><!-- doxytag: member="ObjCryst::ScatteringData::mClockGlobalTemperatureFact" ref="a20c193cc38f93c26926dd0d362066ec0" args="" -->
<a class="el" href="a00071.html">RefinableObjClock</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a20c193cc38f93c26926dd0d362066ec0">mClockGlobalTemperatureFact</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">last time the global temperature factor was computed <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a3a9764c52916a533a44baaea89bdceab">mIgnoreImagScattFact</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Ignore imaginary part of scattering factor.  <a href="#a3a9764c52916a533a44baaea89bdceab"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#acb0398e21f803308b79103182906f6c5">mMaxSinThetaOvLambda</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Maximum sin(theta)/lambda for all calculations (10 by default).  <a href="#acb0398e21f803308b79103182906f6c5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">long&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a00e0972eebd70ae92231b804884a83b6">mNbReflUsed</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Number of reflections which are below the max.  <a href="#a00e0972eebd70ae92231b804884a83b6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a03a5d099c5ff2c41dc37e4f849e5be7b"></a><!-- doxytag: member="ObjCryst::ScatteringData::mClockNbReflUsed" ref="a03a5d099c5ff2c41dc37e4f849e5be7b" args="" -->
<a class="el" href="a00071.html">RefinableObjClock</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a03a5d099c5ff2c41dc37e4f849e5be7b">mClockNbReflUsed</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Clock recording the last time the number of reflections used has increased. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8b9610ceeee8a68a39fc2f13e14d0391"></a><!-- doxytag: member="ObjCryst::ScatteringData::mvLuzzatiFactor" ref="a8b9610ceeee8a68a39fc2f13e14d0391" args="" -->
map&lt; const <a class="el" href="a00089.html">ScatteringPower</a> <br class="typebreak"/>
*, CrystVector_REAL &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a8b9610ceeee8a68a39fc2f13e14d0391">mvLuzzatiFactor</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The Luzzati 'D' factor for each scattering power and each reflection. <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">CrystVector_REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a85ab0dd2973824fc2ad62fb6fef2e274">mFhklCalcVariance</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The variance on all calculated structure factors, taking into account the positionnal errors and the expected intensity factor.  <a href="#a85ab0dd2973824fc2ad62fb6fef2e274"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a20ce8091b6bf08d1a37cdebb6e254ac1"></a><!-- doxytag: member="ObjCryst::ScatteringData::mClockLuzzatiFactor" ref="a20ce8091b6bf08d1a37cdebb6e254ac1" args="" -->
<a class="el" href="a00071.html">RefinableObjClock</a>&nbsp;</td><td class="memItemRight" valign="bottom"><b>mClockLuzzatiFactor</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a401ebb00cb9677b9f2faf62ed326c8da"></a><!-- doxytag: member="ObjCryst::ScatteringData::mClockFhklCalcVariance" ref="a401ebb00cb9677b9f2faf62ed326c8da" args="" -->
<a class="el" href="a00071.html">RefinableObjClock</a>&nbsp;</td><td class="memItemRight" valign="bottom"><b>mClockFhklCalcVariance</b></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a71ebbc98f69dab63f03d7fb032228e1e"></a><!-- doxytag: member="ObjCryst::ScatteringData::mFhklObsSq" ref="a71ebbc98f69dab63f03d7fb032228e1e" args="" -->
CrystVector_REAL&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a71ebbc98f69dab63f03d7fb032228e1e">mFhklObsSq</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Observed squared structure factors (zero-sized if none). <br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1ea122e6d6eb2c987a7e4f59ec111714"></a><!-- doxytag: member="ObjCryst::ScatteringData::mClockFhklObsSq" ref="a1ea122e6d6eb2c987a7e4f59ec111714" args="" -->
<a class="el" href="a00071.html">RefinableObjClock</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00088.html#a1ea122e6d6eb2c987a7e4f59ec111714">mClockFhklObsSq</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Last time observed squared structure factors were altered. <br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>Class to compute structure factors for a set of reflections and a <a class="el" href="a00020.html" title="Crystal class: Unit cell, spacegroup, scatterers.">Crystal</a>. </p>
<p>This class only computes structure factor, but no intensity. i.e. it does not include any correction such as absorption, Lorentz or Polarization.</p>
<p>Does this really need to be a <a class="el" href="a00070.html" title="Generic Refinable Object.">RefinableObj</a> ? </p>
<dl class="todo"><dt><b><a class="el" href="a00221.html#_todo000010">Todo:</a></b></dt><dd>Optimize computation for Bijvoet/Friedel mates. To do this, generate an internal list of 'true independent reflections', with two entries for each, for both mates, and make the 'real' reflections only a reference to these reflections.</dd></dl>
<dl class="todo"><dt><b><a class="el" href="a00221.html#_todo000011">Todo:</a></b></dt><dd>a <b>lot</b> of cleaning is necessary in the computing of structure factors, for (1) the 'preparation' part (deciding what needs to be recomputed) and (2) to allow anisotropic temperature factors (or other anisotropic parts) </dd></dl>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a6b0f18996edafa21a03bf9550dcf8981"></a><!-- doxytag: member="ObjCryst::ScatteringData::BeginOptimization" ref="a6b0f18996edafa21a03bf9550dcf8981" args="(const bool allowApproximations=false, const bool enableRestraints=false)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual void ObjCryst::ScatteringData::BeginOptimization </td>
          <td>(</td>
          <td class="paramtype">const bool&nbsp;</td>
          <td class="paramname"> <em>allowApproximations</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&nbsp;</td>
          <td class="paramname"> <em>enableRestraints</em> = <code>false</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This should be called by any optimization class at the begining of an optimization. </p>
<p>This will also check that everything is ready, eg call the <a class="el" href="a00070.html#a48d11671e7f8699f7bc24077585c5e0f">RefinableObj::Prepare()</a> function. This also affects all sub-objects. </p>
<dl class="note"><dt><b>Note:</b></dt><dd>this may be called several time for some objects which are used by several other objects, or for nested optimizations (e.g. least-squares optimizations inside a global one).</dd>
<dd>
<a class="el" href="a00088.html#a782e0caf5c6f2941ca64d17293b1e8b4" title="This should be called by any optimization class at the end of an optimization.">EndOptimization()</a> must be called at the end of the optimization, the same number of time <a class="el" href="a00088.html#a6b0f18996edafa21a03bf9550dcf8981" title="This should be called by any optimization class at the begining of an optimization...">BeginOptimization()</a> was called !</dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>allowApproximations,:</em>&nbsp;</td><td>if true, then the object can use faster but less precise functions during the optimization. This is useful for global optimization not using derivatives. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>enableRestraints,:</em>&nbsp;</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="deprecated"><dt><b><a class="el" href="a00222.html#_deprecated000028">Deprecated:</a></b></dt><dd>if true, then restrained parameters will be allowed to go beyond theur hard limits. This implies that the algorithm will take into account the cost (penalty) related to the restraints. Objects which do not use restraints will simply ignore this. WARNING: this parameter may be removed with the new likelihood scheme. </dd></dl>

<p>Reimplemented from <a class="el" href="a00070.html#ababd8f2916e41a20d2c1b21f6ffefe96">ObjCryst::RefinableObj</a>.</p>

<p>Reimplemented in <a class="el" href="a00065.html#a44d10a7c3404153fe4513c8944629c45">ObjCryst::PowderPatternDiffraction</a>.</p>

</div>
</div>
<a class="anchor" id="abbb21a3870c4ad22501a5ed95fa8f1f9"></a><!-- doxytag: member="ObjCryst::ScatteringData::CalcGeomStructFactor" ref="abbb21a3870c4ad22501a5ed95fa8f1f9" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ObjCryst::ScatteringData::CalcGeomStructFactor </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Compute the 'Geometrical Structure Factor' for each <a class="el" href="a00089.html" title="Abstract Base Class to describe the scattering power of any Scatterer component in...">ScatteringPower</a> of the <a class="el" href="a00020.html" title="Crystal class: Unit cell, spacegroup, scatterers.">Crystal</a>. </p>

</div>
</div>
<a class="anchor" id="a4189bd87d77c86063609bb8f2c56a62f"></a><!-- doxytag: member="ObjCryst::ScatteringData::CalcResonantScattFactor" ref="a4189bd87d77c86063609bb8f2c56a62f" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual void ObjCryst::ScatteringData::CalcResonantScattFactor </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><b>For internal use only.</b></p>
<p>
get f' and f" for <a class="el" href="a00089.html" title="Abstract Base Class to describe the scattering power of any Scatterer component in...">ScatteringPower</a> of the crystal, at the exp. wavelengthThis <em>could</em> be specialized for multi-wavelength experiments... </p>

</div>
</div>
<a class="anchor" id="aa15aa0bf6efdecc4843bb2924a197be8"></a><!-- doxytag: member="ObjCryst::ScatteringData::CalcScattFactor" ref="aa15aa0bf6efdecc4843bb2924a197be8" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ObjCryst::ScatteringData::CalcScattFactor </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><b>For internal use only.</b></p>
<p>
Get scattering factors for all <a class="el" href="a00089.html" title="Abstract Base Class to describe the scattering power of any Scatterer component in...">ScatteringPower</a> &amp; reflections </p>

</div>
</div>
<a class="anchor" id="a36f66ab4f80103384551fa5c649eac8c"></a><!-- doxytag: member="ObjCryst::ScatteringData::CalcSinThetaLambda" ref="a36f66ab4f80103384551fa5c649eac8c" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual void ObjCryst::ScatteringData::CalcSinThetaLambda </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><b>For internal use only.</b></p>
<p>
Compute sin(theta)/lambda as well a orthonormal coordinates for all reflections. theta and tan(theta), are also re-computed, provided a wavelength has been supplied. </p>

</div>
</div>
<a class="anchor" id="aceb9551affff0a8c53c6d0e80d0536a2"></a><!-- doxytag: member="ObjCryst::ScatteringData::CalcStructFactor" ref="aceb9551affff0a8c53c6d0e80d0536a2" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ObjCryst::ScatteringData::CalcStructFactor </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Compute the overall structure factor (real <b>and</b> imaginary part). </p>
<p>This function is <em>optimized</em> <em>for</em> <em>speed</em> (geometrical structure factors are computed for all atoms and all reflections in two loops, avoiding re-calculation). So use this function for repetitive calculations.</p>
<p>This function recognizes the type of radiation (XRay or neutron) and uses the corresponding scattering factor/length.</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>the result (real and imaginary part of the structure factor) (mRealFhklCalc, mImagFhklCalc) are stored in <a class="el" href="a00088.html" title="Class to compute structure factors for a set of reflections and a Crystal.">ScatteringData</a>. </dd></dl>

</div>
</div>
<a class="anchor" id="a86079e8b7f2f5a9f8bccfdd0a6ecc25a"></a><!-- doxytag: member="ObjCryst::ScatteringData::CalcStructFactVariance" ref="a86079e8b7f2f5a9f8bccfdd0a6ecc25a" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ObjCryst::ScatteringData::CalcStructFactVariance </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculate the variance associated to the calculated structure factor. </p>

</div>
</div>
<a class="anchor" id="ab9073f536aa7312de2ceb97e1b1ddcbd"></a><!-- doxytag: member="ObjCryst::ScatteringData::CalcTemperatureFactor" ref="ab9073f536aa7312de2ceb97e1b1ddcbd" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ObjCryst::ScatteringData::CalcTemperatureFactor </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><b>For internal use only.</b></p>
<p>
Compute thermic factors for all <a class="el" href="a00089.html" title="Abstract Base Class to describe the scattering power of any Scatterer component in...">ScatteringPower</a> &amp; reflections </p>

</div>
</div>
<a class="anchor" id="ac8cc7361579cd633ae295823a235813c"></a><!-- doxytag: member="ObjCryst::ScatteringData::EliminateExtinctReflections" ref="ac8cc7361579cd633ae295823a235813c" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CrystVector_long ObjCryst::ScatteringData::EliminateExtinctReflections </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><b>For internal use only.</b></p>
<p>
Get rid of extinct reflections. Useful after <a class="el" href="a00088.html#a5fee409771ee116fae73d7cc530aee6a" title="Generate a list of h,k,l to describe a full reciprocal space, up to a given maximum...">GenHKLFullSpace()</a>. Do not use this if you have a list of observed reflections !Currently done using (brute-force) numerical evaluation. Should rather use <a class="el" href="a00094.html" title="The crystallographic space group, and the cell choice.">SpaceGroup</a> info... To do !<dl class="return"><dt><b>Returns:</b></dt><dd>an array with the subscript of the kept reflections (for inherited classes) </dd></dl>
</p>

</div>
</div>
<a class="anchor" id="a782e0caf5c6f2941ca64d17293b1e8b4"></a><!-- doxytag: member="ObjCryst::ScatteringData::EndOptimization" ref="a782e0caf5c6f2941ca64d17293b1e8b4" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual void ObjCryst::ScatteringData::EndOptimization </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This should be called by any optimization class at the end of an optimization. </p>
<p>This also affects all sub-objects. </p>
<dl class="note"><dt><b>Note:</b></dt><dd>this may be called several time for some objects which are used by several other objects. </dd></dl>

<p>Reimplemented from <a class="el" href="a00070.html#ab0035f6164cb24ace67b51b11993a851">ObjCryst::RefinableObj</a>.</p>

<p>Reimplemented in <a class="el" href="a00065.html#a11f7690878a07983de3abb839b087798">ObjCryst::PowderPatternDiffraction</a>.</p>

</div>
</div>
<a class="anchor" id="a5fee409771ee116fae73d7cc530aee6a"></a><!-- doxytag: member="ObjCryst::ScatteringData::GenHKLFullSpace" ref="a5fee409771ee116fae73d7cc530aee6a" args="(const REAL maxTheta, const bool unique=false)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual void ObjCryst::ScatteringData::GenHKLFullSpace </td>
          <td>(</td>
          <td class="paramtype">const REAL&nbsp;</td>
          <td class="paramname"> <em>maxTheta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&nbsp;</td>
          <td class="paramname"> <em>unique</em> = <code>false</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Generate a list of h,k,l to describe a full reciprocal space, up to a given maximum theta value. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>maxsithsl:maximum</em>&nbsp;</td><td>sin(theta)/lambda=1/2d value </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>unique,:</em>&nbsp;</td><td>if set to true, only unique reflections will be listed. Bijvoet (Friedel) pairs are NOT merged, for 'anomalous' reasons, unless you have chosen to ignore the imaginary part of the scattering factor.</td></tr>
  </table>
  </dd>
</dl>
<p>The multiplicity is always stored in <a class="el" href="a00088.html#affaae453ef7ac110ab7a1f0abb2c50a7" title="Multiplicity for each reflections (mostly for powder diffraction).">ScatteringData::mMultiplicity</a>.</p>
<dl class="warning"><dt><b>Warning:</b></dt><dd>The <a class="el" href="a00088.html" title="Class to compute structure factors for a set of reflections and a Crystal.">ScatteringData</a> object must already have been assigned a crystal object using <a class="el" href="a00088.html#a75ea37efc16db856fff9b8832b524284" title="Set the crystal for this experiment.">SetCrystal()</a>, and the experimental wavelength must also have been set before calling this function.</dd></dl>
<dl class="deprecated"><dt><b><a class="el" href="a00222.html#_deprecated000026">Deprecated:</a></b></dt><dd>Rather use PowderPattern::GenHKLFullSpace2, with a maximum sin(theta)/lambda value, which also works for dispersive experiments. </dd></dl>

</div>
</div>
<a class="anchor" id="acfb56224331e834478baf240813f7432"></a><!-- doxytag: member="ObjCryst::ScatteringData::GenHKLFullSpace2" ref="acfb56224331e834478baf240813f7432" args="(const REAL maxsithsl, const bool unique=false)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual void ObjCryst::ScatteringData::GenHKLFullSpace2 </td>
          <td>(</td>
          <td class="paramtype">const REAL&nbsp;</td>
          <td class="paramname"> <em>maxsithsl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&nbsp;</td>
          <td class="paramname"> <em>unique</em> = <code>false</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Generate a list of h,k,l to describe a full reciprocal space, up to a given maximum theta value. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>maxTheta:maximum</em>&nbsp;</td><td>theta value </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>unique,:</em>&nbsp;</td><td>if set to true, only unique reflections will be listed. Bijvoet (Friedel) pairs are NOT merged, for 'anomalous' reasons, unless you have chosen to ignore the imaginary part of the scattering factor.</td></tr>
  </table>
  </dd>
</dl>
<p>The multiplicity is always stored in <a class="el" href="a00088.html#affaae453ef7ac110ab7a1f0abb2c50a7" title="Multiplicity for each reflections (mostly for powder diffraction).">ScatteringData::mMultiplicity</a>.</p>
<dl class="warning"><dt><b>Warning:</b></dt><dd>The <a class="el" href="a00088.html" title="Class to compute structure factors for a set of reflections and a Crystal.">ScatteringData</a> object must already have been assigned a crystal object using <a class="el" href="a00088.html#a75ea37efc16db856fff9b8832b524284" title="Set the crystal for this experiment.">SetCrystal()</a>, and the experimental wavelength must also have been set before calling this function. </dd></dl>

</div>
</div>
<a class="anchor" id="ad79b3ec44d9dcf512c2015f55c72bf67"></a><!-- doxytag: member="ObjCryst::ScatteringData::GetH2Pi" ref="ad79b3ec44d9dcf512c2015f55c72bf67" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const CrystVector_REAL&amp; ObjCryst::ScatteringData::GetH2Pi </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Return the 1D array of H coordinates for all reflections, multiplied by 2*pi. </p>
<p><b>For internal use only.</b></p>
<p>
Should be private </p>

</div>
</div>
<a class="anchor" id="a092d2c4539f4d318cd5dbfa423d0c2fb"></a><!-- doxytag: member="ObjCryst::ScatteringData::GetK2Pi" ref="a092d2c4539f4d318cd5dbfa423d0c2fb" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const CrystVector_REAL&amp; ObjCryst::ScatteringData::GetK2Pi </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Return the 1D array of K coordinates for all reflections, multiplied by 2*pi. </p>
<p><b>For internal use only.</b></p>
<p>
Should be private </p>

</div>
</div>
<a class="anchor" id="a27efeb3532f93c273e6d53af74fd8804"></a><!-- doxytag: member="ObjCryst::ScatteringData::GetL2Pi" ref="a27efeb3532f93c273e6d53af74fd8804" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const CrystVector_REAL&amp; ObjCryst::ScatteringData::GetL2Pi </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Return the 1D array of L coordinates for all reflections, multiplied by 2*pi. </p>
<p><b>For internal use only.</b></p>
<p>
Should be private </p>

</div>
</div>
<a class="anchor" id="aac8034f8b0f6980c619e595ce6ba1d65"></a><!-- doxytag: member="ObjCryst::ScatteringData::GetNbReflBelowMaxSinThetaOvLambda" ref="aac8034f8b0f6980c619e595ce6ba1d65" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual long ObjCryst::ScatteringData::GetNbReflBelowMaxSinThetaOvLambda </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Recalc, and get the number of reflections which should be actually used, due to the maximuml sin(theta)/lambda value set. </p>

<p>Reimplemented in <a class="el" href="a00065.html#a2793f8d2df13e5a1e9a5efc527771b3a">ObjCryst::PowderPatternDiffraction</a>.</p>

</div>
</div>
<a class="anchor" id="a24cdbd2eb620d7d972ce4b6ccf23a0b0"></a><!-- doxytag: member="ObjCryst::ScatteringData::IsIgnoringImagScattFact" ref="a24cdbd2eb620d7d972ce4b6ccf23a0b0" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool ObjCryst::ScatteringData::IsIgnoringImagScattFact </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>If true, then the imaginary part of the scattering factor is ignored during Structure factor computation. </p>

</div>
</div>
<a class="anchor" id="a0c01e0c2ffbe9bfbb92d7b5751e420e2"></a><!-- doxytag: member="ObjCryst::ScatteringData::PrepareHKLarrays" ref="a0c01e0c2ffbe9bfbb92d7b5751e420e2" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual void ObjCryst::ScatteringData::PrepareHKLarrays </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><b>For internal use only.</b></p>
<p>
This function is called after H,K and L arrays have been initialized or modified. </p>

</div>
</div>
<a class="anchor" id="ace1458ac95c287fffa89049f58ac0a41"></a><!-- doxytag: member="ObjCryst::ScatteringData::PrintFhklCalc" ref="ace1458ac95c287fffa89049f58ac0a41" args="(ostream &amp;os=cout) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual void ObjCryst::ScatteringData::PrintFhklCalc </td>
          <td>(</td>
          <td class="paramtype">ostream &amp;&nbsp;</td>
          <td class="paramname"> <em>os</em> = <code>cout</code></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Print H, K, L F^2 Re(F) Im(F) theta sin(theta)/lambda for all reflections. </p>

</div>
</div>
<a class="anchor" id="a109ed8c2e8dc676e77aa80feafa91071"></a><!-- doxytag: member="ObjCryst::ScatteringData::SetApproximationFlag" ref="a109ed8c2e8dc676e77aa80feafa91071" args="(const bool allow)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual void ObjCryst::ScatteringData::SetApproximationFlag </td>
          <td>(</td>
          <td class="paramtype">const bool&nbsp;</td>
          <td class="paramname"> <em>allow</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Enable or disable numerical approximations. </p>
<p>This can be used for global optimization to get faster calculations. Depending on the type of object, this may do something or not (it does not do anything in a base <a class="el" href="a00070.html" title="Generic Refinable Object.">RefinableObj</a>, except calling this function for all sub-objects).</p>
<dl class="note"><dt><b>Note:</b></dt><dd>Currently there is no mApproximationFlag in the base class, but maybe there should...</dd></dl>
<p>Also see: </p>

<p>Reimplemented from <a class="el" href="a00070.html#a565c41c23c04f5945512374ae671e2e3">ObjCryst::RefinableObj</a>.</p>

<p>Reimplemented in <a class="el" href="a00065.html#a0e7b4a6f4b3a7b783ebed15230a1c45f">ObjCryst::PowderPatternDiffraction</a>.</p>

</div>
</div>
<a class="anchor" id="a75ea37efc16db856fff9b8832b524284"></a><!-- doxytag: member="ObjCryst::ScatteringData::SetCrystal" ref="a75ea37efc16db856fff9b8832b524284" args="(Crystal &amp;crystal)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual void ObjCryst::ScatteringData::SetCrystal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00020.html">Crystal</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>crystal</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Set the crystal for this experiment. </p>

<p>Reimplemented in <a class="el" href="a00065.html#a855f114ce585410a354b56a6ea336eaf">ObjCryst::PowderPatternDiffraction</a>.</p>

</div>
</div>
<a class="anchor" id="aada0135fdf333760b7b2627b6f36206c"></a><!-- doxytag: member="ObjCryst::ScatteringData::SetHKL" ref="aada0135fdf333760b7b2627b6f36206c" args="(const CrystVector_REAL &amp;h, const CrystVector_REAL &amp;k, const CrystVector_REAL &amp;l)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual void ObjCryst::ScatteringData::SetHKL </td>
          <td>(</td>
          <td class="paramtype">const CrystVector_REAL &amp;&nbsp;</td>
          <td class="paramname"> <em>h</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const CrystVector_REAL &amp;&nbsp;</td>
          <td class="paramname"> <em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const CrystVector_REAL &amp;&nbsp;</td>
          <td class="paramname"> <em>l</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>input H,K,L </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>h,k,l,:</em>&nbsp;</td><td>REAL arrays (vectors with NbRefl elements -same size), with the h, k and l coordinates of all reflections. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ae126b860d309daa78e975b8b6d8a3ec0"></a><!-- doxytag: member="ObjCryst::ScatteringData::SetIsIgnoringImagScattFact" ref="ae126b860d309daa78e975b8b6d8a3ec0" args="(const bool b)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ObjCryst::ScatteringData::SetIsIgnoringImagScattFact </td>
          <td>(</td>
          <td class="paramtype">const bool&nbsp;</td>
          <td class="paramname"> <em>b</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>If true, then the imaginary part of the scattering factor is ignored during Structure factor computation. </p>
<p>(default value=false)</p>
<dl class="todo"><dt><b><a class="el" href="a00221.html#_todo000012">Todo:</a></b></dt><dd>this should become useless once we take fully advantage of coupled computation of Structure Factors for Fridel/Bijvoet mates using an internal list of 'fully unique' reflections. Then only one of the mates need to be computed.. </dd></dl>

</div>
</div>
<a class="anchor" id="a54629fa52fe111d2867797ae1204ddf8"></a><!-- doxytag: member="ObjCryst::ScatteringData::SetMaxSinThetaOvLambda" ref="a54629fa52fe111d2867797ae1204ddf8" args="(const REAL max)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual void ObjCryst::ScatteringData::SetMaxSinThetaOvLambda </td>
          <td>(</td>
          <td class="paramtype">const REAL&nbsp;</td>
          <td class="paramname"> <em>max</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Set the maximum value for sin(theta)/lambda. </p>
<p>All data (reflections,..) still exist but are ignored for all calculations. </p>

<p>Reimplemented in <a class="el" href="a00065.html#a699af7ea523fca128032384b548ceef1">ObjCryst::PowderPatternDiffraction</a>.</p>

</div>
</div>
<a class="anchor" id="a4b843c3350e25d4d0c52da3400768fb7"></a><!-- doxytag: member="ObjCryst::ScatteringData::SortReflectionBySinThetaOverLambda" ref="a4b843c3350e25d4d0c52da3400768fb7" args="(const REAL maxSTOL=&#45;1.)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual CrystVector_long ObjCryst::ScatteringData::SortReflectionBySinThetaOverLambda </td>
          <td>(</td>
          <td class="paramtype">const REAL&nbsp;</td>
          <td class="paramname"> <em>maxSTOL</em> = <code>-1.</code></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><b>For internal use only.</b></p>
<p>
sort reflections by theta values (also get rid of [0,0,0] if present) If maxSTOL &gt;0, then only reflections where sin(theta)/lambda&lt;maxSTOL are kept </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>an array with the subscript of the kept reflections (for inherited classes) </dd></dl>
</p>

<p>Reimplemented in <a class="el" href="a00026.html#aeac660426ee4c5aa52d494b449a164f9">ObjCryst::DiffractionDataSingleCrystal</a>.</p>

</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="a8296cf05015c7c4bbfc1dc7b443e3096"></a><!-- doxytag: member="ObjCryst::ScatteringData::mExpectedIntensityFactor" ref="a8296cf05015c7c4bbfc1dc7b443e3096" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CrystVector_int <a class="el" href="a00088.html#a8296cf05015c7c4bbfc1dc7b443e3096">ObjCryst::ScatteringData::mExpectedIntensityFactor</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Expected intensity factor for all reflections. </p>
<p>See <a class="el" href="a00094.html#add3a6c0f649b952225fd7ef07b9e02d7" title="Get the &quot;expected intensity factor&quot; for a given reflection.">SpaceGroup::GetExpectedIntensityFactor()</a> </p>

</div>
</div>
<a class="anchor" id="a85ab0dd2973824fc2ad62fb6fef2e274"></a><!-- doxytag: member="ObjCryst::ScatteringData::mFhklCalcVariance" ref="a85ab0dd2973824fc2ad62fb6fef2e274" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CrystVector_REAL <a class="el" href="a00088.html#a85ab0dd2973824fc2ad62fb6fef2e274">ObjCryst::ScatteringData::mFhklCalcVariance</a><code> [mutable, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The variance on all calculated structure factors, taking into account the positionnal errors and the expected intensity factor. </p>
<p>Actually this is the variance on both real and imaginary parts. </p>

</div>
</div>
<a class="anchor" id="a3a9764c52916a533a44baaea89bdceab"></a><!-- doxytag: member="ObjCryst::ScatteringData::mIgnoreImagScattFact" ref="a3a9764c52916a533a44baaea89bdceab" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="a00088.html#a3a9764c52916a533a44baaea89bdceab">ObjCryst::ScatteringData::mIgnoreImagScattFact</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Ignore imaginary part of scattering factor. </p>
<p>This can be used either to speed up computation, or when f" has a small effect on calculated intensities, mostly for powder diffraction (GenHKLFullSpace will not generate Friedel pairs, reducing the number of reflections by a factor up to 2 for some structures).</p>
<p>Practically this makes f"=0 during computation. The real resonant contribution (f') is not affected.</p>
<p>This may be removed later on... </p>

</div>
</div>
<a class="anchor" id="acb0398e21f803308b79103182906f6c5"></a><!-- doxytag: member="ObjCryst::ScatteringData::mMaxSinThetaOvLambda" ref="acb0398e21f803308b79103182906f6c5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">REAL <a class="el" href="a00088.html#acb0398e21f803308b79103182906f6c5">ObjCryst::ScatteringData::mMaxSinThetaOvLambda</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Maximum sin(theta)/lambda for all calculations (10 by default). </p>
<p>This keeps all data in memory, but only the part which is below the max is calculated.</p>
<p>This affects the computing of structure factors, intensities (for single crystal and powder patterns), R and Rw.</p>
<p>The reflections <b>must</b> be sorted by increasing sin(theta)/lambda for this to work correctly. </p>

</div>
</div>
<a class="anchor" id="a00e0972eebd70ae92231b804884a83b6"></a><!-- doxytag: member="ObjCryst::ScatteringData::mNbReflUsed" ref="a00e0972eebd70ae92231b804884a83b6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">long <a class="el" href="a00088.html#a00e0972eebd70ae92231b804884a83b6">ObjCryst::ScatteringData::mNbReflUsed</a><code> [mutable, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Number of reflections which are below the max. </p>
<p>This is updated automatically from <a class="el" href="a00088.html#acb0398e21f803308b79103182906f6c5" title="Maximum sin(theta)/lambda for all calculations (10 by default).">ScatteringData::mMaxSinThetaOvLambda</a> </p>

</div>
</div>
<a class="anchor" id="a8c4e778a97e93098d585ffdc597dbb54"></a><!-- doxytag: member="ObjCryst::ScatteringData::mpCrystal" ref="a8c4e778a97e93098d585ffdc597dbb54" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="a00020.html">Crystal</a>* <a class="el" href="a00088.html#a8c4e778a97e93098d585ffdc597dbb54">ObjCryst::ScatteringData::mpCrystal</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Pointer to the crystal corresponding to this experiment. </p>
<p>This gives an access to the UB matrix for the crystal, as well as to the list of <a class="el" href="a00084.html" title="Generic type of scatterer: can be an atom, or a more complex assembly of atoms.">Scatterer</a>. </p>

</div>
</div>
<a class="anchor" id="a7a3fa9e9ea5c3a1dc6076f69ad584ad7"></a><!-- doxytag: member="ObjCryst::ScatteringData::mUseFastLessPreciseFunc" ref="a7a3fa9e9ea5c3a1dc6076f69ad584ad7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="a00088.html#a7a3fa9e9ea5c3a1dc6076f69ad584ad7">ObjCryst::ScatteringData::mUseFastLessPreciseFunc</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Use faster, but less precise, approximations for functions? (integer approximations to compute sin and cos in structure factors, and also to compute interatomic distances). </p>
<p>This is activated by global optimization algortithms, only during the optimization. </p>

</div>
</div>
<a class="anchor" id="a13e1ec375416a17f94370a4cf4bd5583"></a><!-- doxytag: member="ObjCryst::ScatteringData::mvFprime" ref="a13e1ec375416a17f94370a4cf4bd5583" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">map&lt;const <a class="el" href="a00089.html">ScatteringPower</a>*,REAL&gt; <a class="el" href="a00088.html#a13e1ec375416a17f94370a4cf4bd5583">ObjCryst::ScatteringData::mvFprime</a><code> [mutable, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Anomalous X-Ray scattering term f' and f" are stored here for each <a class="el" href="a00089.html" title="Abstract Base Class to describe the scattering power of any Scatterer component in...">ScatteringPower</a> We store here only a value. </p>
<p>For multi-wavelength support this should be changed to a vector... or to a matrix to take into account anisotropy of anomalous scattering... </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>ScatteringData.h</li>
</ul>
</div>
<hr class="footer"/><address style="text-align: right;"><small>Generated by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.2-20100208 </small></address>
</body>
</html>
