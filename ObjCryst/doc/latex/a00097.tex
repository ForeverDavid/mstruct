\subsection{ObjCryst::StretchModeBondAngle Struct Reference}
\label{a00097}\index{ObjCryst::StretchModeBondAngle@{ObjCryst::StretchModeBondAngle}}


Atoms moved when changing a bond angle.  
Inheritance diagram for ObjCryst::StretchModeBondAngle::\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=2cm]{a00097}
\end{center}
\end{figure}
\subsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
{\bf StretchModeBondAngle} ({\bf MolAtom} \&at0, {\bf MolAtom} \&at1, {\bf MolAtom} \&at2, const {\bf MolBondAngle} $\ast$pBondAngle)\label{a00097_aa1fbf3238722b663b083c999cf1b5c57}

\begin{DoxyCompactList}\small\item\em Constructor If pBondAngle!=0, the bond angle length restraint is respected. \item\end{DoxyCompactList}\item 
virtual void {\bf CalcDeriv} (const bool derivllk=true) const 
\begin{DoxyCompactList}\small\item\em Calculate the derivative of the Molecule's Log(likelihood) and atomic positions versus a change of the bond length. \item\end{DoxyCompactList}\item 
virtual void {\bf Print} (ostream \&os, bool full=true) const \label{a00097_a77e72910a64e3351a05a2f7ac47033c0}

\begin{DoxyCompactList}\small\item\em Print one-\/line list of atoms moved. \item\end{DoxyCompactList}\item 
virtual void {\bf Stretch} (const REAL change)\label{a00097_aff6934e2b0a048d164228348f87f544d}

\begin{DoxyCompactList}\small\item\em Move the atoms according to this mode. \item\end{DoxyCompactList}\item 
virtual void {\bf RandomStretch} (const REAL amplitude)\label{a00097_a7e3006f5ecd0d683ec669475c5f21394}

\begin{DoxyCompactList}\small\item\em Move the atoms according to this mode, randomly. \item\end{DoxyCompactList}\end{DoxyCompactItemize}
\subsubsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
{\bf MolAtom} $\ast$ {\bf mpAtom0}\label{a00097_a63bc5bb54f0d298fb47b7bf86e8c2ff5}

\begin{DoxyCompactList}\small\item\em The first atom. \item\end{DoxyCompactList}\item 
{\bf MolAtom} $\ast$ {\bf mpAtom1}\label{a00097_aa5b52fcece40cd41c93eeb8b1dfec939}

\begin{DoxyCompactList}\small\item\em The second atom. \item\end{DoxyCompactList}\item 
{\bf MolAtom} $\ast$ {\bf mpAtom2}\label{a00097_a08c6b4fde05610d0242bfd7b4a6acc3f}

\begin{DoxyCompactList}\small\item\em The third atom. \item\end{DoxyCompactList}\item 
const {\bf MolBondAngle} $\ast$ {\bf mpBondAngle}\label{a00097_ab173d155feb360d0b95b5cd35f346da5}

\begin{DoxyCompactList}\small\item\em The (optional) bond angle restraint which this stretch mode should respect. \item\end{DoxyCompactList}\item 
set$<$ {\bf MolAtom} $\ast$ $>$ {\bf mvRotatedAtomList}
\begin{DoxyCompactList}\small\item\em The set of atoms that are to be rotated around the direction going through at1 and perpendicular to the at0-\/at1-\/at2 plane. \item\end{DoxyCompactList}\end{DoxyCompactItemize}


\subsubsection{Detailed Description}
Atoms moved when changing a bond angle. This should be merged (or have an inheritance relation) with \doxyref{MolBondAngle}{p.}{a00044}. 

\subsubsection{Member Function Documentation}
\index{ObjCryst::StretchModeBondAngle@{ObjCryst::StretchModeBondAngle}!CalcDeriv@{CalcDeriv}}
\index{CalcDeriv@{CalcDeriv}!ObjCryst::StretchModeBondAngle@{ObjCryst::StretchModeBondAngle}}
\paragraph[{CalcDeriv}]{\setlength{\rightskip}{0pt plus 5cm}virtual void ObjCryst::StretchModeBondAngle::CalcDeriv (const bool {\em derivllk} = {\ttfamily true}) const\hspace{0.3cm}{\ttfamily  [virtual]}}\hfill\label{a00097_acdc082c4cb5b4f38fed6049bf7b1eb9c}


Calculate the derivative of the Molecule's Log(likelihood) and atomic positions versus a change of the bond length. The result is stored in mLLKDeriv and mLLKDerivXYZ, as well as in the various lists of restraints broken by this mode.


\begin{DoxyParams}{Parameters}
\item[{\em derivllk,:}]if false, the derivative of the overall llk will not be computed, only the derivative of the atomic positions. \end{DoxyParams}


Implements {\bf ObjCryst::StretchMode} \doxyref{}{p.}{a00096_a5b5ab5f9819c047a49719a330722d419}.

\subsubsection{Member Data Documentation}
\index{ObjCryst::StretchModeBondAngle@{ObjCryst::StretchModeBondAngle}!mvRotatedAtomList@{mvRotatedAtomList}}
\index{mvRotatedAtomList@{mvRotatedAtomList}!ObjCryst::StretchModeBondAngle@{ObjCryst::StretchModeBondAngle}}
\paragraph[{mvRotatedAtomList}]{\setlength{\rightskip}{0pt plus 5cm}set$<${\bf MolAtom} $\ast$$>$ {\bf ObjCryst::StretchModeBondAngle::mvRotatedAtomList}}\hfill\label{a00097_a1d70964f33ea3a594efd2c3a595816a6}


The set of atoms that are to be rotated around the direction going through at1 and perpendicular to the at0-\/at1-\/at2 plane. 

The documentation for this struct was generated from the following file:\begin{DoxyCompactItemize}
\item 
Molecule.h\end{DoxyCompactItemize}
