\subsection{Obj\-Cryst\-:\-:L\-S\-Q\-Num\-Obj Class Reference}
\label{a00046}\index{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj@{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj}}


(Quick \& dirty) Least-\/\-Squares Refinement Object with Numerical derivatives  


\subsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
{\bfseries L\-S\-Q\-Num\-Obj} (std\-::string obj\-Name=\char`\"{}Unnamed L\-S\-Q object\char`\"{})\label{a00046_a2ccb9fe18f1324eef38c6d24740bdf9b}

\item 
const string \& {\bf Get\-Class\-Name} () const \label{a00046_acbad850460a8c8634e64159497805639}

\begin{DoxyCompactList}\small\item\em Name for this class (\char`\"{}\-Refinable\-Obj\char`\"{}, \char`\"{}\-Crystal\char`\"{},...) \end{DoxyCompactList}\item 
const string \& {\bf Get\-Name} () const \label{a00046_a19a33796efc622243e2ca614903f9da1}

\begin{DoxyCompactList}\small\item\em Name of the object. \end{DoxyCompactList}\item 
void {\bf Set\-Par\-Is\-Fixed} (const std\-::string \&par\-Name, const bool fix)
\begin{DoxyCompactList}\small\item\em Fix one parameter. \end{DoxyCompactList}\item 
void {\bf Set\-Par\-Is\-Fixed} (const {\bf Ref\-Par\-Type} $\ast$type, const bool fix)
\begin{DoxyCompactList}\small\item\em Fix one family of parameters. \end{DoxyCompactList}\item 
void {\bf Set\-Par\-Is\-Fixed} ({\bf Refinable\-Par} \&par, const bool fix)
\begin{DoxyCompactList}\small\item\em Fix one parameter. \end{DoxyCompactList}\item 
void {\bf Set\-Par\-Is\-Fixed} ({\bf Refinable\-Obj} \&obj, const bool fix)
\begin{DoxyCompactList}\small\item\em Fix all parameters within an object. \end{DoxyCompactList}\item 
void {\bf Un\-Fix\-All\-Par} ()
\begin{DoxyCompactList}\small\item\em Un\-Fix All parameters. \end{DoxyCompactList}\item 
void {\bf Set\-Par\-Is\-Used} (const std\-::string \&par\-Name, const bool use)
\begin{DoxyCompactList}\small\item\em Set a parameter to be used. \end{DoxyCompactList}\item 
void {\bf Set\-Par\-Is\-Used} (const {\bf Ref\-Par\-Type} $\ast$type, const bool use)
\begin{DoxyCompactList}\small\item\em Set a family of parameters to be used. \end{DoxyCompactList}\item 
void {\bf Refine} (int nb\-Cycle=1, bool use\-Levenberg\-Marquardt=false, const bool silent=false, const bool call\-Begin\-End\-Optimization=true, const float min\-Chi2var=0.\-01)
\begin{DoxyCompactList}\small\item\em Do the refinement. \end{DoxyCompactList}\item 
void {\bf Stop\-After\-Cycle} ()\label{a00046_a4d3d47163ee85c7026901b4a82d512de}

\begin{DoxyCompactList}\small\item\em Stop after the current cycle. Used for refinement interruption. \end{DoxyCompactList}\item 
Cryst\-Vector\-\_\-\-R\-E\-A\-L {\bfseries Sigma} () const \label{a00046_abd95a807a80ea2eaf9e1a724cfdd413e}

\item 
Cryst\-Matrix\-\_\-\-R\-E\-A\-L {\bfseries Correl\-Matrix} () const \label{a00046_a3a1da618157efff1ea1aef46e8f1b524}

\item 
R\-E\-A\-L {\bfseries Rfactor} () const \label{a00046_ae1ad8ab2dd7502a18b8761684983e7ac}

\item 
R\-E\-A\-L {\bfseries Rw\-Factor} () const \label{a00046_ae748ee51f6c3730bc62e7b164fa871c6}

\item 
R\-E\-A\-L {\bfseries Chi\-Square} () const \label{a00046_a89bc494e4fb96b1873e77aec8505f6e3}

\item 
void {\bf Set\-Refined\-Obj} ({\bf Refinable\-Obj} \&obj, const unsigned int L\-S\-Q\-Func\-Index=0, const bool init=true, const bool recursive=false)
\begin{DoxyCompactList}\small\item\em Choose the object to refine. \end{DoxyCompactList}\item 
const std\-::vector$<$ std\-::pair\\*
$<$ {\bf Refinable\-Obj} $\ast$, unsigned int $>$ $>$ \& {\bf Get\-Refined\-Obj\-Map} () const 
\begin{DoxyCompactList}\small\item\em Get the map of refined objects -\/ this is a recursive list of all the objects that are taken into account for the refinement. \end{DoxyCompactList}\item 
std\-::vector$<$ std\-::pair\\*
$<$ {\bf Refinable\-Obj} $\ast$, unsigned int $>$ $>$ \& {\bf Get\-Refined\-Obj\-Map} ()
\begin{DoxyCompactList}\small\item\em Get the map of refined objects -\/ this is a recursive list of all the objects that are taken into account for the refinement. \end{DoxyCompactList}\item 
{\bf Refinable\-Obj} \& {\bf Get\-Compiled\-Refined\-Obj} ()
\begin{DoxyCompactList}\small\item\em Access to the \doxyref{Refinable\-Obj}{p.}{a00078} which is the compilation of all parameters from the object supplied for optimization and its sub-\/objects. \end{DoxyCompactList}\item 
const {\bf Refinable\-Obj} \& {\bf Get\-Compiled\-Refined\-Obj} () const 
\begin{DoxyCompactList}\small\item\em Access to the \doxyref{Refinable\-Obj}{p.}{a00078} which is the compilation of all parameters from the object supplied for optimization and its sub-\/objects. \end{DoxyCompactList}\item 
void {\bfseries Set\-Use\-Save\-File\-On\-Each\-Cycle} (bool yes\-Or\-No=true)\label{a00046_a5052fda0d9764bf06f985ec9443fa145}

\item 
void {\bfseries Set\-Save\-File} (std\-::string file\-Name=\char`\"{}refine.\-save\char`\"{})\label{a00046_a62fe3d8067ee765448a0042a9a34bf2f}

\item 
void {\bfseries Print\-Ref\-Results} () const \label{a00046_a6293e921d940022fe523e85d0c70eea8}

\item 
void {\bfseries Set\-Damping\-Factor} (const R\-E\-A\-L new\-Damp\-Fact)\label{a00046_a0eb066c4614a884d6da923c575d31132}

\item 
void {\bfseries Purge\-Save\-File} ()\label{a00046_ab91c3db60b9ce7de78a39191436878ae}

\item 
void {\bfseries Write\-Report\-To\-File} () const \label{a00046_aadeaa4e66c0772b7b39d7769f5c9ab35}

\item 
void {\bfseries Optimize\-Derivative\-Steps} ()\label{a00046_a29f4c2161390356d75ca1caec508a263}

\item 
const std\-::map$<$ pair$<$ const \\*
{\bf Refinable\-Par} $\ast$, const \\*
{\bf Refinable\-Par} $\ast$ $>$, R\-E\-A\-L $>$ \& {\bfseries Get\-Variance\-Covariance\-Map} () const \label{a00046_a4523a9a61433f2e362bc5a8f17f0de11}

\item 
void {\bf Prepare\-Ref\-Par\-List} (const bool copy\-\_\-param=false)
\begin{DoxyCompactList}\small\item\em Prepare the full parameter list for the refinement. \end{DoxyCompactList}\item 
const Cryst\-Vector\-\_\-\-R\-E\-A\-L \& {\bf Get\-L\-S\-Q\-Calc} () const \label{a00046_ab6c69bdc3cffebda96e7f8da2a10651b}

\begin{DoxyCompactList}\small\item\em Get the L\-S\-Q calc vector (using either only the top or the hierarchy of object) \end{DoxyCompactList}\item 
const Cryst\-Vector\-\_\-\-R\-E\-A\-L \& {\bf Get\-L\-S\-Q\-Obs} () const \label{a00046_a9ae138310620a13651dfbee5faf8b7d3}

\begin{DoxyCompactList}\small\item\em Get the L\-S\-Q obs vector (using either only the top or the hierarchy of object) \end{DoxyCompactList}\item 
const Cryst\-Vector\-\_\-\-R\-E\-A\-L \& {\bf Get\-L\-S\-Q\-Weight} () const \label{a00046_a448b1e7bcaea617b6c3b0f58540a1d5c}

\begin{DoxyCompactList}\small\item\em Get the L\-S\-Q weight vector (using either only the top or the hierarchy of object) \end{DoxyCompactList}\item 
const Cryst\-Vector\-\_\-\-R\-E\-A\-L \& {\bf Get\-L\-S\-Q\-Deriv} ({\bf Refinable\-Par} \&par)\label{a00046_add2acd529c8c8c4dc38f1d09f7b637ce}

\begin{DoxyCompactList}\small\item\em Get the L\-S\-Q deriv vector (using either only the top or the hierarchy of object) \end{DoxyCompactList}\item 
void {\bf Begin\-Optimization} (const bool allow\-Approximations=false, const bool enable\-Restraints=false)\label{a00046_a6230c952ec8fc2c0ed63ac1b4de232a5}

\begin{DoxyCompactList}\small\item\em Tell all refined object that the refinement is beginning. \end{DoxyCompactList}\item 
void {\bf End\-Optimization} ()\label{a00046_a4c6168e319fd4a8f949997d1b54012ba}

\begin{DoxyCompactList}\small\item\em Tell all refined object that the refinement is finished. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsubsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
{\bf Obj\-Registry}$<$ {\bf Refinable\-Obj} $>$ {\bf m\-Recursive\-Refined\-Obj\-List}\label{a00046_a23d277120b16313b7d65ba43474c8bb2}

\begin{DoxyCompactList}\small\item\em The recursive list of all refined sub-\/objects. \end{DoxyCompactList}\item 
{\bf Refinable\-Obj} {\bf m\-Ref\-Par\-List}
\begin{DoxyCompactList}\small\item\em The refinable par list used during refinement. \end{DoxyCompactList}\item 
R\-E\-A\-L {\bf m\-Damping\-Factor}\label{a00046_aba399e82e28a4cfe9e69aefc797f04cf}

\begin{DoxyCompactList}\small\item\em Damping factor for the refinement (unused yet...) \end{DoxyCompactList}\item 
bool {\bf m\-Save\-Report\-On\-Each\-Cycle}\label{a00046_a09babc65e743bac7f89f86fc08d59899}

\begin{DoxyCompactList}\small\item\em Save result to file after each cycle ? \end{DoxyCompactList}\item 
std\-::string {\bf m\-Name}\label{a00046_a72b3294b9fa16e5fc0d58bebaf6afb7c}

\begin{DoxyCompactList}\small\item\em Name of the refined object. \end{DoxyCompactList}\item 
std\-::string {\bf m\-Save\-File\-Name}\label{a00046_abe4fdfa21b103fa7c43dbc643c303bbf}

\begin{DoxyCompactList}\small\item\em File name where refinement info is saved. \end{DoxyCompactList}\item 
R\-E\-A\-L {\bfseries m\-R}\label{a00046_a81e6e3477ce61e5ba4aa9087c18423e7}

\item 
R\-E\-A\-L {\bfseries m\-Rw}\label{a00046_ab0ebd8803606b2666d402b7ced3d3bc4}

\item 
R\-E\-A\-L {\bfseries m\-Chi\-Sq}\label{a00046_ab1a1232379bae302dcb217d6e359e7dc}

\item 
R\-E\-A\-L {\bfseries m\-Rex}\label{a00046_a7781827b6f8cb60142c041952f99a6c5}

\item 
Cryst\-Matrix\-\_\-\-R\-E\-A\-L {\bf m\-Correl\-Matrix}\label{a00046_a85feb318b2d5804324b55e1e3aa65fbf}

\begin{DoxyCompactList}\small\item\em Correlation matrix between all refined parameters. \end{DoxyCompactList}\item 
std\-::map$<$ pair$<$ const \\*
{\bf Refinable\-Par} $\ast$, const \\*
{\bf Refinable\-Par} $\ast$ $>$, R\-E\-A\-L $>$ {\bf mv\-Var\-Covar}\label{a00046_a680f9ab902de1ccfd34061131a1399b5}

\begin{DoxyCompactList}\small\item\em Variance-\/\-Covariance matrix, as a std\-::map. \end{DoxyCompactList}\item 
Cryst\-Vector\-\_\-\-R\-E\-A\-L {\bf m\-Obs}\label{a00046_aaf6851846648464a65902618a5c37c09}

\begin{DoxyCompactList}\small\item\em Observed values. \end{DoxyCompactList}\item 
Cryst\-Vector\-\_\-\-R\-E\-A\-L {\bf m\-Weight}\label{a00046_af15db099da89847aed6a5106d2c68279}

\begin{DoxyCompactList}\small\item\em Weight corresponding to all observed values. \end{DoxyCompactList}\item 
int {\bf m\-Index\-Values\-Set\-Initial}
\begin{DoxyCompactList}\small\item\em Index of the set of saved values for all refinable parameters, before refinement and before the last cycle. \end{DoxyCompactList}\item 
int {\bfseries m\-Index\-Values\-Set\-Last}\label{a00046_a52651e7d92c699c8a282c2eef065055d}

\item 
bool {\bf m\-Stop\-After\-Cycle}\label{a00046_aa33d466b132ac98408619cbe230871ce}

\begin{DoxyCompactList}\small\item\em If true, then stop at the end of the cycle. Used in multi-\/threading environment. \end{DoxyCompactList}\item 
std\-::vector$<$ std\-::pair\\*
$<$ {\bf Refinable\-Obj} $\ast$, unsigned int $>$ $>$ {\bf mv\-Refined\-Obj\-Map}
\begin{DoxyCompactList}\small\item\em Map of the recursive list of the objects to be refined. \end{DoxyCompactList}\item 
bool {\bf m\-Copy\-Ref\-Par}
\begin{DoxyCompactList}\small\item\em If true, then parameters to be refined will be copied instead of referenced. \end{DoxyCompactList}\item 
Cryst\-Vector\-\_\-\-R\-E\-A\-L {\bf m\-L\-S\-Q\-Obs}\label{a00046_a0209969eff2d3db1175246f6321f8e0c}

\begin{DoxyCompactList}\small\item\em Temporary arrays for L\-S\-Q functions evaluation -\/ used when using recursive L\-S\-Q function. \end{DoxyCompactList}\item 
Cryst\-Vector\-\_\-\-R\-E\-A\-L {\bfseries m\-L\-S\-Q\-Calc}\label{a00046_a99ea1b948bb832d5f962c957d2002663}

\item 
Cryst\-Vector\-\_\-\-R\-E\-A\-L {\bfseries m\-L\-S\-Q\-Weight}\label{a00046_a7f40708d08b3f87ef35c0c652c8047cc}

\item 
Cryst\-Vector\-\_\-\-R\-E\-A\-L {\bfseries m\-L\-S\-Q\-Deriv}\label{a00046_a36367b2655942c2dd718e5bab2f1174f}

\end{DoxyCompactItemize}


\subsubsection{Detailed Description}
(Quick \& dirty) Least-\/\-Squares Refinement Object with Numerical derivatives 

This is still highly experimental ! 

\subsubsection{Member Function Documentation}
\index{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj@{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj}!Get\-Compiled\-Refined\-Obj@{Get\-Compiled\-Refined\-Obj}}
\index{Get\-Compiled\-Refined\-Obj@{Get\-Compiled\-Refined\-Obj}!ObjCryst::LSQNumObj@{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj}}
\paragraph[{Get\-Compiled\-Refined\-Obj}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Refinable\-Obj}\& Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj\-::\-Get\-Compiled\-Refined\-Obj (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{a00046_af9f5ae207a1ee7d9574a3493577a9108}


Access to the \doxyref{Refinable\-Obj}{p.}{a00078} which is the compilation of all parameters from the object supplied for optimization and its sub-\/objects. 

Since this compilation is only updated from the suplied refinableobj and its sub-\/objects when \doxyref{Set\-Refined\-Obj()}{p.}{a00046_ac093bab1bcb43aa4ea00f63fdb53063f} and \doxyref{Prepare\-Ref\-Par\-List()}{p.}{a00046_afdeb58450a3e0506fc02a0b5df15a600} are called, it is possible to alter the fixed/limited status of parameters here without affecting the parameters in the refined objects. \index{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj@{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj}!Get\-Compiled\-Refined\-Obj@{Get\-Compiled\-Refined\-Obj}}
\index{Get\-Compiled\-Refined\-Obj@{Get\-Compiled\-Refined\-Obj}!ObjCryst::LSQNumObj@{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj}}
\paragraph[{Get\-Compiled\-Refined\-Obj}]{\setlength{\rightskip}{0pt plus 5cm}const {\bf Refinable\-Obj}\& Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj\-::\-Get\-Compiled\-Refined\-Obj (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const}\label{a00046_af94ebfd178b0c689130f8f99c2bd11da}


Access to the \doxyref{Refinable\-Obj}{p.}{a00078} which is the compilation of all parameters from the object supplied for optimization and its sub-\/objects. 

Since this compilation is only updated from the suplied refinableobj and its sub-\/objects when \doxyref{Set\-Refined\-Obj()}{p.}{a00046_ac093bab1bcb43aa4ea00f63fdb53063f} and \doxyref{Prepare\-Ref\-Par\-List()}{p.}{a00046_afdeb58450a3e0506fc02a0b5df15a600} are called, it is possible to alter the fixed/limited status of parameters here without affecting the parameters in the refined objects. \index{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj@{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj}!Get\-Refined\-Obj\-Map@{Get\-Refined\-Obj\-Map}}
\index{Get\-Refined\-Obj\-Map@{Get\-Refined\-Obj\-Map}!ObjCryst::LSQNumObj@{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj}}
\paragraph[{Get\-Refined\-Obj\-Map}]{\setlength{\rightskip}{0pt plus 5cm}const std\-::vector$<$ std\-::pair$<${\bf Refinable\-Obj}$\ast$,unsigned int$>$ $>$\& Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj\-::\-Get\-Refined\-Obj\-Map (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const}\label{a00046_a9465c139a524e2ee6890ca43eaf6570e}


Get the map of refined objects -\/ this is a recursive list of all the objects that are taken into account for the refinement. 

The key is a pointer to the object and the value is the L\-S\-Q function index for that object. \index{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj@{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj}!Get\-Refined\-Obj\-Map@{Get\-Refined\-Obj\-Map}}
\index{Get\-Refined\-Obj\-Map@{Get\-Refined\-Obj\-Map}!ObjCryst::LSQNumObj@{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj}}
\paragraph[{Get\-Refined\-Obj\-Map}]{\setlength{\rightskip}{0pt plus 5cm}std\-::vector$<$ std\-::pair$<${\bf Refinable\-Obj}$\ast$,unsigned int$>$ $>$\& Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj\-::\-Get\-Refined\-Obj\-Map (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{a00046_a8126e070d6d5efe7866b5f686e8efb40}


Get the map of refined objects -\/ this is a recursive list of all the objects that are taken into account for the refinement. 

The key is a pointer to the object and the value is the L\-S\-Q function index for that object. \index{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj@{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj}!Prepare\-Ref\-Par\-List@{Prepare\-Ref\-Par\-List}}
\index{Prepare\-Ref\-Par\-List@{Prepare\-Ref\-Par\-List}!ObjCryst::LSQNumObj@{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj}}
\paragraph[{Prepare\-Ref\-Par\-List}]{\setlength{\rightskip}{0pt plus 5cm}void Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj\-::\-Prepare\-Ref\-Par\-List (
\begin{DoxyParamCaption}
\item[{const bool}]{copy\-\_\-param = {\ttfamily false}}
\end{DoxyParamCaption}
)}\label{a00046_afdeb58450a3e0506fc02a0b5df15a600}


Prepare the full parameter list for the refinement. 


\begin{DoxyParams}{Parameters}
{\em copy\-\_\-param,\-:} & if false (the default), then the lsq algorithm will work directly on the parameters of the refined object and sub-\/object. So that any modification to the fixed/used/limited status applies permanently to the parameters. if true, then the parameters are copied and therefore only the value of the parameter is changed (and the clocks are ticked).\\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
\-: if copy\-\_\-param==true, then any modification to the parameters (fixed, limited, used status) only affects the copy and not the original. Also, calling again Prepare\-Ref\-Par\-List cancels any such modification.

This will be called automatically before starting the refinement only if the parameter list is empty. Otherwise it should be called before refinement. 
\end{DoxyNote}
\index{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj@{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj}!Refine@{Refine}}
\index{Refine@{Refine}!ObjCryst::LSQNumObj@{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj}}
\paragraph[{Refine}]{\setlength{\rightskip}{0pt plus 5cm}void Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj\-::\-Refine (
\begin{DoxyParamCaption}
\item[{int}]{nb\-Cycle = {\ttfamily 1}, }
\item[{bool}]{use\-Levenberg\-Marquardt = {\ttfamily false}, }
\item[{const bool}]{silent = {\ttfamily false}, }
\item[{const bool}]{call\-Begin\-End\-Optimization = {\ttfamily true}, }
\item[{const float}]{min\-Chi2var = {\ttfamily 0.01}}
\end{DoxyParamCaption}
)}\label{a00046_aaf5ceefe54c4fdfd0e48c3f5cd4f66b9}


Do the refinement. 


\begin{DoxyParams}{Parameters}
{\em nb\-Cycle,\-:} & number of L\-S\-Q cycles -\/ if negative, the algorithm will continue until it reaches (-\/nbcycle) or until the relative variation in Chi2 is less than min\-Chi2var \\
\hline
{\em use\-Levenberg\-Marquardt,\-:} & enable Levenberg-\/\-Marquardt algorithm to ensure that a decrease of Chi$^\wedge$2 will be obtained (actually a 1\% increase is allowed) \\
\hline
{\em call\-Begin\-End\-Optimization,\-:} & if true, will call \doxyref{Refinable\-Obj\-::\-Begin\-Optimization}{p.}{a00078_ababd8f2916e41a20d2c1b21f6ffefe96}(true,...) and \doxyref{Refinable\-Obj\-::\-End\-Optimization()}{p.}{a00078_ab0035f6164cb24ace67b51b11993a851}. You may not want this if the L\-S\-Q is done during another (e.\-g. monte-\/carlo) optimization -\/ but then the calling function {\bfseries must} ensure that approximations are disabled (using \doxyref{Refinable\-Obj\-::\-Set\-Approximation\-Flag}{p.}{a00078_a565c41c23c04f5945512374ae671e2e3}) for objects where that would render derivative calculations imprecise. \\
\hline
{\em min\-Chi2var,\-:} & used for termination of the refinement if the relative variation of Chi2 between two successive cyles is less than min\-Chi2var \\
\hline
\end{DoxyParams}
\index{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj@{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj}!Set\-Par\-Is\-Fixed@{Set\-Par\-Is\-Fixed}}
\index{Set\-Par\-Is\-Fixed@{Set\-Par\-Is\-Fixed}!ObjCryst::LSQNumObj@{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj}}
\paragraph[{Set\-Par\-Is\-Fixed}]{\setlength{\rightskip}{0pt plus 5cm}void Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj\-::\-Set\-Par\-Is\-Fixed (
\begin{DoxyParamCaption}
\item[{const std\-::string \&}]{par\-Name, }
\item[{const bool}]{fix}
\end{DoxyParamCaption}
)}\label{a00046_a0bc210b1f4e4b7099493d71c1a7c084d}


Fix one parameter. 

\doxyref{L\-S\-Q\-Num\-Obj\-::\-Prepare\-Ref\-Par\-List()}{p.}{a00046_afdeb58450a3e0506fc02a0b5df15a600} must be called first! \index{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj@{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj}!Set\-Par\-Is\-Fixed@{Set\-Par\-Is\-Fixed}}
\index{Set\-Par\-Is\-Fixed@{Set\-Par\-Is\-Fixed}!ObjCryst::LSQNumObj@{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj}}
\paragraph[{Set\-Par\-Is\-Fixed}]{\setlength{\rightskip}{0pt plus 5cm}void Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj\-::\-Set\-Par\-Is\-Fixed (
\begin{DoxyParamCaption}
\item[{const {\bf Ref\-Par\-Type} $\ast$}]{type, }
\item[{const bool}]{fix}
\end{DoxyParamCaption}
)}\label{a00046_a1be81668c496a3232e4b8416a3414bf3}


Fix one family of parameters. 

\doxyref{L\-S\-Q\-Num\-Obj\-::\-Prepare\-Ref\-Par\-List()}{p.}{a00046_afdeb58450a3e0506fc02a0b5df15a600} must be called first! \index{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj@{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj}!Set\-Par\-Is\-Fixed@{Set\-Par\-Is\-Fixed}}
\index{Set\-Par\-Is\-Fixed@{Set\-Par\-Is\-Fixed}!ObjCryst::LSQNumObj@{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj}}
\paragraph[{Set\-Par\-Is\-Fixed}]{\setlength{\rightskip}{0pt plus 5cm}void Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj\-::\-Set\-Par\-Is\-Fixed (
\begin{DoxyParamCaption}
\item[{{\bf Refinable\-Par} \&}]{par, }
\item[{const bool}]{fix}
\end{DoxyParamCaption}
)}\label{a00046_ad240667179e473c6c16e8928893dfdf8}


Fix one parameter. 

Note that this will fix the copied parameter, not the one in the original object. The supplied \doxyref{Refinable\-Par}{p.}{a00080} may be either the copied one or the original.

\doxyref{L\-S\-Q\-Num\-Obj\-::\-Prepare\-Ref\-Par\-List()}{p.}{a00046_afdeb58450a3e0506fc02a0b5df15a600} must be called first! \index{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj@{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj}!Set\-Par\-Is\-Fixed@{Set\-Par\-Is\-Fixed}}
\index{Set\-Par\-Is\-Fixed@{Set\-Par\-Is\-Fixed}!ObjCryst::LSQNumObj@{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj}}
\paragraph[{Set\-Par\-Is\-Fixed}]{\setlength{\rightskip}{0pt plus 5cm}void Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj\-::\-Set\-Par\-Is\-Fixed (
\begin{DoxyParamCaption}
\item[{{\bf Refinable\-Obj} \&}]{obj, }
\item[{const bool}]{fix}
\end{DoxyParamCaption}
)}\label{a00046_a6fdf2b9d64a527b0c2e81f92fd9be2c3}


Fix all parameters within an object. 

Note that this will fix the copied parameters, not the one in the original objects.

\doxyref{L\-S\-Q\-Num\-Obj\-::\-Prepare\-Ref\-Par\-List()}{p.}{a00046_afdeb58450a3e0506fc02a0b5df15a600} must be called first! \index{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj@{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj}!Set\-Par\-Is\-Used@{Set\-Par\-Is\-Used}}
\index{Set\-Par\-Is\-Used@{Set\-Par\-Is\-Used}!ObjCryst::LSQNumObj@{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj}}
\paragraph[{Set\-Par\-Is\-Used}]{\setlength{\rightskip}{0pt plus 5cm}void Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj\-::\-Set\-Par\-Is\-Used (
\begin{DoxyParamCaption}
\item[{const std\-::string \&}]{par\-Name, }
\item[{const bool}]{use}
\end{DoxyParamCaption}
)}\label{a00046_ab4da8ad96c83cb850145c028e0acb1a7}


Set a parameter to be used. 

\doxyref{L\-S\-Q\-Num\-Obj\-::\-Prepare\-Ref\-Par\-List()}{p.}{a00046_afdeb58450a3e0506fc02a0b5df15a600} must be called first! \index{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj@{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj}!Set\-Par\-Is\-Used@{Set\-Par\-Is\-Used}}
\index{Set\-Par\-Is\-Used@{Set\-Par\-Is\-Used}!ObjCryst::LSQNumObj@{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj}}
\paragraph[{Set\-Par\-Is\-Used}]{\setlength{\rightskip}{0pt plus 5cm}void Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj\-::\-Set\-Par\-Is\-Used (
\begin{DoxyParamCaption}
\item[{const {\bf Ref\-Par\-Type} $\ast$}]{type, }
\item[{const bool}]{use}
\end{DoxyParamCaption}
)}\label{a00046_a3164f80e5cecec4920aa8fae530a4ebe}


Set a family of parameters to be used. 

\doxyref{L\-S\-Q\-Num\-Obj\-::\-Prepare\-Ref\-Par\-List()}{p.}{a00046_afdeb58450a3e0506fc02a0b5df15a600} must be called first! \index{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj@{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj}!Set\-Refined\-Obj@{Set\-Refined\-Obj}}
\index{Set\-Refined\-Obj@{Set\-Refined\-Obj}!ObjCryst::LSQNumObj@{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj}}
\paragraph[{Set\-Refined\-Obj}]{\setlength{\rightskip}{0pt plus 5cm}void Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj\-::\-Set\-Refined\-Obj (
\begin{DoxyParamCaption}
\item[{{\bf Refinable\-Obj} \&}]{obj, }
\item[{const unsigned int}]{L\-S\-Q\-Func\-Index = {\ttfamily 0}, }
\item[{const bool}]{init = {\ttfamily true}, }
\item[{const bool}]{recursive = {\ttfamily false}}
\end{DoxyParamCaption}
)}\label{a00046_ac093bab1bcb43aa4ea00f63fdb53063f}


Choose the object to refine. 

The minimization will be done against its L\-S\-Q function and its parameters, as well as the L\-S\-Q functions and parameters of its sub-\/objects (if recursive==true)


\begin{DoxyParams}{Parameters}
{\em L\-S\-Q\-Func\-Index,\-:} & one object can have a choice of several L\-S\-Q functions to minimize-\/ this allows to choose which one to minimize.\\
\hline
{\em init,\-:} & if true, the list of refined objects is first cleared. otherwise the new object (and its sub-\/objects) is just added to the list.\\
\hline
{\em recursive,\-:} & if false, only the supplied object is added, and not its sub-\/objects \\
\hline
\end{DoxyParams}
\index{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj@{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj}!Un\-Fix\-All\-Par@{Un\-Fix\-All\-Par}}
\index{Un\-Fix\-All\-Par@{Un\-Fix\-All\-Par}!ObjCryst::LSQNumObj@{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj}}
\paragraph[{Un\-Fix\-All\-Par}]{\setlength{\rightskip}{0pt plus 5cm}void Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj\-::\-Un\-Fix\-All\-Par (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{a00046_ad7a98f0a5a88f61ec49ba66f558fe567}


Un\-Fix All parameters. 

\doxyref{L\-S\-Q\-Num\-Obj\-::\-Prepare\-Ref\-Par\-List()}{p.}{a00046_afdeb58450a3e0506fc02a0b5df15a600} must be called first! 

\subsubsection{Member Data Documentation}
\index{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj@{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj}!m\-Copy\-Ref\-Par@{m\-Copy\-Ref\-Par}}
\index{m\-Copy\-Ref\-Par@{m\-Copy\-Ref\-Par}!ObjCryst::LSQNumObj@{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj}}
\paragraph[{m\-Copy\-Ref\-Par}]{\setlength{\rightskip}{0pt plus 5cm}bool Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj\-::m\-Copy\-Ref\-Par\hspace{0.3cm}{\ttfamily [private]}}\label{a00046_a105c818fbabf06c50d930cc5286dabd6}


If true, then parameters to be refined will be copied instead of referenced. 

Therefore only their values and the parameter's clocks are affected when working on the copy. \index{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj@{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj}!m\-Index\-Values\-Set\-Initial@{m\-Index\-Values\-Set\-Initial}}
\index{m\-Index\-Values\-Set\-Initial@{m\-Index\-Values\-Set\-Initial}!ObjCryst::LSQNumObj@{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj}}
\paragraph[{m\-Index\-Values\-Set\-Initial}]{\setlength{\rightskip}{0pt plus 5cm}int Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj\-::m\-Index\-Values\-Set\-Initial\hspace{0.3cm}{\ttfamily [private]}}\label{a00046_afbc070643a325bf40c541689b3f3ef34}


Index of the set of saved values for all refinable parameters, before refinement and before the last cycle. 

\index{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj@{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj}!m\-Ref\-Par\-List@{m\-Ref\-Par\-List}}
\index{m\-Ref\-Par\-List@{m\-Ref\-Par\-List}!ObjCryst::LSQNumObj@{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj}}
\paragraph[{m\-Ref\-Par\-List}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Refinable\-Obj} Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj\-::m\-Ref\-Par\-List\hspace{0.3cm}{\ttfamily [mutable]}, {\ttfamily [private]}}\label{a00046_a81c41272858837f00d21f3db2a3312bb}


The refinable par list used during refinement. 

It is only a compilation of the parameters in \doxyref{Refinable\-Obj}{p.}{a00078} and its sub-\/objects

This list is only updated from the suplied refinableobj and its sub-\/objects when \doxyref{Set\-Refined\-Obj()}{p.}{a00046_ac093bab1bcb43aa4ea00f63fdb53063f} and \doxyref{Prepare\-Ref\-Par\-List()}{p.}{a00046_afdeb58450a3e0506fc02a0b5df15a600} are called, so it is possible to alter the fixed/limited status of parameters here without affecting the parameters in the refined objects. \index{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj@{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj}!mv\-Refined\-Obj\-Map@{mv\-Refined\-Obj\-Map}}
\index{mv\-Refined\-Obj\-Map@{mv\-Refined\-Obj\-Map}!ObjCryst::LSQNumObj@{Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj}}
\paragraph[{mv\-Refined\-Obj\-Map}]{\setlength{\rightskip}{0pt plus 5cm}std\-::vector$<$ std\-::pair$<${\bf Refinable\-Obj}$\ast$,unsigned int$>$ $>$ Obj\-Cryst\-::\-L\-S\-Q\-Num\-Obj\-::mv\-Refined\-Obj\-Map\hspace{0.3cm}{\ttfamily [private]}}\label{a00046_a910de8d3e6e961ee32a72a445ab4c059}


Map of the recursive list of the objects to be refined. 

The key is the pointer to the object and the value the L\-S\-Q function index

Individual L\-S\-Q functions can be changed using \doxyref{Get\-Refined\-Obj\-Map()}{p.}{a00046_a8126e070d6d5efe7866b5f686e8efb40}. 

The documentation for this class was generated from the following file\-:\begin{DoxyCompactItemize}
\item 
L\-S\-Q\-Num\-Obj.\-h\end{DoxyCompactItemize}
