\subsection{ObjCryst::StretchMode Struct Reference}
\label{a00096}\index{ObjCryst::StretchMode@{ObjCryst::StretchMode}}


Abstract base Stretch Mode for \doxyref{Molecule}{p.}{a00046} objects.  
Inheritance diagram for ObjCryst::StretchMode::\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=1.30233cm]{a00096}
\end{center}
\end{figure}
\subsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
virtual void {\bf CalcDeriv} (const bool derivllk=true) const =0
\begin{DoxyCompactList}\small\item\em Calculate the derivative of the Molecule's Log(likelihood) and atomic positions versus a change of the bond length. \item\end{DoxyCompactList}\item 
virtual void {\bf Print} (ostream \&os, bool full=true) const =0\label{a00096_a78c180042fce5981fe0e97071d986362}

\begin{DoxyCompactList}\small\item\em Print one-\/line list of atoms moved. \item\end{DoxyCompactList}\item 
virtual void {\bf Stretch} (const REAL change)=0\label{a00096_a1f3e7e8fc43baed619b61203ea77c143}

\begin{DoxyCompactList}\small\item\em Move the atoms according to this mode. \item\end{DoxyCompactList}\item 
virtual void {\bf RandomStretch} (const REAL amplitude)=0\label{a00096_a459057c6cd3d2cb1010676b54ebfe988}

\begin{DoxyCompactList}\small\item\em Move the atoms according to this mode, randomly. \item\end{DoxyCompactList}\end{DoxyCompactItemize}
\subsubsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
std::map$<$ const {\bf MolBond} $\ast$, REAL $>$ {\bf mvpBrokenBond}\label{a00096_a6628812c69f20a7a18a7a3759b5c961c}

\begin{DoxyCompactList}\small\item\em List of bond restraints affected by this mode The key is the restraint, the value is the derivative of the LLK associated. \item\end{DoxyCompactList}\item 
std::map$<$ const {\bf MolBondAngle} $\ast$, REAL $>$ {\bf mvpBrokenBondAngle}\label{a00096_a2a46f6bd997850be6736e4b5746deeed}

\begin{DoxyCompactList}\small\item\em List of bond angle restraints modified by this mode The key is the restraint, the value is the derivative of the LLK associated. \item\end{DoxyCompactList}\item 
std::map$<$ const {\bf MolDihedralAngle} $\ast$, REAL $>$ {\bf mvpBrokenDihedralAngle}\label{a00096_a84257bc829a3d612b68046d33685e59e}

\begin{DoxyCompactList}\small\item\em List of dihedral angle restraints modified by this mode The key is the restraint, the value is the derivative of the LLK associated. \item\end{DoxyCompactList}\item 
REAL {\bf mLLKDeriv}\label{a00096_ac6614921c015de3f6d67b22ae512a66c}

\begin{DoxyCompactList}\small\item\em Derivative of the Molecule's Log(likelihood) versus a change of the bond length. \item\end{DoxyCompactList}\item 
std::map$<$ const {\bf MolAtom} $\ast$, {\bf XYZ} $>$ {\bf mDerivXYZ}\label{a00096_a4a25093e177c56be142acc954149c110}

\begin{DoxyCompactList}\small\item\em Derivative of the atomic positions versus a change of the bond length. \item\end{DoxyCompactList}\item 
{\bf Molecule} $\ast$ {\bf mpMol}\label{a00096_a380bd0aef1e5be1f681364e0f754f3e3}

\begin{DoxyCompactList}\small\item\em The \doxyref{Molecule}{p.}{a00046} corresponding to this stretch mode. \item\end{DoxyCompactList}\item 
REAL {\bf mBaseAmplitude}
\begin{DoxyCompactList}\small\item\em The recommended change amplitude, for a base global optimization displacement, to obtain an average 0.1 Angstroem displacement. \item\end{DoxyCompactList}\end{DoxyCompactItemize}


\subsubsection{Detailed Description}
Abstract base Stretch Mode for \doxyref{Molecule}{p.}{a00046} objects. 

\subsubsection{Member Function Documentation}
\index{ObjCryst::StretchMode@{ObjCryst::StretchMode}!CalcDeriv@{CalcDeriv}}
\index{CalcDeriv@{CalcDeriv}!ObjCryst::StretchMode@{ObjCryst::StretchMode}}
\paragraph[{CalcDeriv}]{\setlength{\rightskip}{0pt plus 5cm}virtual void ObjCryst::StretchMode::CalcDeriv (const bool {\em derivllk} = {\ttfamily true}) const\hspace{0.3cm}{\ttfamily  [pure virtual]}}\hfill\label{a00096_a5b5ab5f9819c047a49719a330722d419}


Calculate the derivative of the Molecule's Log(likelihood) and atomic positions versus a change of the bond length. The result is stored in mLLKDeriv and mLLKDerivXYZ, as well as in the various lists of restraints broken by this mode.


\begin{DoxyParams}{Parameters}
\item[{\em derivllk,:}]if false, the derivative of the overall llk will not be computed, only the derivative of the atomic positions. \end{DoxyParams}


Implemented in {\bf ObjCryst::StretchModeBondLength} \doxyref{}{p.}{a00098_a72bab02ebf84cbf65cf2703e74c1e02e}, {\bf ObjCryst::StretchModeBondAngle} \doxyref{}{p.}{a00097_acdc082c4cb5b4f38fed6049bf7b1eb9c}, {\bf ObjCryst::StretchModeTorsion} \doxyref{}{p.}{a00100_abecf1074b05ba13fd938667399df110e}, and {\bf ObjCryst::StretchModeTwist} \doxyref{}{p.}{a00101_afd1ac754d10507e1c9bed829a4eaeb79}.

\subsubsection{Member Data Documentation}
\index{ObjCryst::StretchMode@{ObjCryst::StretchMode}!mBaseAmplitude@{mBaseAmplitude}}
\index{mBaseAmplitude@{mBaseAmplitude}!ObjCryst::StretchMode@{ObjCryst::StretchMode}}
\paragraph[{mBaseAmplitude}]{\setlength{\rightskip}{0pt plus 5cm}REAL {\bf ObjCryst::StretchMode::mBaseAmplitude}}\hfill\label{a00096_aa8dc03e2bd6840d13964dd6751c39fae}


The recommended change amplitude, for a base global optimization displacement, to obtain an average 0.1 Angstroem displacement. This is learnt at the beginning of an optimization.

This can be superseeded to respect any restraint. 

The documentation for this struct was generated from the following file:\begin{DoxyCompactItemize}
\item 
Molecule.h\end{DoxyCompactItemize}
