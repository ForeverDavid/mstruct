\subsection{Obj\-Cryst\-:\-:Crystal Class Reference}
\label{a00027}\index{Obj\-Cryst\-::\-Crystal@{Obj\-Cryst\-::\-Crystal}}


\doxyref{Crystal}{p.}{a00027} class\-: Unit cell, spacegroup, scatterers.  


Inheritance diagram for Obj\-Cryst\-:\-:Crystal\-:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=3.000000cm]{a00027}
\end{center}
\end{figure}
\subsubsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct {\bf Bump\-Merge\-Par}
\begin{DoxyCompactList}\small\item\em Storage for anti-\/bump/merge parameters. \end{DoxyCompactList}\item 
struct {\bf Neighbour}
\begin{DoxyCompactList}\small\item\em Interatomic distance for a given neighbour. \end{DoxyCompactList}\item 
struct {\bf Neighbour\-Hood}
\begin{DoxyCompactList}\small\item\em Table of neighbours for a given unique atom. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsubsection*{Public Types}
\begin{DoxyCompactItemize}
\item 
typedef std\-::map$<$ pair$<$ const \\*
{\bf Scattering\-Power} $\ast$, const \\*
{\bf Scattering\-Power} $\ast$ $>$\\*
, {\bf Crystal\-::\-Bump\-Merge\-Par} $>$ {\bf V\-Bump\-Merge\-Par}
\begin{DoxyCompactList}\small\item\em Anti-\/bump parameters. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
{\bf Crystal} ()\label{a00027_a4d9c152db2dfcea3c849d0a7ae547a2e}

\begin{DoxyCompactList}\small\item\em Default Constructor. \end{DoxyCompactList}\item 
{\bf Crystal} (const R\-E\-A\-L a, const R\-E\-A\-L b, const R\-E\-A\-L c, const string \&Space\-Group\-Id)
\begin{DoxyCompactList}\small\item\em \doxyref{Crystal}{p.}{a00027} Constructor (orthorombic) \end{DoxyCompactList}\item 
{\bf Crystal} (const R\-E\-A\-L a, const R\-E\-A\-L b, const R\-E\-A\-L c, const R\-E\-A\-L alpha, const R\-E\-A\-L beta, const R\-E\-A\-L gamma, const string \&Space\-Group\-Id)
\begin{DoxyCompactList}\small\item\em \doxyref{Crystal}{p.}{a00027} Constructor (triclinic) \end{DoxyCompactList}\item 
{\bf Crystal} (const {\bf Crystal} \&old\-Cryst)\label{a00027_a4fd1bac8dbb8c119077f3b1f3d19153f}

\begin{DoxyCompactList}\small\item\em \doxyref{Crystal}{p.}{a00027} copy constructor. \end{DoxyCompactList}\item 
{\bf $\sim$\-Crystal} ()\label{a00027_a13a9e007a57aeb11a5d808099c56c2b5}

\begin{DoxyCompactList}\small\item\em \doxyref{Crystal}{p.}{a00027} destructor. \end{DoxyCompactList}\item 
virtual const string \& {\bf Get\-Class\-Name} () const 
\begin{DoxyCompactList}\small\item\em Name for this class (\char`\"{}\-Refinable\-Obj\char`\"{}, \char`\"{}\-Crystal\char`\"{},...). \end{DoxyCompactList}\item 
void {\bf Add\-Scatterer} ({\bf Scatterer} $\ast$scatt)
\begin{DoxyCompactList}\small\item\em Add a scatterer to the crystal. \end{DoxyCompactList}\item 
void {\bf Remove\-Scatterer} ({\bf Scatterer} $\ast$scatt, const bool del=true)\label{a00027_ac2755d27280cfa572aa334e6e596da98}

\begin{DoxyCompactList}\small\item\em Remove a \doxyref{Scatterer}{p.}{a00092}. This also deletes the scatterer unless del=false. \end{DoxyCompactList}\item 
long {\bf Get\-Nb\-Scatterer} () const \label{a00027_a5fb1f327104bd5cf5550265b1453a639}

\begin{DoxyCompactList}\small\item\em Number of scatterers in the crystal. \end{DoxyCompactList}\item 
{\bf Scatterer} \& {\bf Get\-Scatt} (const string \&scatt\-Name)
\begin{DoxyCompactList}\small\item\em Provides an access to the scatterers. \end{DoxyCompactList}\item 
const {\bf Scatterer} \& {\bf Get\-Scatt} (const string \&scatt\-Name) const 
\begin{DoxyCompactList}\small\item\em Provides a const access to the scatterers. \end{DoxyCompactList}\item 
{\bf Scatterer} \& {\bf Get\-Scatt} (const long scatt\-Index)
\begin{DoxyCompactList}\small\item\em Provides an access to the scatterers. \end{DoxyCompactList}\item 
const {\bf Scatterer} \& {\bf Get\-Scatt} (const long scatt\-Index) const 
\begin{DoxyCompactList}\small\item\em Provides a const access to the scatterers. \end{DoxyCompactList}\item 
{\bf Obj\-Registry}$<$ {\bf Scatterer} $>$ \& {\bf Get\-Scatterer\-Registry} ()\label{a00027_ad2e15e119a2cfc4104efd46672c63b64}

\begin{DoxyCompactList}\small\item\em Get the registry of scatterers. \end{DoxyCompactList}\item 
const {\bf Obj\-Registry}$<$ {\bf Scatterer} $>$ \& {\bf Get\-Scatterer\-Registry} () const \label{a00027_ac93eb73b0194e1550a0d6eb5b313ab44}

\begin{DoxyCompactList}\small\item\em Get the registry of scatterers. \end{DoxyCompactList}\item 
{\bf Obj\-Registry}$<$ {\bf Scattering\-Power} $>$ \& {\bf Get\-Scattering\-Power\-Registry} ()\label{a00027_a53d6f239dbfae0040c900e4d4e120e73}

\begin{DoxyCompactList}\small\item\em Get the registry of \doxyref{Scattering\-Power}{p.}{a00097} included in this \doxyref{Crystal}{p.}{a00027}. \end{DoxyCompactList}\item 
const {\bf Obj\-Registry}\\*
$<$ {\bf Scattering\-Power} $>$ \& {\bf Get\-Scattering\-Power\-Registry} () const \label{a00027_abcc623c63dfe1085d28e7d73811fff16}

\begin{DoxyCompactList}\small\item\em Get the registry of \doxyref{Scattering\-Power}{p.}{a00097} included in this \doxyref{Crystal}{p.}{a00027}. \end{DoxyCompactList}\item 
void {\bf Add\-Scattering\-Power} ({\bf Scattering\-Power} $\ast$scatt\-Pow)
\begin{DoxyCompactList}\small\item\em Add a \doxyref{Scattering\-Power}{p.}{a00097} for this \doxyref{Crystal}{p.}{a00027}. \end{DoxyCompactList}\item 
void {\bf Remove\-Scattering\-Power} ({\bf Scattering\-Power} $\ast$scatt\-Pow, const bool del=true)
\begin{DoxyCompactList}\small\item\em Remove a \doxyref{Scattering\-Power}{p.}{a00097} for this \doxyref{Crystal}{p.}{a00027}. \end{DoxyCompactList}\item 
{\bf Scattering\-Power} \& {\bf Get\-Scattering\-Power} (const string \&name)\label{a00027_a3a71094a078502bbb73f811f895cb438}

\begin{DoxyCompactList}\small\item\em Find a \doxyref{Scattering\-Power}{p.}{a00097} from its name. Names must be unique in a given \doxyref{Crystal}{p.}{a00027}. \end{DoxyCompactList}\item 
const {\bf Scattering\-Power} \& {\bf Get\-Scattering\-Power} (const string \&name) const \label{a00027_a5622a2ef63f40084527626c94085f90a}

\begin{DoxyCompactList}\small\item\em Find a \doxyref{Scattering\-Power}{p.}{a00097} from its name. Names must be unique in a given \doxyref{Crystal}{p.}{a00027}. \end{DoxyCompactList}\item 
const {\bf Refinable\-Obj\-Clock} \& {\bf Get\-Master\-Clock\-Scattering\-Power} () const \label{a00027_a3b583a9655a174de9c21e139eea709dc}

\begin{DoxyCompactList}\small\item\em Get the clock which reports all changes in Scattering\-Powers. \end{DoxyCompactList}\item 
virtual const \\*
{\bf Scattering\-Component\-List} \& {\bf Get\-Scattering\-Component\-List} () const \label{a00027_a748d335480c372c5ef6cdf8716d9dd1a}

\begin{DoxyCompactList}\small\item\em Get the list of all scattering components. \end{DoxyCompactList}\item 
const {\bf Refinable\-Obj\-Clock} \& {\bf Get\-Clock\-Scatt\-Comp\-List} () const \label{a00027_a1deb673a7f01f6a71c659f28ddf5cd21}

\begin{DoxyCompactList}\small\item\em Get the list of all scattering components. \end{DoxyCompactList}\item 
void {\bf Print} (ostream \&os=cout) const 
\begin{DoxyCompactList}\small\item\em Prints some info about the crystal. \end{DoxyCompactList}\item 
Cryst\-Matrix\-\_\-\-R\-E\-A\-L {\bf Get\-Min\-Distance\-Table} (const R\-E\-A\-L min\-Distance=0.\-1) const 
\begin{DoxyCompactList}\small\item\em Minimum interatomic distance between all scattering components (atoms) in the crystal. \end{DoxyCompactList}\item 
void {\bf Print\-Min\-Distance\-Table} (const R\-E\-A\-L min\-Distance=0.\-1, ostream \&os=cout) const 
\begin{DoxyCompactList}\small\item\em Print the minimum distance table between all scattering centers (atoms) in the crystal. \end{DoxyCompactList}\item 
ostream \& {\bf P\-O\-V\-Ray\-Description} (ostream \&os, const {\bf Crystal\-P\-O\-V\-Ray\-Options} \&options) const 
\begin{DoxyCompactList}\small\item\em X\-M\-L\-Output P\-O\-V-\/\-Ray Description for this \doxyref{Crystal}{p.}{a00027}. \end{DoxyCompactList}\item 
virtual void {\bf G\-L\-Init\-Display\-List} (const bool only\-Independent\-Atoms=false, const R\-E\-A\-L x\-Min=-\/.\-1, const R\-E\-A\-L x\-Max=1.\-1, const R\-E\-A\-L y\-Min=-\/.\-1, const R\-E\-A\-L y\-Max=1.\-1, const R\-E\-A\-L z\-Min=-\/.\-1, const R\-E\-A\-L z\-Max=1.\-1, const bool display\-Names=false) const 
\begin{DoxyCompactList}\small\item\em Create an Open\-G\-L Display\-List of the crystal. \end{DoxyCompactList}\item 
void {\bf Calc\-Dyn\-Pop\-Corr} (const R\-E\-A\-L overlap\-Dist=1., const R\-E\-A\-L merge\-Dist=.\-0) const 
\begin{DoxyCompactList}\small\item\em Compute the 'Dynamical population correction for all atoms. Atoms which are considered \char`\"{}equivalent\char`\"{} (ie currently with the same Z number) and which are overlapping see their Dynamical occupancy changed so that when they fully overlap, they are equivalent to 1 atom. \end{DoxyCompactList}\item 
void {\bf Reset\-Dyn\-Pop\-Corr} () const \label{a00027_a9230b222fe2cde018c6b08fab6d5da8b}

\begin{DoxyCompactList}\small\item\em Reset Dynamical Population Correction factors (ie set it to 1) \end{DoxyCompactList}\item 
void {\bf Set\-Use\-Dyn\-Pop\-Corr} (const int use)
\begin{DoxyCompactList}\small\item\em Set the use of dynamical population correction (\doxyref{Crystal\-::m\-Use\-Dyn\-Pop\-Corr}{p.}{a00027_aa75ade2fea9a50b3e6fb08773f607a13}). \end{DoxyCompactList}\item 
R\-E\-A\-L {\bf Get\-Bump\-Merge\-Cost} () const 
\begin{DoxyCompactList}\small\item\em Get the Anti-\/bumping/pro-\/\-Merging cost function. \end{DoxyCompactList}\item 
void {\bf Set\-Bump\-Merge\-Distance} (const {\bf Scattering\-Power} \&scatt1, const {\bf Scattering\-Power} \&scatt2, const R\-E\-A\-L dist=1.\-5)
\begin{DoxyCompactList}\small\item\em Set the Anti-\/bumping distance between two scattering types. \end{DoxyCompactList}\item 
void {\bf Set\-Bump\-Merge\-Distance} (const {\bf Scattering\-Power} \&scatt1, const {\bf Scattering\-Power} \&scatt2, const R\-E\-A\-L dist, const bool allow\-Merge)\label{a00027_a74a095efbf1f414a0707532cb51f78ca}

\begin{DoxyCompactList}\small\item\em Set the Anti-\/bumping distance between two scattering types. \end{DoxyCompactList}\item 
void {\bf Remove\-Bump\-Merge\-Distance} (const {\bf Scattering\-Power} \&scatt1, const {\bf Scattering\-Power} \&scatt2)\label{a00027_ac098ff50897a0afdec066d5f3872a5a1}

\begin{DoxyCompactList}\small\item\em Remove an Anti-\/bumping distance between two scattering types. \end{DoxyCompactList}\item 
const {\bf V\-Bump\-Merge\-Par} \& {\bfseries Get\-Bump\-Merge\-Par\-List} () const \label{a00027_a0e1cfe79846330b06619619a51af34d6}

\item 
{\bf V\-Bump\-Merge\-Par} \& {\bfseries Get\-Bump\-Merge\-Par\-List} ()\label{a00027_a454da6faa3699da08af3ed99f2193d9a}

\item 
const {\bf Refinable\-Obj\-Clock} \& {\bf Get\-Clock\-Scatterer\-List} () const \label{a00027_a656dd25b9a62224144142fff3eba1627}

\begin{DoxyCompactList}\small\item\em When was the list of scatterers last changed ? \end{DoxyCompactList}\item 
virtual void {\bf X\-M\-L\-Output} (ostream \&os, int indent=0) const 
\begin{DoxyCompactList}\small\item\em Output to stream in well-\/formed X\-M\-L. \end{DoxyCompactList}\item 
virtual void {\bf X\-M\-L\-Input} (istream \&is, const {\bf X\-M\-L\-Cryst\-Tag} \&tag)
\begin{DoxyCompactList}\small\item\em Input From stream. \end{DoxyCompactList}\item 
virtual void {\bf Global\-Opt\-Random\-Move} (const R\-E\-A\-L mutation\-Amplitude, const {\bf Ref\-Par\-Type} $\ast$type={\bf gp\-Ref\-Par\-Type\-Obj\-Cryst})
\begin{DoxyCompactList}\small\item\em Make a random move of the current configuration. \end{DoxyCompactList}\item 
virtual R\-E\-A\-L {\bf Get\-Log\-Likelihood} () const 
\begin{DoxyCompactList}\small\item\em Get -\/log(likelihood) of the current configuration for the object. \end{DoxyCompactList}\item 
virtual void {\bf C\-I\-F\-Output} (ostream \&os) const 
\begin{DoxyCompactList}\small\item\em output \doxyref{Crystal}{p.}{a00027} structure as a cif file (E\-X\-P\-E\-R\-I\-M\-E\-N\-T\-A\-L !) \end{DoxyCompactList}\item 
virtual void {\bf Get\-Gene\-Group} (const {\bf Refinable\-Obj} \&obj, Cryst\-Vector\-\_\-uint \&group\-Index, unsigned int \&first\-Group) const 
\begin{DoxyCompactList}\small\item\em Get the gene group assigned to each parameter. \end{DoxyCompactList}\item 
virtual void {\bf Begin\-Optimization} (const bool allow\-Approximations=false, const bool enable\-Restraints=false)
\begin{DoxyCompactList}\small\item\em This should be called by any optimization class at the begining of an optimization. \end{DoxyCompactList}\item 
void {\bfseries Add\-Bond\-Valence\-Ro} (const {\bf Scattering\-Power} \&, const {\bf Scattering\-Power} \&, const R\-E\-A\-L ro)\label{a00027_a8b12fd9aae0c485bcdb17ac4fa4a17fc}

\item 
void {\bfseries Remove\-Bond\-Valence\-Ro} (const {\bf Scattering\-Power} \&, const {\bf Scattering\-Power} \&)\label{a00027_aca3dd86f521af211c6057c547fa907a6}

\item 
R\-E\-A\-L {\bf Get\-Bond\-Valence\-Cost} () const \label{a00027_afb63f1cd68bef00efde221449a0471db}

\begin{DoxyCompactList}\small\item\em Get the Bond-\/\-Valence cost function, which compares the expected valence to the one computed from Bond-\/\-Valence Ro parameters. \end{DoxyCompactList}\item 
std\-::map$<$ pair$<$ const \\*
{\bf Scattering\-Power} $\ast$, const \\*
{\bf Scattering\-Power} $\ast$ $>$, R\-E\-A\-L $>$ \& {\bfseries Get\-Bond\-Valence\-Ro\-List} ()\label{a00027_a98cd544cd8bdee0e2be4564eb74d43f3}

\item 
const std\-::map$<$ pair$<$ const \\*
{\bf Scattering\-Power} $\ast$, const \\*
{\bf Scattering\-Power} $\ast$ $>$, R\-E\-A\-L $>$ \& {\bfseries Get\-Bond\-Valence\-Ro\-List} () const \label{a00027_af6fd92d99e5b95195fbfac86551f37b3}

\item 
void {\bf Init} (const R\-E\-A\-L a, const R\-E\-A\-L b, const R\-E\-A\-L c, const R\-E\-A\-L alpha, const R\-E\-A\-L beta, const R\-E\-A\-L gamma, const string \&Space\-Group\-Id, const string \&name)
\begin{DoxyCompactList}\small\item\em Init all \doxyref{Crystal}{p.}{a00027} parameters. \end{DoxyCompactList}\item 
void {\bf Set\-Delete\-Sub\-Obj\-In\-Destructor} (const bool b)
\begin{DoxyCompactList}\small\item\em Set whether to delete the Scatterers and Scattering\-Powers in the destructor. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsubsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
void {\bf Init\-Options} ()
\begin{DoxyCompactList}\small\item\em Init options. \end{DoxyCompactList}\item 
int {\bf Find\-Scatterer} (const string \&scatt\-Name) const 
\begin{DoxyCompactList}\small\item\em Find a scatterer (its index \# in mp\-Scatterrer[]) with a given name. \end{DoxyCompactList}\item 
void {\bf Calc\-Dist\-Table} (const bool fast) const 
\begin{DoxyCompactList}\small\item\em Compute the distance Table (m\-Dist\-Table) for all scattering components. \end{DoxyCompactList}\item 
void {\bf Calc\-Bond\-Valence\-Sum} () const \label{a00027_a9e38da0889a3509dda6ca1ad39f07106}

\begin{DoxyCompactList}\small\item\em Calculate all Bond Valences. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsubsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
{\bf Obj\-Registry}$<$ {\bf Scatterer} $>$ {\bf m\-Scatterer\-Registry}\label{a00027_a95b53923f17cc84cfdd2eab1c028b646}

\begin{DoxyCompactList}\small\item\em The registry of scatterers for this \doxyref{Unit\-Cell}{p.}{a00117}. \end{DoxyCompactList}\item 
{\bf V\-Bump\-Merge\-Par} {\bf mv\-Bump\-Merge\-Par}\label{a00027_a96fa4e0d7548e2da3aceae44223acb9a}

\begin{DoxyCompactList}\small\item\em Anti-\/bump parameters map. \end{DoxyCompactList}\item 
{\bf Refinable\-Obj\-Clock} {\bf m\-Bump\-Merge\-Par\-Clock}\label{a00027_aa56df3d4cc3021b24e3d521de5fba508}

\begin{DoxyCompactList}\small\item\em Last Time Anti-\/bump parameters were changed. \end{DoxyCompactList}\item 
{\bf Refinable\-Obj\-Clock} {\bf m\-Bump\-Merge\-Cost\-Clock}\label{a00027_a53766d304020a6eec3db2c789ff08cf5}

\begin{DoxyCompactList}\small\item\em Last Time Anti-\/bump parameters were changed. \end{DoxyCompactList}\item 
R\-E\-A\-L {\bf m\-Bump\-Merge\-Cost}\label{a00027_ad57883557f407dd8c7da778432217fb2}

\begin{DoxyCompactList}\small\item\em Current bump-\/merge cost. \end{DoxyCompactList}\item 
R\-E\-A\-L {\bf m\-Bump\-Merge\-Scale}\label{a00027_aea7ce861440b7f71140d577532c8d8ee}

\begin{DoxyCompactList}\small\item\em Bump-\/merge scale factor. \end{DoxyCompactList}\item 
std\-::vector$<$ {\bf Neighbour\-Hood} $>$ {\bf mv\-Dist\-Table\-Sq}
\begin{DoxyCompactList}\small\item\em Interatomic distance table for all unique atoms. \end{DoxyCompactList}\item 
{\bf Refinable\-Obj\-Clock} {\bf m\-Dist\-Table\-Clock}\label{a00027_ad76e9124e15045be67edd402e10769a7}

\begin{DoxyCompactList}\small\item\em The time when the distance table was last calculated. \end{DoxyCompactList}\item 
R\-E\-A\-L {\bf m\-Dist\-Table\-Max\-Distance}\label{a00027_a92bee4d000d1d634308d5686d8ae5f42}

\begin{DoxyCompactList}\small\item\em The distance up to which the distance table \& neighbours needs to be calculated. \end{DoxyCompactList}\item 
{\bf Scattering\-Component\-List} {\bf m\-Scatt\-Comp\-List}\label{a00027_a2f45b59533a1a3114391aa04e7017bf8}

\begin{DoxyCompactList}\small\item\em The list of all scattering components in the crystal. \end{DoxyCompactList}\item 
{\bf Refinable\-Obj\-Clock} {\bf m\-Lattice\-Clock}\label{a00027_ae46dd6f236625d70b696253bb81b75c5}

\begin{DoxyCompactList}\small\item\em Clock for lattice paramaters. \end{DoxyCompactList}\item 
{\bf Ref\-Obj\-Opt} {\bf m\-Use\-Dyn\-Pop\-Corr}\label{a00027_aa75ade2fea9a50b3e6fb08773f607a13}

\begin{DoxyCompactList}\small\item\em Use Dynamical population correction (\doxyref{Scattering\-Component\-::m\-Dyn\-Pop\-Corr}{p.}{a00093_a33af12bb3f340af259a8b8450f837efd}) during Structure factor calculation ? \end{DoxyCompactList}\item 
{\bf Obj\-Registry}$<$ {\bf Scattering\-Power} $>$ {\bf m\-Scattering\-Power\-Registry}\label{a00027_a85f96fb904d5cd1f368c977f1653f509}

\begin{DoxyCompactList}\small\item\em The registry of \doxyref{Scattering\-Power}{p.}{a00097} for this \doxyref{Crystal}{p.}{a00027}. \end{DoxyCompactList}\item 
{\bf Refinable\-Obj\-Clock} {\bf m\-Clock\-Scatterer\-List}\label{a00027_a8042bd11e0b5054f21d4e72bc1966e05}

\begin{DoxyCompactList}\small\item\em Last time the list of Scatterers was changed. \end{DoxyCompactList}\item 
{\bf Refinable\-Obj\-Clock} {\bf m\-Clock\-Scatt\-Comp\-List}
\item 
{\bf Refinable\-Obj\-Clock} {\bf m\-Clock\-Neighbor\-Table}
\item 
{\bf Refinable\-Obj\-Clock} {\bf m\-Clock\-Dyn\-Pop\-Corr}
\item 
{\bf Refinable\-Obj\-Clock} {\bf m\-Master\-Clock\-Scattering\-Power}\label{a00027_a0c0317433ca0e745094835e165f4e5e7}

\begin{DoxyCompactList}\small\item\em master clock recording every change in Scattering Powers \end{DoxyCompactList}\item 
{\bf Ref\-Obj\-Opt} {\bf m\-Display\-Enantiomer}
\begin{DoxyCompactList}\small\item\em Display the enantiomeric (mirror along x) structure in 3\-D? This can be helpful for non-\/centrosymmetric structure which have been solved using powder diffraction (which only gives the relative configuration). \end{DoxyCompactList}\item 
map$<$ pair$<$ const \\*
{\bf Scattering\-Power} $\ast$, const \\*
{\bf Scattering\-Power} $\ast$ $>$, R\-E\-A\-L $>$ {\bf mv\-Bond\-Valence\-Ro}\label{a00027_a861db7aad30d32436ff7f7d41efef5c5}

\begin{DoxyCompactList}\small\item\em Map of Bond Valence \char`\"{}\-Ro\char`\"{} parameters for each couple of \doxyref{Scattering\-Power}{p.}{a00097}. \end{DoxyCompactList}\item 
{\bf Refinable\-Obj\-Clock} {\bf m\-Bond\-Valence\-Par\-Clock}\label{a00027_a30556d5f1daeff997ff562f7bd70298e}

\begin{DoxyCompactList}\small\item\em Last Time Bond Valence parameters were changed. \end{DoxyCompactList}\item 
{\bf Refinable\-Obj\-Clock} {\bf m\-Bond\-Valence\-Calc\-Clock}\label{a00027_a31d557a0f85089e9bc978b2d22c66fe6}

\begin{DoxyCompactList}\small\item\em Last time Bond Valences were calculated. \end{DoxyCompactList}\item 
{\bf Refinable\-Obj\-Clock} {\bf m\-Bond\-Valence\-Cost\-Clock}\label{a00027_ae83ac26a84c2e72d6e088b80ea134079}

\begin{DoxyCompactList}\small\item\em Last time the Bond Valence cost was calculated. \end{DoxyCompactList}\item 
R\-E\-A\-L {\bf m\-Bond\-Valence\-Cost}\label{a00027_afcec48187cc76f08f1d925540268a648}

\begin{DoxyCompactList}\small\item\em Current Bond Valence cost. \end{DoxyCompactList}\item 
R\-E\-A\-L {\bf m\-Bond\-Valence\-Cost\-Scale}\label{a00027_a310b5fa7d00c874c84d4d72a03b147a0}

\begin{DoxyCompactList}\small\item\em Bond Valence cost scale factor. \end{DoxyCompactList}\item 
std\-::map$<$ long, R\-E\-A\-L $>$ {\bf mv\-Bond\-Valence\-Calc}
\begin{DoxyCompactList}\small\item\em List of calculated bond valences, as a map, the key being the index of the atom in \doxyref{Crystal\-::m\-Scatt\-Comp\-List}{p.}{a00027_a2f45b59533a1a3114391aa04e7017bf8}. \end{DoxyCompactList}\item 
bool {\bfseries m\-Delete\-Sub\-Obj\-In\-Destructor}\label{a00027_a721474f86d405f3cef5eb6756ae3bb36}

\end{DoxyCompactItemize}
\subsubsection*{Additional Inherited Members}


\subsubsection{Detailed Description}
\doxyref{Crystal}{p.}{a00027} class\-: Unit cell, spacegroup, scatterers. 

A \doxyref{Crystal}{p.}{a00027} object has several main characteristics \-: (1) a unit cell, (2) a Spacegroup and (3) a list of \doxyref{Scatterer}{p.}{a00092}. Also stored in the \doxyref{Crystal}{p.}{a00027} is a list of the Scttaring\-Power used by all the scatterers of this crystal.

The crystal is capable of giving a list of all scattering components (ie the list of all unique scattering 'points' (\doxyref{Scattering\-Component}{p.}{a00093}, ie atoms) in the unit cell, each associated to a \doxyref{Scattering\-Power}{p.}{a00097}).

When those scattering components are on a special position or overlapping with another component of the same type, it is possible to correct dynamically the occupancy of this/these components to effectively have only one component instead of several due to the overlapping. This method is interesting for global optimization where atoms must not be \char`\"{}locked\char`\"{} on a special position. If this \char`\"{}\-Dynamical Occupancy Correction\char`\"{} is used then no occupancy should be corrected for special positions, since this will be done dynamically.

A crystal structure can be viewed in 3\-D using Open\-G\-L.

\begin{DoxyRefDesc}{Todo}
\item[{\bf Todo}]exporting (and importing) crystal structures to/from other files format than \doxyref{Obj\-Cryst}{p.}{a00178}'s X\-M\-L (eg \doxyref{C\-I\-F}{p.}{a00024}, and format used by refinement software)\end{DoxyRefDesc}


Currently only 3\-D crystal structures can be handled, with no magnetic structure (that may be done later) and no incommensurate structure. 

\subsubsection{Member Typedef Documentation}
\index{Obj\-Cryst\-::\-Crystal@{Obj\-Cryst\-::\-Crystal}!V\-Bump\-Merge\-Par@{V\-Bump\-Merge\-Par}}
\index{V\-Bump\-Merge\-Par@{V\-Bump\-Merge\-Par}!ObjCryst::Crystal@{Obj\-Cryst\-::\-Crystal}}
\paragraph[{V\-Bump\-Merge\-Par}]{\setlength{\rightskip}{0pt plus 5cm}typedef std\-::map$<$pair$<$const {\bf Scattering\-Power}$\ast$, const {\bf Scattering\-Power}$\ast$$>$,{\bf Crystal\-::\-Bump\-Merge\-Par} $>$ {\bf Obj\-Cryst\-::\-Crystal\-::\-V\-Bump\-Merge\-Par}}\label{a00027_af57b44b799f164dbc86227f555a5eee5}


Anti-\/bump parameters. 

Each atom type (\doxyref{Scattering\-Power}{p.}{a00097} is referenced using a reference number) 

\subsubsection{Constructor \& Destructor Documentation}
\index{Obj\-Cryst\-::\-Crystal@{Obj\-Cryst\-::\-Crystal}!Crystal@{Crystal}}
\index{Crystal@{Crystal}!ObjCryst::Crystal@{Obj\-Cryst\-::\-Crystal}}
\paragraph[{Crystal}]{\setlength{\rightskip}{0pt plus 5cm}Obj\-Cryst\-::\-Crystal\-::\-Crystal (
\begin{DoxyParamCaption}
\item[{const R\-E\-A\-L}]{a, }
\item[{const R\-E\-A\-L}]{b, }
\item[{const R\-E\-A\-L}]{c, }
\item[{const string \&}]{Space\-Group\-Id}
\end{DoxyParamCaption}
)}\label{a00027_af4476f2fa29985667c19dc14dcc1efc9}


\doxyref{Crystal}{p.}{a00027} Constructor (orthorombic) 


\begin{DoxyParams}{Parameters}
{\em a,b,c} & \-: unit cell dimension, in angstroems \\
\hline
{\em Space\-Group\-Id,\-:} & space group symbol or number \\
\hline
\end{DoxyParams}
\index{Obj\-Cryst\-::\-Crystal@{Obj\-Cryst\-::\-Crystal}!Crystal@{Crystal}}
\index{Crystal@{Crystal}!ObjCryst::Crystal@{Obj\-Cryst\-::\-Crystal}}
\paragraph[{Crystal}]{\setlength{\rightskip}{0pt plus 5cm}Obj\-Cryst\-::\-Crystal\-::\-Crystal (
\begin{DoxyParamCaption}
\item[{const R\-E\-A\-L}]{a, }
\item[{const R\-E\-A\-L}]{b, }
\item[{const R\-E\-A\-L}]{c, }
\item[{const R\-E\-A\-L}]{alpha, }
\item[{const R\-E\-A\-L}]{beta, }
\item[{const R\-E\-A\-L}]{gamma, }
\item[{const string \&}]{Space\-Group\-Id}
\end{DoxyParamCaption}
)}\label{a00027_a5bb224d9b91463fb5748d76a2bcd6949}


\doxyref{Crystal}{p.}{a00027} Constructor (triclinic) 


\begin{DoxyParams}{Parameters}
{\em a,b,c} & \-: unit cell dimension, in angstroems \\
\hline
{\em alpha,beta,gamma} & \-: unit cell angles, in radians. \\
\hline
{\em Space\-Group\-Id,\-:} & space group symbol or number \\
\hline
\end{DoxyParams}


\subsubsection{Member Function Documentation}
\index{Obj\-Cryst\-::\-Crystal@{Obj\-Cryst\-::\-Crystal}!Add\-Scatterer@{Add\-Scatterer}}
\index{Add\-Scatterer@{Add\-Scatterer}!ObjCryst::Crystal@{Obj\-Cryst\-::\-Crystal}}
\paragraph[{Add\-Scatterer}]{\setlength{\rightskip}{0pt plus 5cm}void Obj\-Cryst\-::\-Crystal\-::\-Add\-Scatterer (
\begin{DoxyParamCaption}
\item[{{\bf Scatterer} $\ast$}]{scatt}
\end{DoxyParamCaption}
)}\label{a00027_acee480ad824aa0eedf78a4fa414cf347}


Add a scatterer to the crystal. 

\begin{DoxyWarning}{Warning}
the scatterer {\itshape must} be allocated in the heap, since the scatterer will {\itshape not} be copied but used directly. A \doxyref{Scatterer}{p.}{a00092} can only belong to one \doxyref{Crystal}{p.}{a00027}. It will be detroyed when removed or when the \doxyref{Crystal}{p.}{a00027} is destroyed. 
\end{DoxyWarning}

\begin{DoxyParams}{Parameters}
{\em scatt} & \-: the address of the scatterer to be included in the crystal scatterer names {\bfseries must} be unique in a given crystal. \\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
that the \doxyref{Scattering\-Power}{p.}{a00097} used in the \doxyref{Scatterer}{p.}{a00092} should be one of the \doxyref{Crystal}{p.}{a00027} (see \doxyref{Crystal\-::\-Add\-Scattering\-Power()}{p.}{a00027_a76d2d19234fbc5733f5c565a4bf9a1c7}) 
\end{DoxyNote}
\index{Obj\-Cryst\-::\-Crystal@{Obj\-Cryst\-::\-Crystal}!Add\-Scattering\-Power@{Add\-Scattering\-Power}}
\index{Add\-Scattering\-Power@{Add\-Scattering\-Power}!ObjCryst::Crystal@{Obj\-Cryst\-::\-Crystal}}
\paragraph[{Add\-Scattering\-Power}]{\setlength{\rightskip}{0pt plus 5cm}void Obj\-Cryst\-::\-Crystal\-::\-Add\-Scattering\-Power (
\begin{DoxyParamCaption}
\item[{{\bf Scattering\-Power} $\ast$}]{scatt\-Pow}
\end{DoxyParamCaption}
)}\label{a00027_a76d2d19234fbc5733f5c565a4bf9a1c7}


Add a \doxyref{Scattering\-Power}{p.}{a00097} for this \doxyref{Crystal}{p.}{a00027}. 

It must be allocated in the heap, and not used by any other \doxyref{Crystal}{p.}{a00027}. \index{Obj\-Cryst\-::\-Crystal@{Obj\-Cryst\-::\-Crystal}!Begin\-Optimization@{Begin\-Optimization}}
\index{Begin\-Optimization@{Begin\-Optimization}!ObjCryst::Crystal@{Obj\-Cryst\-::\-Crystal}}
\paragraph[{Begin\-Optimization}]{\setlength{\rightskip}{0pt plus 5cm}virtual void Obj\-Cryst\-::\-Crystal\-::\-Begin\-Optimization (
\begin{DoxyParamCaption}
\item[{const bool}]{allow\-Approximations = {\ttfamily false}, }
\item[{const bool}]{enable\-Restraints = {\ttfamily false}}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}\label{a00027_afe25ea6d287d6dd9cd0a03aed3798525}


This should be called by any optimization class at the begining of an optimization. 

This will also check that everything is ready, eg call the \doxyref{Refinable\-Obj\-::\-Prepare()}{p.}{a00078_a48d11671e7f8699f7bc24077585c5e0f} function. This also affects all sub-\/objects. \begin{DoxyNote}{Note}
this may be called several time for some objects which are used by several other objects, or for nested optimizations (e.\-g. least-\/squares optimizations inside a global one).

\doxyref{End\-Optimization()}{p.}{a00078_ab0035f6164cb24ace67b51b11993a851} must be called at the end of the optimization, the same number of time \doxyref{Begin\-Optimization()}{p.}{a00027_afe25ea6d287d6dd9cd0a03aed3798525} was called !
\end{DoxyNote}

\begin{DoxyParams}{Parameters}
{\em allow\-Approximations,\-:} & if true, then the object can use faster but less precise functions during the optimization. This is useful for global optimization not using derivatives. \\
\hline
{\em enable\-Restraints\-:\textbackslash{}xrefitem} & deprecated 28. \\
\hline
\end{DoxyParams}


Reimplemented from {\bf Obj\-Cryst\-::\-Refinable\-Obj} \doxyref{}{p.}{a00078_ababd8f2916e41a20d2c1b21f6ffefe96}.

\index{Obj\-Cryst\-::\-Crystal@{Obj\-Cryst\-::\-Crystal}!Calc\-Dist\-Table@{Calc\-Dist\-Table}}
\index{Calc\-Dist\-Table@{Calc\-Dist\-Table}!ObjCryst::Crystal@{Obj\-Cryst\-::\-Crystal}}
\paragraph[{Calc\-Dist\-Table}]{\setlength{\rightskip}{0pt plus 5cm}void Obj\-Cryst\-::\-Crystal\-::\-Calc\-Dist\-Table (
\begin{DoxyParamCaption}
\item[{const bool}]{fast}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [private]}}\label{a00027_a1d59955724fb598fbba3ff4c0bd125e3}


Compute the distance Table (m\-Dist\-Table) for all scattering components. 


\begin{DoxyParams}{Parameters}
{\em fast} & \-: if true, the distance calculations will be made using integers, thus with a lower precision but faster. Less atoms will also be involved (using the \doxyref{Asymmetric\-Unit}{p.}{a00014} and m\-Dist\-Table\-Max\-Distance2) to make it even faster.\\
\hline
\end{DoxyParams}
\begin{DoxyWarning}{Warning}
\doxyref{Crystal\-::\-Get\-Scattering\-Component\-List()}{p.}{a00027_a748d335480c372c5ef6cdf8716d9dd1a} {\bfseries must} be called beforehand, since this will not be done here.
\end{DoxyWarning}
\begin{DoxyReturn}{Returns}
see Crystal\-::m\-Dist\-Table\-Sq and Crystal\-::m\-Dist\-Table\-Index 
\end{DoxyReturn}
\begin{DoxyRefDesc}{Todo}
\item[{\bf Todo}]sanitize the result distance table in a more usable structure than the currently used Crystal\-::m\-Dist\-Table\-Sq and Crystal\-::m\-Dist\-Table\-Index. \end{DoxyRefDesc}
\begin{DoxyWarning}{Warning}
{\itshape not} using the fast option has not been very much tested... 
\end{DoxyWarning}
\begin{DoxyRefDesc}{Todo}
\item[{\bf Todo}]optimize again. Test if recomputation is needed using Clocks. Use a global option instead of asym\-Unit\-Margin. \end{DoxyRefDesc}
\index{Obj\-Cryst\-::\-Crystal@{Obj\-Cryst\-::\-Crystal}!Calc\-Dyn\-Pop\-Corr@{Calc\-Dyn\-Pop\-Corr}}
\index{Calc\-Dyn\-Pop\-Corr@{Calc\-Dyn\-Pop\-Corr}!ObjCryst::Crystal@{Obj\-Cryst\-::\-Crystal}}
\paragraph[{Calc\-Dyn\-Pop\-Corr}]{\setlength{\rightskip}{0pt plus 5cm}void Obj\-Cryst\-::\-Crystal\-::\-Calc\-Dyn\-Pop\-Corr (
\begin{DoxyParamCaption}
\item[{const R\-E\-A\-L}]{overlap\-Dist = {\ttfamily 1.}, }
\item[{const R\-E\-A\-L}]{merge\-Dist = {\ttfamily .0}}
\end{DoxyParamCaption}
) const}\label{a00027_a69975008974c9603ebb794bb6bb20fe8}


Compute the 'Dynamical population correction for all atoms. Atoms which are considered \char`\"{}equivalent\char`\"{} (ie currently with the same Z number) and which are overlapping see their Dynamical occupancy changed so that when they fully overlap, they are equivalent to 1 atom. 


\begin{DoxyParams}{Parameters}
{\em overlap\-Dist} & \-: distance below which atoms (Scattering\-Components, to be more precise) are considered overlapping and should be corrected. The correction changes the dynamical occupancy from 1 to 1/nb\-Atom\-Overlapping, progressively as the distance falls from {\itshape overlap\-Dist} to {\itshape merge\-Dist}. \\
\hline
{\em merge\-Dist} & \-: distance below which atoms are considered fully overlapping. If 3 atoms are 'fully' overlapping, then all have a dynamical population correction equal to 1/3\\
\hline
\end{DoxyParams}
This is const since \doxyref{Scattering\-Component\-::m\-Dyn\-Pop\-Corr}{p.}{a00093_a33af12bb3f340af259a8b8450f837efd} is mutable.

\begin{DoxyWarning}{Warning}
. Do not call this function, which will turn private. This is called by {\itshape only} \doxyref{Crystal\-::\-Get\-Scattering\-Component\-List()}{p.}{a00027_a748d335480c372c5ef6cdf8716d9dd1a} 
\end{DoxyWarning}
\index{Obj\-Cryst\-::\-Crystal@{Obj\-Cryst\-::\-Crystal}!C\-I\-F\-Output@{C\-I\-F\-Output}}
\index{C\-I\-F\-Output@{C\-I\-F\-Output}!ObjCryst::Crystal@{Obj\-Cryst\-::\-Crystal}}
\paragraph[{C\-I\-F\-Output}]{\setlength{\rightskip}{0pt plus 5cm}virtual void Obj\-Cryst\-::\-Crystal\-::\-C\-I\-F\-Output (
\begin{DoxyParamCaption}
\item[{ostream \&}]{os}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [virtual]}}\label{a00027_a7ed712a9735043d4c7a279e9779d563a}


output \doxyref{Crystal}{p.}{a00027} structure as a cif file (E\-X\-P\-E\-R\-I\-M\-E\-N\-T\-A\-L !) 

\begin{DoxyWarning}{Warning}
This is very crude and E\-X\-P\-E\-R\-I\-M\-E\-N\-T\-A\-L so far\-: only isotropic scattering power are supported, and there is not much information beside atom positions... 
\end{DoxyWarning}
\index{Obj\-Cryst\-::\-Crystal@{Obj\-Cryst\-::\-Crystal}!Find\-Scatterer@{Find\-Scatterer}}
\index{Find\-Scatterer@{Find\-Scatterer}!ObjCryst::Crystal@{Obj\-Cryst\-::\-Crystal}}
\paragraph[{Find\-Scatterer}]{\setlength{\rightskip}{0pt plus 5cm}int Obj\-Cryst\-::\-Crystal\-::\-Find\-Scatterer (
\begin{DoxyParamCaption}
\item[{const string \&}]{scatt\-Name}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [private]}}\label{a00027_a2e2b2c9b9bdf29de21fc885c8d25931a}


Find a scatterer (its index \# in mp\-Scatterrer[]) with a given name. 

\begin{DoxyWarning}{Warning}
There should be no duplicate names !!! \-:T\-O\-D\-O\-: test in \doxyref{Add\-Scatterer()}{p.}{a00027_acee480ad824aa0eedf78a4fa414cf347} 
\end{DoxyWarning}
\index{Obj\-Cryst\-::\-Crystal@{Obj\-Cryst\-::\-Crystal}!Get\-Bump\-Merge\-Cost@{Get\-Bump\-Merge\-Cost}}
\index{Get\-Bump\-Merge\-Cost@{Get\-Bump\-Merge\-Cost}!ObjCryst::Crystal@{Obj\-Cryst\-::\-Crystal}}
\paragraph[{Get\-Bump\-Merge\-Cost}]{\setlength{\rightskip}{0pt plus 5cm}R\-E\-A\-L Obj\-Cryst\-::\-Crystal\-::\-Get\-Bump\-Merge\-Cost (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const}\label{a00027_a4206c09ce323f74534fec77eb29dc246}


Get the Anti-\/bumping/pro-\/\-Merging cost function. 

Only works (ie returnes a non-\/null value) if you have added antibump distances using \doxyref{Crystal\-::\-Set\-Bump\-Merge\-Distance()}{p.}{a00027_ad77bfe72588a64e306a5514535ed7404}. \index{Obj\-Cryst\-::\-Crystal@{Obj\-Cryst\-::\-Crystal}!Get\-Class\-Name@{Get\-Class\-Name}}
\index{Get\-Class\-Name@{Get\-Class\-Name}!ObjCryst::Crystal@{Obj\-Cryst\-::\-Crystal}}
\paragraph[{Get\-Class\-Name}]{\setlength{\rightskip}{0pt plus 5cm}virtual const string\& Obj\-Cryst\-::\-Crystal\-::\-Get\-Class\-Name (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [virtual]}}\label{a00027_ad1f69a5fb8981a2cf0eeb6245728af6d}


Name for this class (\char`\"{}\-Refinable\-Obj\char`\"{}, \char`\"{}\-Crystal\char`\"{},...). 

This is only useful to distinguish different classes when picking up objects from the \doxyref{Refinable\-Obj}{p.}{a00078} Global Registry 

Reimplemented from {\bf Obj\-Cryst\-::\-Unit\-Cell} \doxyref{}{p.}{a00117_ac3b3c2e007083bf6f329eb11a6b610d1}.

\index{Obj\-Cryst\-::\-Crystal@{Obj\-Cryst\-::\-Crystal}!Get\-Gene\-Group@{Get\-Gene\-Group}}
\index{Get\-Gene\-Group@{Get\-Gene\-Group}!ObjCryst::Crystal@{Obj\-Cryst\-::\-Crystal}}
\paragraph[{Get\-Gene\-Group}]{\setlength{\rightskip}{0pt plus 5cm}virtual void Obj\-Cryst\-::\-Crystal\-::\-Get\-Gene\-Group (
\begin{DoxyParamCaption}
\item[{const {\bf Refinable\-Obj} \&}]{obj, }
\item[{Cryst\-Vector\-\_\-uint \&}]{group\-Index, }
\item[{unsigned int \&}]{first\-Group}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [virtual]}}\label{a00027_afcef6e251265ddf23657fe10b0cd4912}


Get the gene group assigned to each parameter. 

Each parameter (a {\itshape gene} in terms of genetic algorithms) can be assigned to a gene group. Thus when mating two configurations, genes will be exchanged by groups. By default (in the base Refinabe\-Obj class), each parameter is alone in its group. Derived classes can group genes for a better s$\ast$$\ast$ life.

The number identifying a gene group only has a meaning in a given object. It can also change on subsequent calls, and thus is not unique.


\begin{DoxyParams}{Parameters}
{\em obj} & the , supplied by an algorithm class (\doxyref{Optimization\-Obj}{p.}{a00062},..), which contains a list of parameters, some of which (but possibly all or none) are parameters belonging to this object. \\
\hline
{\em group\-Index} & a vector of unsigned integers, one for each parameter in the input object, giving an unsigned integer value as gene group index. At the beginning this vector should contain only zeros (no group assigned). \\
\hline
{\em first\-Group} & this is the number of groups which have already been assigned, plus one. The gene groups returned by this object will start from this value, and increment {\bfseries first\-Group} for each gene group used, so that different \doxyref{Refinable\-Obj}{p.}{a00078} cannot share a gene group. \\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
this function is not optimized, and should only be called at the beginning of a refinement. 
\end{DoxyNote}


Reimplemented from {\bf Obj\-Cryst\-::\-Refinable\-Obj} \doxyref{}{p.}{a00078_ad59c8ad2b0d7ee59fa3f399a54f05e54}.

\index{Obj\-Cryst\-::\-Crystal@{Obj\-Cryst\-::\-Crystal}!Get\-Log\-Likelihood@{Get\-Log\-Likelihood}}
\index{Get\-Log\-Likelihood@{Get\-Log\-Likelihood}!ObjCryst::Crystal@{Obj\-Cryst\-::\-Crystal}}
\paragraph[{Get\-Log\-Likelihood}]{\setlength{\rightskip}{0pt plus 5cm}virtual R\-E\-A\-L Obj\-Cryst\-::\-Crystal\-::\-Get\-Log\-Likelihood (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [virtual]}}\label{a00027_a6f10c5a30864b9699b313f90b646138f}


Get -\/log(likelihood) of the current configuration for the object. 

By default (no likelihood evaluation available), this is equal to 0.

This call should not be recursive, it is the task of the algorithm to get the sum of likelihoods for all objects invlolved.

\begin{DoxyNote}{Note}
contrary to the old \char`\"{}\-Cost Function\char`\"{} approach, with log(\-Likelihood) there is no 'choice' of cost function, so that it is the task of the object to give the optimized likelihood (possibly with user options).
\end{DoxyNote}
\begin{DoxyWarning}{Warning}
\-: this is in under heavy development, so expect changes... 
\end{DoxyWarning}


Reimplemented from {\bf Obj\-Cryst\-::\-Refinable\-Obj} \doxyref{}{p.}{a00078_a9a9a5ea2b997cd36b44ed35c2bab3245}.

\index{Obj\-Cryst\-::\-Crystal@{Obj\-Cryst\-::\-Crystal}!Get\-Min\-Distance\-Table@{Get\-Min\-Distance\-Table}}
\index{Get\-Min\-Distance\-Table@{Get\-Min\-Distance\-Table}!ObjCryst::Crystal@{Obj\-Cryst\-::\-Crystal}}
\paragraph[{Get\-Min\-Distance\-Table}]{\setlength{\rightskip}{0pt plus 5cm}Cryst\-Matrix\-\_\-\-R\-E\-A\-L Obj\-Cryst\-::\-Crystal\-::\-Get\-Min\-Distance\-Table (
\begin{DoxyParamCaption}
\item[{const R\-E\-A\-L}]{min\-Distance = {\ttfamily 0.1}}
\end{DoxyParamCaption}
) const}\label{a00027_ae9f3f6ba4945942bda42af5150ed2948}


Minimum interatomic distance between all scattering components (atoms) in the crystal. 

This will return a symmetrical matrix with Nb\-Comp rows and cols, where Nb\-Comp is the number of independent scattering components in the unit cell. All distances are given in Angstroems.

Note that the distance of a given atom with 'itself' is not generally equal to 0 (except full special position), but equal to the min distance with its symmetrics.


\begin{DoxyParams}{Parameters}
{\em min\-Distance} & \-: atoms who are less distant than (min\-Distance,in Angstroems) are considered equivalent. So the smallest distance between any atoms will be at least min\-Distance. \\
\hline
\end{DoxyParams}
\index{Obj\-Cryst\-::\-Crystal@{Obj\-Cryst\-::\-Crystal}!Get\-Scatt@{Get\-Scatt}}
\index{Get\-Scatt@{Get\-Scatt}!ObjCryst::Crystal@{Obj\-Cryst\-::\-Crystal}}
\paragraph[{Get\-Scatt}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Scatterer}\& Obj\-Cryst\-::\-Crystal\-::\-Get\-Scatt (
\begin{DoxyParamCaption}
\item[{const string \&}]{scatt\-Name}
\end{DoxyParamCaption}
)}\label{a00027_a19bb22e923b0155d6de0f7585d467e51}


Provides an access to the scatterers. 


\begin{DoxyParams}{Parameters}
{\em scatt\-Name} & the name of the scatterer to access \\
\hline
\end{DoxyParams}
\index{Obj\-Cryst\-::\-Crystal@{Obj\-Cryst\-::\-Crystal}!Get\-Scatt@{Get\-Scatt}}
\index{Get\-Scatt@{Get\-Scatt}!ObjCryst::Crystal@{Obj\-Cryst\-::\-Crystal}}
\paragraph[{Get\-Scatt}]{\setlength{\rightskip}{0pt plus 5cm}const {\bf Scatterer}\& Obj\-Cryst\-::\-Crystal\-::\-Get\-Scatt (
\begin{DoxyParamCaption}
\item[{const string \&}]{scatt\-Name}
\end{DoxyParamCaption}
) const}\label{a00027_aaf80c4ddd329baf30d4391e37e8b40f5}


Provides a const access to the scatterers. 


\begin{DoxyParams}{Parameters}
{\em scatt\-Name} & the name of the scatterer to access \\
\hline
\end{DoxyParams}
\index{Obj\-Cryst\-::\-Crystal@{Obj\-Cryst\-::\-Crystal}!Get\-Scatt@{Get\-Scatt}}
\index{Get\-Scatt@{Get\-Scatt}!ObjCryst::Crystal@{Obj\-Cryst\-::\-Crystal}}
\paragraph[{Get\-Scatt}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Scatterer}\& Obj\-Cryst\-::\-Crystal\-::\-Get\-Scatt (
\begin{DoxyParamCaption}
\item[{const long}]{scatt\-Index}
\end{DoxyParamCaption}
)}\label{a00027_a4cebd2f318d525d2850c713a43d4dc4d}


Provides an access to the scatterers. 


\begin{DoxyParams}{Parameters}
{\em scatt\-Index} & the number of the scatterer to access \\
\hline
\end{DoxyParams}
\index{Obj\-Cryst\-::\-Crystal@{Obj\-Cryst\-::\-Crystal}!Get\-Scatt@{Get\-Scatt}}
\index{Get\-Scatt@{Get\-Scatt}!ObjCryst::Crystal@{Obj\-Cryst\-::\-Crystal}}
\paragraph[{Get\-Scatt}]{\setlength{\rightskip}{0pt plus 5cm}const {\bf Scatterer}\& Obj\-Cryst\-::\-Crystal\-::\-Get\-Scatt (
\begin{DoxyParamCaption}
\item[{const long}]{scatt\-Index}
\end{DoxyParamCaption}
) const}\label{a00027_a2c5648ab7734b0d865869ea2ee3a8256}


Provides a const access to the scatterers. 


\begin{DoxyParams}{Parameters}
{\em scatt\-Index} & the number of the scatterer to access \\
\hline
\end{DoxyParams}
\index{Obj\-Cryst\-::\-Crystal@{Obj\-Cryst\-::\-Crystal}!G\-L\-Init\-Display\-List@{G\-L\-Init\-Display\-List}}
\index{G\-L\-Init\-Display\-List@{G\-L\-Init\-Display\-List}!ObjCryst::Crystal@{Obj\-Cryst\-::\-Crystal}}
\paragraph[{G\-L\-Init\-Display\-List}]{\setlength{\rightskip}{0pt plus 5cm}virtual void Obj\-Cryst\-::\-Crystal\-::\-G\-L\-Init\-Display\-List (
\begin{DoxyParamCaption}
\item[{const bool}]{only\-Independent\-Atoms = {\ttfamily false}, }
\item[{const R\-E\-A\-L}]{x\-Min = {\ttfamily -\/.1}, }
\item[{const R\-E\-A\-L}]{x\-Max = {\ttfamily 1.1}, }
\item[{const R\-E\-A\-L}]{y\-Min = {\ttfamily -\/.1}, }
\item[{const R\-E\-A\-L}]{y\-Max = {\ttfamily 1.1}, }
\item[{const R\-E\-A\-L}]{z\-Min = {\ttfamily -\/.1}, }
\item[{const R\-E\-A\-L}]{z\-Max = {\ttfamily 1.1}, }
\item[{const bool}]{display\-Names = {\ttfamily false}}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [virtual]}}\label{a00027_af63e9925212657a2912d59c2f8c2d34c}


Create an Open\-G\-L Display\-List of the crystal. 


\begin{DoxyParams}{Parameters}
{\em only\-Independent\-Atoms} & if false (the default), then all symmetrics are displayed within the given limits \textbackslash{} param x\-Min,x\-Max,y\-Min,y\-Max,z\-Min,z\-Max\-: in fractionnal coordinates, the region in which we want scaterrers to be displayed. The test is made on the center of the scatterer (eg a \doxyref{Z\-Scatterer}{p.}{a00163} (molecule) will not be 'cut' on the border). \\
\hline
{\em display\-Names,\-:} & if true, only the names of the scatterers will be displayed, at the position of the scatterers (to actually see them, they will have to be translated with respect to the drawing of the scatterers). \\
\hline
\end{DoxyParams}
\index{Obj\-Cryst\-::\-Crystal@{Obj\-Cryst\-::\-Crystal}!Global\-Opt\-Random\-Move@{Global\-Opt\-Random\-Move}}
\index{Global\-Opt\-Random\-Move@{Global\-Opt\-Random\-Move}!ObjCryst::Crystal@{Obj\-Cryst\-::\-Crystal}}
\paragraph[{Global\-Opt\-Random\-Move}]{\setlength{\rightskip}{0pt plus 5cm}virtual void Obj\-Cryst\-::\-Crystal\-::\-Global\-Opt\-Random\-Move (
\begin{DoxyParamCaption}
\item[{const R\-E\-A\-L}]{mutation\-Amplitude, }
\item[{const {\bf Ref\-Par\-Type} $\ast$}]{type = {\ttfamily {\bf gp\-Ref\-Par\-Type\-Obj\-Cryst}}}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}\label{a00027_ab6a8a2cc28f3b1cde012754a19c279de}


Make a random move of the current configuration. 

This is for global optimization algorithms. the moves for each parameter are less than their global optimization step, multiplied by the mutation amplitude.

\begin{DoxyWarning}{Warning}
\-: this makes a random move for the parameter declared for this object, and it is the duty of the object to decide whether the included objects should be moved and how. (eg an algorithm should only call for a move with the top object, and this object decides how he and his sub-\/objects moves). By default (\doxyref{Refinable\-Obj}{p.}{a00078} implementation) all included objects are moved recursively.
\end{DoxyWarning}
\doxyref{Refinable\-Obj}{p.}{a00078}\-:\-: 
\begin{DoxyParams}{Parameters}
{\em mutation\-Amplitude,\-:} & multiplier for the maximum move amplitude, for all parameters \\
\hline
{\em type,\-:} & restrain the change exclusively to parameters of a given type (same type or descendant from this \doxyref{Ref\-Par\-Type}{p.}{a00087}). \\
\hline
\end{DoxyParams}


Reimplemented from {\bf Obj\-Cryst\-::\-Refinable\-Obj} \doxyref{}{p.}{a00078_a18375c8525ae38c481ba77e9cf9d67c1}.

\index{Obj\-Cryst\-::\-Crystal@{Obj\-Cryst\-::\-Crystal}!Init@{Init}}
\index{Init@{Init}!ObjCryst::Crystal@{Obj\-Cryst\-::\-Crystal}}
\paragraph[{Init}]{\setlength{\rightskip}{0pt plus 5cm}void Obj\-Cryst\-::\-Crystal\-::\-Init (
\begin{DoxyParamCaption}
\item[{const R\-E\-A\-L}]{a, }
\item[{const R\-E\-A\-L}]{b, }
\item[{const R\-E\-A\-L}]{c, }
\item[{const R\-E\-A\-L}]{alpha, }
\item[{const R\-E\-A\-L}]{beta, }
\item[{const R\-E\-A\-L}]{gamma, }
\item[{const string \&}]{Space\-Group\-Id, }
\item[{const string \&}]{name}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}\label{a00027_aefcd0d1032e5b93de47b4b93d530ed5b}


Init all \doxyref{Crystal}{p.}{a00027} parameters. 


\begin{DoxyParams}{Parameters}
{\em a,b,c} & \-: unit cell dimension, in angstroems \\
\hline
{\em alpha,beta,gamma} & \-: unit cell angles \\
\hline
{\em Spc\-Group,\-:} & space group number (1..230) \\
\hline
{\em name,\-:} & name for the crystal, \-: '(Ta\-Se4)2\-I' \\
\hline
\end{DoxyParams}


Reimplemented from {\bf Obj\-Cryst\-::\-Unit\-Cell} \doxyref{}{p.}{a00117_a6a98cc147e6b4471d30ff6b736c95e42}.

\index{Obj\-Cryst\-::\-Crystal@{Obj\-Cryst\-::\-Crystal}!Init\-Options@{Init\-Options}}
\index{Init\-Options@{Init\-Options}!ObjCryst::Crystal@{Obj\-Cryst\-::\-Crystal}}
\paragraph[{Init\-Options}]{\setlength{\rightskip}{0pt plus 5cm}void Obj\-Cryst\-::\-Crystal\-::\-Init\-Options (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}, {\ttfamily [virtual]}}\label{a00027_a6f824ecc64553f3b3d15d0db9bf5982d}


Init options. 

Need only be done once per \doxyref{Crystal}{p.}{a00027}. 

Reimplemented from {\bf Obj\-Cryst\-::\-Unit\-Cell} \doxyref{}{p.}{a00117_a12460955ce7bb73812c3f3f798d8bfd8}.

\index{Obj\-Cryst\-::\-Crystal@{Obj\-Cryst\-::\-Crystal}!P\-O\-V\-Ray\-Description@{P\-O\-V\-Ray\-Description}}
\index{P\-O\-V\-Ray\-Description@{P\-O\-V\-Ray\-Description}!ObjCryst::Crystal@{Obj\-Cryst\-::\-Crystal}}
\paragraph[{P\-O\-V\-Ray\-Description}]{\setlength{\rightskip}{0pt plus 5cm}ostream\& Obj\-Cryst\-::\-Crystal\-::\-P\-O\-V\-Ray\-Description (
\begin{DoxyParamCaption}
\item[{ostream \&}]{os, }
\item[{const {\bf Crystal\-P\-O\-V\-Ray\-Options} \&}]{options}
\end{DoxyParamCaption}
) const}\label{a00027_a925f91bd3da4c189bc288047454bb864}


X\-M\-L\-Output P\-O\-V-\/\-Ray Description for this \doxyref{Crystal}{p.}{a00027}. 


\begin{DoxyParams}{Parameters}
{\em only\-Independent\-Atoms} & if false, all symmetrics are showed in the drawing.\\
\hline
\end{DoxyParams}
\begin{DoxyWarning}{Warning}
This currently needs some fixing (\doxyref{Z\-Scatterer}{p.}{a00163} does not work ?) Use rather the Open\-G\-L 3\-D display which is more useful.
\end{DoxyWarning}

\begin{DoxyParams}{Parameters}
{\em os} & the stream to which the information is outputed (default=cout) \\
\hline
\end{DoxyParams}
\index{Obj\-Cryst\-::\-Crystal@{Obj\-Cryst\-::\-Crystal}!Print@{Print}}
\index{Print@{Print}!ObjCryst::Crystal@{Obj\-Cryst\-::\-Crystal}}
\paragraph[{Print}]{\setlength{\rightskip}{0pt plus 5cm}void Obj\-Cryst\-::\-Crystal\-::\-Print (
\begin{DoxyParamCaption}
\item[{ostream \&}]{os = {\ttfamily cout}}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [virtual]}}\label{a00027_ac4a7086d3757be4bbe2484f549a1b0fc}


Prints some info about the crystal. 

\begin{DoxyRefDesc}{Todo}
\item[{\bf Todo}]one function to print on one line and a Print\-Long() function \end{DoxyRefDesc}

\begin{DoxyParams}{Parameters}
{\em os} & the stream to which the information is outputed (default=cout) \\
\hline
\end{DoxyParams}


Reimplemented from {\bf Obj\-Cryst\-::\-Unit\-Cell} \doxyref{}{p.}{a00117_adf564cd9521473be30d073d1660fa3ee}.

\index{Obj\-Cryst\-::\-Crystal@{Obj\-Cryst\-::\-Crystal}!Print\-Min\-Distance\-Table@{Print\-Min\-Distance\-Table}}
\index{Print\-Min\-Distance\-Table@{Print\-Min\-Distance\-Table}!ObjCryst::Crystal@{Obj\-Cryst\-::\-Crystal}}
\paragraph[{Print\-Min\-Distance\-Table}]{\setlength{\rightskip}{0pt plus 5cm}void Obj\-Cryst\-::\-Crystal\-::\-Print\-Min\-Distance\-Table (
\begin{DoxyParamCaption}
\item[{const R\-E\-A\-L}]{min\-Distance = {\ttfamily 0.1}, }
\item[{ostream \&}]{os = {\ttfamily cout}}
\end{DoxyParamCaption}
) const}\label{a00027_a152d60cb30353b9a54ad34e291f4b6f3}


Print the minimum distance table between all scattering centers (atoms) in the crystal. 


\begin{DoxyParams}{Parameters}
{\em os} & the stream to which the information is outputed (default=cout) \\
\hline
\end{DoxyParams}
\index{Obj\-Cryst\-::\-Crystal@{Obj\-Cryst\-::\-Crystal}!Remove\-Scattering\-Power@{Remove\-Scattering\-Power}}
\index{Remove\-Scattering\-Power@{Remove\-Scattering\-Power}!ObjCryst::Crystal@{Obj\-Cryst\-::\-Crystal}}
\paragraph[{Remove\-Scattering\-Power}]{\setlength{\rightskip}{0pt plus 5cm}void Obj\-Cryst\-::\-Crystal\-::\-Remove\-Scattering\-Power (
\begin{DoxyParamCaption}
\item[{{\bf Scattering\-Power} $\ast$}]{scatt\-Pow, }
\item[{const bool}]{del = {\ttfamily true}}
\end{DoxyParamCaption}
)}\label{a00027_aba839003a614634d7d6d9217379ae692}


Remove a \doxyref{Scattering\-Power}{p.}{a00097} for this \doxyref{Crystal}{p.}{a00027}. 

(the Scattering power is deleted unless del=false). This function should check that it is not used any more before removing it. \index{Obj\-Cryst\-::\-Crystal@{Obj\-Cryst\-::\-Crystal}!Set\-Bump\-Merge\-Distance@{Set\-Bump\-Merge\-Distance}}
\index{Set\-Bump\-Merge\-Distance@{Set\-Bump\-Merge\-Distance}!ObjCryst::Crystal@{Obj\-Cryst\-::\-Crystal}}
\paragraph[{Set\-Bump\-Merge\-Distance}]{\setlength{\rightskip}{0pt plus 5cm}void Obj\-Cryst\-::\-Crystal\-::\-Set\-Bump\-Merge\-Distance (
\begin{DoxyParamCaption}
\item[{const {\bf Scattering\-Power} \&}]{scatt1, }
\item[{const {\bf Scattering\-Power} \&}]{scatt2, }
\item[{const R\-E\-A\-L}]{dist = {\ttfamily 1.5}}
\end{DoxyParamCaption}
)}\label{a00027_ad77bfe72588a64e306a5514535ed7404}


Set the Anti-\/bumping distance between two scattering types. 

\index{Obj\-Cryst\-::\-Crystal@{Obj\-Cryst\-::\-Crystal}!Set\-Delete\-Sub\-Obj\-In\-Destructor@{Set\-Delete\-Sub\-Obj\-In\-Destructor}}
\index{Set\-Delete\-Sub\-Obj\-In\-Destructor@{Set\-Delete\-Sub\-Obj\-In\-Destructor}!ObjCryst::Crystal@{Obj\-Cryst\-::\-Crystal}}
\paragraph[{Set\-Delete\-Sub\-Obj\-In\-Destructor}]{\setlength{\rightskip}{0pt plus 5cm}void Obj\-Cryst\-::\-Crystal\-::\-Set\-Delete\-Sub\-Obj\-In\-Destructor (
\begin{DoxyParamCaption}
\item[{const bool}]{b}
\end{DoxyParamCaption}
)}\label{a00027_ae976f94ba642aa81cb7b23fcc1a56028}


Set whether to delete the Scatterers and Scattering\-Powers in the destructor. 

By default these sub-\/objects are deleted. \index{Obj\-Cryst\-::\-Crystal@{Obj\-Cryst\-::\-Crystal}!Set\-Use\-Dyn\-Pop\-Corr@{Set\-Use\-Dyn\-Pop\-Corr}}
\index{Set\-Use\-Dyn\-Pop\-Corr@{Set\-Use\-Dyn\-Pop\-Corr}!ObjCryst::Crystal@{Obj\-Cryst\-::\-Crystal}}
\paragraph[{Set\-Use\-Dyn\-Pop\-Corr}]{\setlength{\rightskip}{0pt plus 5cm}void Obj\-Cryst\-::\-Crystal\-::\-Set\-Use\-Dyn\-Pop\-Corr (
\begin{DoxyParamCaption}
\item[{const int}]{use}
\end{DoxyParamCaption}
)}\label{a00027_a511c3fcea43446634232eb6df345db9d}


Set the use of dynamical population correction (\doxyref{Crystal\-::m\-Use\-Dyn\-Pop\-Corr}{p.}{a00027_aa75ade2fea9a50b3e6fb08773f607a13}). 

Atoms which are considered \char`\"{}equivalent\char`\"{} (ie currently with the same Z number) and which are overlapping see their Dynamical occupancy changed so that when they fully overlap, they are equivalent to 1 atom.

The Dynamical Occupancy correction will be performed in \doxyref{Crystal\-::\-Get\-Scattering\-Component\-List()}{p.}{a00027_a748d335480c372c5ef6cdf8716d9dd1a} automatically.

This {\itshape seriously} affects the speed of the calculation, since computing interatomic distances is lenghty. 
\begin{DoxyParams}{Parameters}
{\em use} & set to 1 to use, 0 not to use it. \\
\hline
\end{DoxyParams}
\index{Obj\-Cryst\-::\-Crystal@{Obj\-Cryst\-::\-Crystal}!X\-M\-L\-Input@{X\-M\-L\-Input}}
\index{X\-M\-L\-Input@{X\-M\-L\-Input}!ObjCryst::Crystal@{Obj\-Cryst\-::\-Crystal}}
\paragraph[{X\-M\-L\-Input}]{\setlength{\rightskip}{0pt plus 5cm}virtual void Obj\-Cryst\-::\-Crystal\-::\-X\-M\-L\-Input (
\begin{DoxyParamCaption}
\item[{istream \&}]{is, }
\item[{const {\bf X\-M\-L\-Cryst\-Tag} \&}]{tag}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}\label{a00027_accc77bfc6df977685c01a43d150a8ba7}


Input From stream. 

\begin{DoxyRefDesc}{Todo}
\item[{\bf Todo}]Add an bool X\-M\-L\-Input\-Tag(is,tag) function to recognize all the tags from the stream. So that each inherited class can use the X\-M\-L\-Input\-Tag function from its parent (ie take advantage of inheritance). The children class would first try to interpret the tag, then if unsuccessful would pass it to its parent (thus allowing overloading), etc... \end{DoxyRefDesc}


Reimplemented from {\bf Obj\-Cryst\-::\-Refinable\-Obj} \doxyref{}{p.}{a00078_ac13a4045c3f187879443c8615c38d623}.

\index{Obj\-Cryst\-::\-Crystal@{Obj\-Cryst\-::\-Crystal}!X\-M\-L\-Output@{X\-M\-L\-Output}}
\index{X\-M\-L\-Output@{X\-M\-L\-Output}!ObjCryst::Crystal@{Obj\-Cryst\-::\-Crystal}}
\paragraph[{X\-M\-L\-Output}]{\setlength{\rightskip}{0pt plus 5cm}virtual void Obj\-Cryst\-::\-Crystal\-::\-X\-M\-L\-Output (
\begin{DoxyParamCaption}
\item[{ostream \&}]{os, }
\item[{int}]{indent = {\ttfamily 0}}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [virtual]}}\label{a00027_a037f8ea8c5dceece1044ce73d542a0e4}


Output to stream in well-\/formed X\-M\-L. 

\begin{DoxyRefDesc}{Todo}
\item[{\bf Todo}]Use inheritance.. as for X\-M\-L\-Input\-Tag()... \end{DoxyRefDesc}


Reimplemented from {\bf Obj\-Cryst\-::\-Refinable\-Obj} \doxyref{}{p.}{a00078_a7b9b6ed0f8dcf753d398c35e073de973}.



\subsubsection{Member Data Documentation}
\index{Obj\-Cryst\-::\-Crystal@{Obj\-Cryst\-::\-Crystal}!m\-Clock\-Dyn\-Pop\-Corr@{m\-Clock\-Dyn\-Pop\-Corr}}
\index{m\-Clock\-Dyn\-Pop\-Corr@{m\-Clock\-Dyn\-Pop\-Corr}!ObjCryst::Crystal@{Obj\-Cryst\-::\-Crystal}}
\paragraph[{m\-Clock\-Dyn\-Pop\-Corr}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Refinable\-Obj\-Clock} Obj\-Cryst\-::\-Crystal\-::m\-Clock\-Dyn\-Pop\-Corr\hspace{0.3cm}{\ttfamily [mutable]}, {\ttfamily [private]}}\label{a00027_a23a42c8aacd3c5525d92dfddf4dff73d}
Last time the dynamical population correction was computed \index{Obj\-Cryst\-::\-Crystal@{Obj\-Cryst\-::\-Crystal}!m\-Clock\-Neighbor\-Table@{m\-Clock\-Neighbor\-Table}}
\index{m\-Clock\-Neighbor\-Table@{m\-Clock\-Neighbor\-Table}!ObjCryst::Crystal@{Obj\-Cryst\-::\-Crystal}}
\paragraph[{m\-Clock\-Neighbor\-Table}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Refinable\-Obj\-Clock} Obj\-Cryst\-::\-Crystal\-::m\-Clock\-Neighbor\-Table\hspace{0.3cm}{\ttfamily [mutable]}, {\ttfamily [private]}}\label{a00027_a87859e98018e0e7a0d71a8e69419d687}
Last time the Neighbor Table was generated \index{Obj\-Cryst\-::\-Crystal@{Obj\-Cryst\-::\-Crystal}!m\-Clock\-Scatt\-Comp\-List@{m\-Clock\-Scatt\-Comp\-List}}
\index{m\-Clock\-Scatt\-Comp\-List@{m\-Clock\-Scatt\-Comp\-List}!ObjCryst::Crystal@{Obj\-Cryst\-::\-Crystal}}
\paragraph[{m\-Clock\-Scatt\-Comp\-List}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Refinable\-Obj\-Clock} Obj\-Cryst\-::\-Crystal\-::m\-Clock\-Scatt\-Comp\-List\hspace{0.3cm}{\ttfamily [mutable]}, {\ttfamily [private]}}\label{a00027_ac2a8728c253bf1a5f1f9dfa0b8fd1cc5}
Last time the \doxyref{Scattering\-Component\-List}{p.}{a00094} was generated \index{Obj\-Cryst\-::\-Crystal@{Obj\-Cryst\-::\-Crystal}!m\-Display\-Enantiomer@{m\-Display\-Enantiomer}}
\index{m\-Display\-Enantiomer@{m\-Display\-Enantiomer}!ObjCryst::Crystal@{Obj\-Cryst\-::\-Crystal}}
\paragraph[{m\-Display\-Enantiomer}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Ref\-Obj\-Opt} Obj\-Cryst\-::\-Crystal\-::m\-Display\-Enantiomer\hspace{0.3cm}{\ttfamily [private]}}\label{a00027_ab0bedeb759e922842d3b2cd1eda9d688}


Display the enantiomeric (mirror along x) structure in 3\-D? This can be helpful for non-\/centrosymmetric structure which have been solved using powder diffraction (which only gives the relative configuration). 

\index{Obj\-Cryst\-::\-Crystal@{Obj\-Cryst\-::\-Crystal}!mv\-Bond\-Valence\-Calc@{mv\-Bond\-Valence\-Calc}}
\index{mv\-Bond\-Valence\-Calc@{mv\-Bond\-Valence\-Calc}!ObjCryst::Crystal@{Obj\-Cryst\-::\-Crystal}}
\paragraph[{mv\-Bond\-Valence\-Calc}]{\setlength{\rightskip}{0pt plus 5cm}std\-::map$<$long, R\-E\-A\-L$>$ Obj\-Cryst\-::\-Crystal\-::mv\-Bond\-Valence\-Calc\hspace{0.3cm}{\ttfamily [mutable]}, {\ttfamily [private]}}\label{a00027_a4be1212d5e9145c9e16cb8e4b9f3501a}


List of calculated bond valences, as a map, the key being the index of the atom in \doxyref{Crystal\-::m\-Scatt\-Comp\-List}{p.}{a00027_a2f45b59533a1a3114391aa04e7017bf8}. 

\index{Obj\-Cryst\-::\-Crystal@{Obj\-Cryst\-::\-Crystal}!mv\-Dist\-Table\-Sq@{mv\-Dist\-Table\-Sq}}
\index{mv\-Dist\-Table\-Sq@{mv\-Dist\-Table\-Sq}!ObjCryst::Crystal@{Obj\-Cryst\-::\-Crystal}}
\paragraph[{mv\-Dist\-Table\-Sq}]{\setlength{\rightskip}{0pt plus 5cm}std\-::vector$<${\bf Neighbour\-Hood}$>$ Obj\-Cryst\-::\-Crystal\-::mv\-Dist\-Table\-Sq\hspace{0.3cm}{\ttfamily [mutable]}, {\ttfamily [private]}}\label{a00027_a91cbd823da6f8d82a693b24b5f4b42f0}


Interatomic distance table for all unique atoms. 



The documentation for this class was generated from the following file\-:\begin{DoxyCompactItemize}
\item 
Crystal.\-h\end{DoxyCompactItemize}
