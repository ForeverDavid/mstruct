\subsection{ObjCryst::Atom Class Reference}
\label{a00008}\index{ObjCryst::Atom@{ObjCryst::Atom}}


The basic atom scatterer, in a crystal.  
Inheritance diagram for ObjCryst::Atom::\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=3cm]{a00008}
\end{center}
\end{figure}
\subsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
{\bf Atom} ()
\begin{DoxyCompactList}\small\item\em Default constructor. \item\end{DoxyCompactList}\item 
{\bf Atom} (const REAL x, const REAL y, const REAL z, const string \&name, const {\bf ScatteringPower} $\ast$pow)
\begin{DoxyCompactList}\small\item\em \doxyref{Atom}{p.}{a00008} constructor. \item\end{DoxyCompactList}\item 
{\bf Atom} (const REAL x, const REAL y, const REAL z, const string \&name, const {\bf ScatteringPower} $\ast$pow, const REAL popu)
\begin{DoxyCompactList}\small\item\em \doxyref{Atom}{p.}{a00008} constructor. \item\end{DoxyCompactList}\item 
{\bf Atom} (const {\bf Atom} \&old)\label{a00008_a4882db30ef33e70582b354db8e76a07c}

\begin{DoxyCompactList}\small\item\em Copy constructor. \item\end{DoxyCompactList}\item 
virtual {\bf Atom} $\ast$ {\bf CreateCopy} () const 
\item 
{\bf $\sim$Atom} ()\label{a00008_a86039a28098c9b48e7f4f57636a7e55d}

\begin{DoxyCompactList}\small\item\em Destructor... \item\end{DoxyCompactList}\item 
virtual const string \& {\bf GetClassName} () const 
\begin{DoxyCompactList}\small\item\em Name for this class (\char`\"{}RefinableObj\char`\"{}, \char`\"{}Crystal\char`\"{},. \item\end{DoxyCompactList}\item 
virtual void {\bfseries operator=} (const {\bf Atom} \&rhs)\label{a00008_afc87e2009e5a0ad02311ff072b4f3b3e}

\item 
void {\bf Init} (const REAL x, const REAL y, const REAL z, const string \&name, const {\bf ScatteringPower} $\ast$pow, const REAL popu=1)
\begin{DoxyCompactList}\small\item\em initialize the atom (used for arrays of atoms). \item\end{DoxyCompactList}\item 
virtual int {\bf GetNbComponent} () const \label{a00008_a7739a016c88ab32355e67b1c03fe97f0}

\begin{DoxyCompactList}\small\item\em Number of components in the scatterer (eg number of point scatterers). \item\end{DoxyCompactList}\item 
virtual const {\bf ScatteringComponentList} \& {\bf GetScatteringComponentList} () const 
\begin{DoxyCompactList}\small\item\em Get the list of all scattering components for this scatterer. \item\end{DoxyCompactList}\item 
virtual string {\bf GetComponentName} (const int i) const 
\begin{DoxyCompactList}\small\item\em Name for the i-\/th component of this scatterer. \item\end{DoxyCompactList}\item 
virtual void {\bf Print} () const \label{a00008_a6c6836c4aa9d1510d64c7916d6ad47e2}

\begin{DoxyCompactList}\small\item\em Print some info about the scatterer (ideally this should be one line...). \item\end{DoxyCompactList}\item 
REAL {\bf GetMass} () const 
\begin{DoxyCompactList}\small\item\em Returns the molar mass of the atom. \item\end{DoxyCompactList}\item 
REAL {\bf GetRadius} () const 
\begin{DoxyCompactList}\small\item\em Returns the radius (in Angstroems) of the atom. \item\end{DoxyCompactList}\item 
virtual ostream \& {\bf POVRayDescription} (ostream \&os, const {\bf CrystalPOVRayOptions} \&options) const 
\begin{DoxyCompactList}\small\item\em XMLOutput a description of the scatterer for POVRay. \item\end{DoxyCompactList}\item 
virtual void {\bf GLInitDisplayList} (const bool onlyIndependentAtoms=false, const REAL xMin=-\/.1, const REAL xMax=1.1, const REAL yMin=-\/.1, const REAL yMax=1.1, const REAL zMin=-\/.1, const REAL zMax=1.1, const bool displayEnantiomer=false, const bool displayNames=false) const 
\item 
bool {\bf IsDummy} () const \label{a00008_a672b84cd14db777c2f449d52671a3b15}

\begin{DoxyCompactList}\small\item\em Is this a dummy atom ? (ie no \doxyref{ScatteringPower}{p.}{a00089}) Dummy atoms should not exist ! \item\end{DoxyCompactList}\item 
virtual void {\bf XMLOutput} (ostream \&os, int indent=0) const 
\begin{DoxyCompactList}\small\item\em Output to stream in well-\/formed XML. \item\end{DoxyCompactList}\item 
virtual void {\bf XMLInput} (istream \&is, const {\bf XMLCrystTag} \&tag)
\begin{DoxyCompactList}\small\item\em Input From stream. \item\end{DoxyCompactList}\item 
const {\bf ScatteringPower} \& {\bf GetScatteringPower} () const \label{a00008_a63893a902cb731f552cb573c58ec94bb}

\begin{DoxyCompactList}\small\item\em Get the \doxyref{ScatteringPowerAtom}{p.}{a00090} corresponding to this atom. \item\end{DoxyCompactList}\item 
virtual void {\bf GetGeneGroup} (const {\bf RefinableObj} \&obj, CrystVector\_\-uint \&groupIndex, unsigned int \&firstGroup) const 
\begin{DoxyCompactList}\small\item\em Get the gene group assigned to each parameter. \item\end{DoxyCompactList}\end{DoxyCompactItemize}
\subsubsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
virtual void {\bf InitRefParList} ()\label{a00008_a72fe4868d70c8068483ba635029bbc86}

\begin{DoxyCompactList}\small\item\em Prepare refinable parameters for the scatterer object. \item\end{DoxyCompactList}\end{DoxyCompactItemize}
\subsubsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
{\bf ScatteringComponentList} {\bf mScattCompList}\label{a00008_aa9fc76a4412ca0726a478612caf02ead}

\begin{DoxyCompactList}\small\item\em The list of scattering components. \item\end{DoxyCompactList}\item 
const {\bf ScatteringPower} $\ast$ {\bf mpScattPowAtom}\label{a00008_a2ca524de2384b4beb111db9ed789f9fc}

\begin{DoxyCompactList}\small\item\em The \doxyref{ScatteringPowerAtom}{p.}{a00090} associated to that atom. \item\end{DoxyCompactList}\end{DoxyCompactItemize}


\subsubsection{Detailed Description}
The basic atom scatterer, in a crystal. This class records the position of the atom, and has a pointer to its \doxyref{ScatteringPowerAtom}{p.}{a00090}.

\begin{DoxyNote}{Note}
there can be 'Dummy' atoms, for which the used symbol is \char`\"{}X\char`\"{}, and which have no scattering power (use with caution: dummy atoms are only supposed to be used within \doxyref{ZScatterer}{p.}{a00155}) 
\end{DoxyNote}


\subsubsection{Constructor \& Destructor Documentation}
\index{ObjCryst::Atom@{ObjCryst::Atom}!Atom@{Atom}}
\index{Atom@{Atom}!ObjCryst::Atom@{ObjCryst::Atom}}
\paragraph[{Atom}]{\setlength{\rightskip}{0pt plus 5cm}ObjCryst::Atom::Atom ()}\hfill\label{a00008_afa78c541a05f1210e9913c4591752042}


Default constructor. The \doxyref{Atom}{p.}{a00008} {\itshape must\/} be initialized thereafter using \doxyref{Atom::Init()}{p.}{a00008_ab05ef76113333041255789dba4bb60cd} \index{ObjCryst::Atom@{ObjCryst::Atom}!Atom@{Atom}}
\index{Atom@{Atom}!ObjCryst::Atom@{ObjCryst::Atom}}
\paragraph[{Atom}]{\setlength{\rightskip}{0pt plus 5cm}ObjCryst::Atom::Atom (const REAL {\em x}, \/  const REAL {\em y}, \/  const REAL {\em z}, \/  const string \& {\em name}, \/  const {\bf ScatteringPower} $\ast$ {\em pow})}\hfill\label{a00008_a8f37e515c9e847ba20cc1033cd54e7b8}


\doxyref{Atom}{p.}{a00008} constructor. 
\begin{DoxyParams}{Parameters}
\item[{\em x,y,z}]: {\itshape fractional\/} coordinates of the atom \item[{\em pow}]: the \doxyref{ScatteringPower}{p.}{a00089} associated to this atom. Must be allocated separately. \item[{\em name}]: name of the atom ('Ta1','Sm2', 'Tungsten\_\-1'...). The name can have {\itshape any\/} format but spaces should be avoided. \end{DoxyParams}
\index{ObjCryst::Atom@{ObjCryst::Atom}!Atom@{Atom}}
\index{Atom@{Atom}!ObjCryst::Atom@{ObjCryst::Atom}}
\paragraph[{Atom}]{\setlength{\rightskip}{0pt plus 5cm}ObjCryst::Atom::Atom (const REAL {\em x}, \/  const REAL {\em y}, \/  const REAL {\em z}, \/  const string \& {\em name}, \/  const {\bf ScatteringPower} $\ast$ {\em pow}, \/  const REAL {\em popu})}\hfill\label{a00008_a1a4253d4b5ea4d8777963a43c7817e87}


\doxyref{Atom}{p.}{a00008} constructor. 
\begin{DoxyParams}{Parameters}
\item[{\em x,y,z}]: {\itshape fractional\/} coordinates of the atom \item[{\em popu}]: the population of the atom (0.0-\/$>$1.0) This should take into account the multiplicity of the atom. For an atom in group P2 and on the 2 axis, this should be set to 0.5, {\bfseries unless} you are using the dynamical occupancy correction (recommended for global optimizations). See \doxyref{Crystal::CalcDynPopCorr()}{p.}{a00020_a69975008974c9603ebb794bb6bb20fe8} and \doxyref{Crystal::mUseDynPopCorr}{p.}{a00020_aa75ade2fea9a50b3e6fb08773f607a13}\item[{\em pow}]: the \doxyref{ScatteringPower}{p.}{a00089} associated to this atom. Must be allocated separatly. \item[{\em name}]: name of the atom ('Ta1','Sm2', 'Tungsten\_\-1'...). The name can have {\itshape any\/} format but spaces should be avoided (just a precaution) \end{DoxyParams}


\subsubsection{Member Function Documentation}
\index{ObjCryst::Atom@{ObjCryst::Atom}!CreateCopy@{CreateCopy}}
\index{CreateCopy@{CreateCopy}!ObjCryst::Atom@{ObjCryst::Atom}}
\paragraph[{CreateCopy}]{\setlength{\rightskip}{0pt plus 5cm}virtual {\bf Atom}$\ast$ ObjCryst::Atom::CreateCopy () const\hspace{0.3cm}{\ttfamily  [virtual]}}\hfill\label{a00008_af5215404ae1f180ed84046700845f92a}
\begin{DoxyInternal}{For internal use only.}
so-\/called Virtual copy constructor, needed to make copies of arrays of Scatterers \end{DoxyInternal}


Implements {\bf ObjCryst::Scatterer} \doxyref{}{p.}{a00084_a4d374adcff97163a24492d362f6def73}.\index{ObjCryst::Atom@{ObjCryst::Atom}!GetClassName@{GetClassName}}
\index{GetClassName@{GetClassName}!ObjCryst::Atom@{ObjCryst::Atom}}
\paragraph[{GetClassName}]{\setlength{\rightskip}{0pt plus 5cm}virtual const string\& ObjCryst::Atom::GetClassName () const\hspace{0.3cm}{\ttfamily  [virtual]}}\hfill\label{a00008_a9f0d1cb7c3b1db1baf84076e5da0ca0e}


Name for this class (\char`\"{}RefinableObj\char`\"{}, \char`\"{}Crystal\char`\"{},. ..). This is only useful to distinguish different classes when picking up objects from the \doxyref{RefinableObj}{p.}{a00070} Global Registry 

Reimplemented from {\bf ObjCryst::Scatterer} \doxyref{}{p.}{a00084_a374fc1bb2887ab1f61d456326d97c05f}.\index{ObjCryst::Atom@{ObjCryst::Atom}!GetComponentName@{GetComponentName}}
\index{GetComponentName@{GetComponentName}!ObjCryst::Atom@{ObjCryst::Atom}}
\paragraph[{GetComponentName}]{\setlength{\rightskip}{0pt plus 5cm}virtual string ObjCryst::Atom::GetComponentName (const int {\em i}) const\hspace{0.3cm}{\ttfamily  [virtual]}}\hfill\label{a00008_a88fed92945210af0e6cf28e34fa545f4}


Name for the i-\/th component of this scatterer. If the component is an \doxyref{Atom}{p.}{a00008}, Then the name is that of the atom. Else, it is the name of the scatterer plus the component number in the scatterer plus the name of the \doxyref{ScatteringPower}{p.}{a00089}. \begin{DoxyNote}{Note}
It would be better to return a reference, but we don't want to keep a name for all components... Weeelll, needs some more thinking... see what performance hit results (if any).
\end{DoxyNote}
\begin{Desc}
\item[{\bf Bug}]does not take into account dummy atoms !! \end{Desc}


Implements {\bf ObjCryst::Scatterer} \doxyref{}{p.}{a00084_a42bdf508da6a90859a5a61e16c27d47e}.\index{ObjCryst::Atom@{ObjCryst::Atom}!GetGeneGroup@{GetGeneGroup}}
\index{GetGeneGroup@{GetGeneGroup}!ObjCryst::Atom@{ObjCryst::Atom}}
\paragraph[{GetGeneGroup}]{\setlength{\rightskip}{0pt plus 5cm}virtual void ObjCryst::Atom::GetGeneGroup (const {\bf RefinableObj} \& {\em obj}, \/  CrystVector\_\-uint \& {\em groupIndex}, \/  unsigned int \& {\em firstGroup}) const\hspace{0.3cm}{\ttfamily  [virtual]}}\hfill\label{a00008_a01645142310cf68d21b50ec514a0af77}


Get the gene group assigned to each parameter. Each parameter (a {\itshape gene\/} in terms of genetic algorithms) can be assigned to a gene group. Thus when mating two configurations, genes will be exchanged by groups. By default (in the base RefinabeObj class), each parameter is alone in its group. Derived classes can group genes for a better s$\ast$$\ast$ life.

The number identifying a gene group only has a meaning in a given object. It can also change on subsequent calls, and thus is not unique.


\begin{DoxyParams}{Parameters}
\item[{\em obj}]the , supplied by an algorithm class (\doxyref{OptimizationObj}{p.}{a00054},..), which contains a list of parameters, some of which (but possibly all or none) are parameters belonging to this object. \item[{\em groupIndex}]a vector of unsigned integers, one for each parameter in the input object, giving an unsigned integer value as gene group index. At the beginning this vector should contain only zeros (no group assigned). \item[{\em firstGroup}]this is the number of groups which have already been assigned, plus one. The gene groups returned by this object will start from this value, and increment {\bfseries firstGroup} for each gene group used, so that different \doxyref{RefinableObj}{p.}{a00070} cannot share a gene group. \end{DoxyParams}
\begin{DoxyNote}{Note}
this function is not optimized, and should only be called at the beginning of a refinement. 
\end{DoxyNote}


Reimplemented from {\bf ObjCryst::RefinableObj} \doxyref{}{p.}{a00070_ad59c8ad2b0d7ee59fa3f399a54f05e54}.\index{ObjCryst::Atom@{ObjCryst::Atom}!GetMass@{GetMass}}
\index{GetMass@{GetMass}!ObjCryst::Atom@{ObjCryst::Atom}}
\paragraph[{GetMass}]{\setlength{\rightskip}{0pt plus 5cm}REAL ObjCryst::Atom::GetMass () const}\hfill\label{a00008_afbdf315ca2363179e5227fe47d7f9106}


Returns the molar mass of the atom. Values are extracted from the 'atominfo' package, which uses data from the CRC Handbook of Chemistry \& Physics, 63rd \& 70th editions The Mass is actually extracted from the \doxyref{ScatteringPowerAtom}{p.}{a00090}. \index{ObjCryst::Atom@{ObjCryst::Atom}!GetRadius@{GetRadius}}
\index{GetRadius@{GetRadius}!ObjCryst::Atom@{ObjCryst::Atom}}
\paragraph[{GetRadius}]{\setlength{\rightskip}{0pt plus 5cm}REAL ObjCryst::Atom::GetRadius () const}\hfill\label{a00008_ac0e9f074ecf5a20cf73752d38d7cc453}


Returns the radius (in Angstroems) of the atom. Values are extracted from the 'atominfo' package, which uses data from the ICSD/CRYSTIN Manual The Radius is extracted from the \doxyref{ScatteringPowerAtom}{p.}{a00090}. \index{ObjCryst::Atom@{ObjCryst::Atom}!GetScatteringComponentList@{GetScatteringComponentList}}
\index{GetScatteringComponentList@{GetScatteringComponentList}!ObjCryst::Atom@{ObjCryst::Atom}}
\paragraph[{GetScatteringComponentList}]{\setlength{\rightskip}{0pt plus 5cm}virtual const {\bf ScatteringComponentList}\& ObjCryst::Atom::GetScatteringComponentList () const\hspace{0.3cm}{\ttfamily  [virtual]}}\hfill\label{a00008_a3483660b1d08b113af61d708ecff8d1a}


Get the list of all scattering components for this scatterer. This is the most important function of this class, giving the list of scattering positions along with the associated \doxyref{ScatteringPower}{p.}{a00089}. 

Implements {\bf ObjCryst::Scatterer} \doxyref{}{p.}{a00084_aca0e08e3793cc69d31fce53e481c2a67}.\index{ObjCryst::Atom@{ObjCryst::Atom}!GLInitDisplayList@{GLInitDisplayList}}
\index{GLInitDisplayList@{GLInitDisplayList}!ObjCryst::Atom@{ObjCryst::Atom}}
\paragraph[{GLInitDisplayList}]{\setlength{\rightskip}{0pt plus 5cm}virtual void ObjCryst::Atom::GLInitDisplayList (const bool {\em noSymmetrics} = {\ttfamily false}, \/  const REAL {\em xMin} = {\ttfamily -\/.1}, \/  const REAL {\em xMax} = {\ttfamily 1.1}, \/  const REAL {\em yMin} = {\ttfamily -\/.1}, \/  const REAL {\em yMax} = {\ttfamily 1.1}, \/  const REAL {\em zMin} = {\ttfamily -\/.1}, \/  const REAL {\em zMax} = {\ttfamily 1.1}, \/  const bool {\em displayEnantiomer} = {\ttfamily false}, \/  const bool {\em displayNames} = {\ttfamily false}) const\hspace{0.3cm}{\ttfamily  [virtual]}}\hfill\label{a00008_a14e239415f6923d83ceff1347b89393b}
\begin{DoxyInternal}{For internal use only.}
Create an OpenGL Display List of the scatterer. This should only be called by a \doxyref{Crystal}{p.}{a00020} object.


\begin{DoxyParams}{Parameters}
\item[{\em noSymmetrics,:}]if false (the default), then all symmetrics are shown in the 3D display, within the limits defined by the min/max parameters $\backslash$ param xMin,xMax,yMin,yMax,zMin,zMax: in fractionnal coordinates, the region in which we want scaterrer to be displayed. The test is made on the center of the scatterer (eg a \doxyref{ZScatterer}{p.}{a00155} (molecule) will not be 'cut' on the border). \item[{\em displayNames,:}]if true, only the names of the scatterers will be displayed, at the position of the scatterers (to actually see them, they will have to be translated with respect to the drawing of the scatterers). \end{DoxyParams}
\end{DoxyInternal}


Implements {\bf ObjCryst::Scatterer} \doxyref{}{p.}{a00084_a4eaf9cf9780bef83e40155810db120a0}.\index{ObjCryst::Atom@{ObjCryst::Atom}!Init@{Init}}
\index{Init@{Init}!ObjCryst::Atom@{ObjCryst::Atom}}
\paragraph[{Init}]{\setlength{\rightskip}{0pt plus 5cm}void ObjCryst::Atom::Init (const REAL {\em x}, \/  const REAL {\em y}, \/  const REAL {\em z}, \/  const string \& {\em name}, \/  const {\bf ScatteringPower} $\ast$ {\em pow}, \/  const REAL {\em popu} = {\ttfamily 1})}\hfill\label{a00008_ab05ef76113333041255789dba4bb60cd}


initialize the atom (used for arrays of atoms). 
\begin{DoxyParams}{Parameters}
\item[{\em x,y,z}]: {\itshape fractional\/} coordinates of the atom \item[{\em pow}]: the \doxyref{ScatteringPower}{p.}{a00089} associated to this atom. Must be allocated separately. \item[{\em name}]: name of the atom ('Ta1','Sm2', 'Tungsten\_\-1'...). \end{DoxyParams}
\index{ObjCryst::Atom@{ObjCryst::Atom}!POVRayDescription@{POVRayDescription}}
\index{POVRayDescription@{POVRayDescription}!ObjCryst::Atom@{ObjCryst::Atom}}
\paragraph[{POVRayDescription}]{\setlength{\rightskip}{0pt plus 5cm}virtual ostream\& ObjCryst::Atom::POVRayDescription (ostream \& {\em os}, \/  const {\bf CrystalPOVRayOptions} \& {\em options}) const\hspace{0.3cm}{\ttfamily  [virtual]}}\hfill\label{a00008_a2994321bc2974d853f36b011d23a94b3}


XMLOutput a description of the scatterer for POVRay. 

Implements {\bf ObjCryst::Scatterer} \doxyref{}{p.}{a00084_a708cc857f82c9af4cbdf4d9334449d0f}.\index{ObjCryst::Atom@{ObjCryst::Atom}!XMLInput@{XMLInput}}
\index{XMLInput@{XMLInput}!ObjCryst::Atom@{ObjCryst::Atom}}
\paragraph[{XMLInput}]{\setlength{\rightskip}{0pt plus 5cm}virtual void ObjCryst::Atom::XMLInput (istream \& {\em is}, \/  const {\bf XMLCrystTag} \& {\em tag})\hspace{0.3cm}{\ttfamily  [virtual]}}\hfill\label{a00008_a08fe773b05dd0dc748b8008636b56187}


Input From stream. \begin{Desc}
\item[{\bf Todo}]Add an bool XMLInputTag(is,tag) function to recognize all the tags from the stream. So that each inherited class can use the XMLInputTag function from its parent (ie take advantage of inheritance). The children class would first try to interpret the tag, then if unsuccessful would pass it to its parent (thus allowing overloading), etc... \end{Desc}


Reimplemented from {\bf ObjCryst::RefinableObj} \doxyref{}{p.}{a00070_ac13a4045c3f187879443c8615c38d623}.\index{ObjCryst::Atom@{ObjCryst::Atom}!XMLOutput@{XMLOutput}}
\index{XMLOutput@{XMLOutput}!ObjCryst::Atom@{ObjCryst::Atom}}
\paragraph[{XMLOutput}]{\setlength{\rightskip}{0pt plus 5cm}virtual void ObjCryst::Atom::XMLOutput (ostream \& {\em os}, \/  int {\em indent} = {\ttfamily 0}) const\hspace{0.3cm}{\ttfamily  [virtual]}}\hfill\label{a00008_a83bd4047affa8c4de3126465595b77cb}


Output to stream in well-\/formed XML. \begin{Desc}
\item[{\bf Todo}]Use inheritance.. as for XMLInputTag()... \end{Desc}


Reimplemented from {\bf ObjCryst::RefinableObj} \doxyref{}{p.}{a00070_a7b9b6ed0f8dcf753d398c35e073de973}.

The documentation for this class was generated from the following file:\begin{DoxyCompactItemize}
\item 
Atom.h\end{DoxyCompactItemize}
