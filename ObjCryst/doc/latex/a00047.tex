\subsection{\-Obj\-Cryst\-:\-:\-Molecule \-Class \-Reference}
\label{a00047}\index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}}


\doxyref{\-Molecule}{p.}{a00047} \-: class for complex scatterer descriptions using cartesian coordinates with bond length/angle restraints, and moves either of individual atoms or using torsion bonds.  


\-Inheritance diagram for \-Obj\-Cryst\-:\-:\-Molecule\-:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=3.000000cm]{a00047}
\end{center}
\end{figure}
\subsubsection*{\-Classes}
\begin{DoxyCompactItemize}
\item 
struct {\bf \-Flip\-Group}
\begin{DoxyCompactList}\small\item\em \-When 3(\-A1..1n) or more atoms are connected to a same atom \-A, it defines a 'flip' group, where it is possible to rotate bonds to their symmetric with respect to one plane defined by atoms \-Ai-\/\-A-\/\-Aj. \end{DoxyCompactList}\item 
struct {\bf \-Rotor\-Group}
\begin{DoxyCompactList}\small\item\em \-Defines a group of atoms which can be rotated around an axis defined by two other atoms. \end{DoxyCompactList}\item 
struct {\bf \-Stretch\-Mode\-Group}
\begin{DoxyCompactList}\small\item\em \-Group of concurrent \-Stretch\-Modes (affecting common restraints) \-A given stretch mode can only belong to one group. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsubsection*{\-Public \-Member \-Functions}
\begin{DoxyCompactItemize}
\item 
{\bf \-Molecule} ({\bf \-Crystal} \&cryst, const string \&name=\char`\"{}\char`\"{})
\begin{DoxyCompactList}\small\item\em \-Constructor. \end{DoxyCompactList}\item 
{\bf \-Molecule} (const {\bf \-Molecule} \&old)
\begin{DoxyCompactList}\small\item\em \-Copy constructor. \end{DoxyCompactList}\item 
{\bf $\sim$\-Molecule} ()
\begin{DoxyCompactList}\small\item\em \-Destructor. \end{DoxyCompactList}\item 
virtual {\bf \-Molecule} $\ast$ {\bf \-Create\-Copy} () const 
\item 
virtual const string \& {\bf \-Get\-Class\-Name} () const 
\begin{DoxyCompactList}\small\item\em \-Name for this class (\char`\"{}\-Refinable\-Obj\char`\"{}, \char`\"{}\-Crystal\char`\"{},...). \end{DoxyCompactList}\item 
virtual void {\bf \-Print} () const \label{a00047_a5c4fde55689b7e76705d1f04005802c6}

\begin{DoxyCompactList}\small\item\em \-Print some info about the scatterer (ideally this should be one line...). \end{DoxyCompactList}\item 
virtual void {\bf \-X\-M\-L\-Output} (ostream \&os, int indent=0) const 
\begin{DoxyCompactList}\small\item\em \-Output to stream in well-\/formed \-X\-M\-L. \end{DoxyCompactList}\item 
virtual void {\bf \-X\-M\-L\-Input} (istream \&is, const {\bf \-X\-M\-L\-Cryst\-Tag} \&tag)
\begin{DoxyCompactList}\small\item\em \-Input \-From stream. \end{DoxyCompactList}\item 
virtual void {\bf \-Update\-Display} () const 
\begin{DoxyCompactList}\small\item\em \-If there is an interface, this should be automatically be called each time there is a 'new, significant' configuration to report. \end{DoxyCompactList}\item 
virtual void {\bf \-Begin\-Optimization} (const bool allow\-Approximations=false, const bool enable\-Restraints=false)
\begin{DoxyCompactList}\small\item\em \-This should be called by any optimization class at the begining of an optimization. \end{DoxyCompactList}\item 
virtual void {\bf \-End\-Optimization} ()
\begin{DoxyCompactList}\small\item\em \-This should be called by any optimization class at the end of an optimization. \end{DoxyCompactList}\item 
virtual void {\bf \-Randomize\-Configuration} ()
\begin{DoxyCompactList}\small\item\em \-Randomize \-Configuration (before a global optimization). \end{DoxyCompactList}\item 
virtual void {\bf \-Global\-Opt\-Random\-Move} (const \-R\-E\-A\-L mutation\-Amplitude, const {\bf \-Ref\-Par\-Type} $\ast$type)
\begin{DoxyCompactList}\small\item\em \-Make a random move of the current configuration. \end{DoxyCompactList}\item 
virtual \-R\-E\-A\-L {\bf \-Get\-Log\-Likelihood} () const 
\begin{DoxyCompactList}\small\item\em \-Get -\/log(likelihood) of the current configuration for the object. \end{DoxyCompactList}\item 
virtual unsigned int {\bf \-Get\-Nb\-L\-S\-Q\-Function} () const \label{a00047_a1496167f3d3eae46a1f1eb49110808ce}

\begin{DoxyCompactList}\small\item\em \-Number of \-L\-S\-Q functions. \end{DoxyCompactList}\item 
virtual const \-Cryst\-Vector\-\_\-\-R\-E\-A\-L \& {\bf \-Get\-L\-S\-Q\-Calc} (const unsigned int) const \label{a00047_ab9b0b6172128e4aae0aa4a26e9024550}

\begin{DoxyCompactList}\small\item\em \-Get the current calculated value for the \-L\-S\-Q function. \end{DoxyCompactList}\item 
virtual const \-Cryst\-Vector\-\_\-\-R\-E\-A\-L \& {\bf \-Get\-L\-S\-Q\-Obs} (const unsigned int) const \label{a00047_a044e12d7bd85fc13552ce3ef24776af5}

\begin{DoxyCompactList}\small\item\em \-Get the observed values for the \-L\-S\-Q function. \end{DoxyCompactList}\item 
virtual const \-Cryst\-Vector\-\_\-\-R\-E\-A\-L \& {\bf \-Get\-L\-S\-Q\-Weight} (const unsigned int) const \label{a00047_ac4c7e12b5f9ed0ddfeddd68e85291a17}

\begin{DoxyCompactList}\small\item\em \-Get the weight values for the \-L\-S\-Q function. \end{DoxyCompactList}\item 
virtual const \-Cryst\-Vector\-\_\-\-R\-E\-A\-L \& {\bf \-Get\-L\-S\-Q\-Deriv} (const unsigned int n, {\bf \-Refinable\-Par} \&par)
\begin{DoxyCompactList}\small\item\em \-Get the first derivative values for the \-L\-S\-Q function, for a given parameter. \end{DoxyCompactList}\item 
virtual void {\bf \-Tag\-New\-Best\-Config} () const 
\begin{DoxyCompactList}\small\item\em \-During a global optimization, tells the object that the current config is the latest \char`\"{}best\char`\"{} config. \end{DoxyCompactList}\item 
virtual int {\bf \-Get\-Nb\-Component} () const \label{a00047_a8787cb87d65117d40a595162cdab141e}

\begin{DoxyCompactList}\small\item\em \-Number of components in the scatterer (eg number of point scatterers) \end{DoxyCompactList}\item 
virtual const \*
{\bf \-Scattering\-Component\-List} \& {\bf \-Get\-Scattering\-Component\-List} () const 
\begin{DoxyCompactList}\small\item\em \-Get the list of all scattering components for this scatterer. \end{DoxyCompactList}\item 
virtual string {\bf \-Get\-Component\-Name} (const int i) const 
\begin{DoxyCompactList}\small\item\em \-Name for the i-\/th component of this scatterer. \end{DoxyCompactList}\item 
virtual ostream \& {\bf \-P\-O\-V\-Ray\-Description} (ostream \&os, const {\bf \-Crystal\-P\-O\-V\-Ray\-Options} \&options) const 
\item 
virtual void {\bf \-G\-L\-Init\-Display\-List} (const bool only\-Independent\-Atoms=false, const \-R\-E\-A\-L x\-Min=-\/.\-1, const \-R\-E\-A\-L x\-Max=1.\-1, const \-R\-E\-A\-L y\-Min=-\/.\-1, const \-R\-E\-A\-L y\-Max=1.\-1, const \-R\-E\-A\-L z\-Min=-\/.\-1, const \-R\-E\-A\-L z\-Max=1.\-1, const bool display\-Enantiomer=false, const bool display\-Names=false) const 
\item 
void {\bf \-Add\-Atom} (const \-R\-E\-A\-L x, const \-R\-E\-A\-L y, const \-R\-E\-A\-L z, const {\bf \-Scattering\-Power} $\ast$p\-Pow, const string \&name, const bool update\-Display=true)
\begin{DoxyCompactList}\small\item\em \-Add an atom. \end{DoxyCompactList}\item 
vector$<$ {\bf \-Mol\-Atom} $\ast$ $>$\-::iterator {\bf \-Remove\-Atom} ({\bf \-Mol\-Atom} \&, const bool del=true)
\begin{DoxyCompactList}\small\item\em \-Remove an atom. \end{DoxyCompactList}\item 
void {\bf \-Add\-Bond} ({\bf \-Mol\-Atom} \&atom1, {\bf \-Mol\-Atom} \&atom2, const \-R\-E\-A\-L length, const \-R\-E\-A\-L sigma, const \-R\-E\-A\-L delta, const \-R\-E\-A\-L bond\-Order=1., const bool update\-Display=true)
\begin{DoxyCompactList}\small\item\em \-Add a bond. \end{DoxyCompactList}\item 
vector$<$ {\bf \-Mol\-Bond} $\ast$ $>$\-::iterator {\bf \-Remove\-Bond} (const {\bf \-Mol\-Bond} \&, const bool del=true)
\begin{DoxyCompactList}\small\item\em \-Remove a bond. \end{DoxyCompactList}\item 
vector$<$ {\bf \-Mol\-Bond} $\ast$ $>$\-::const\-\_\-iterator {\bf \-Find\-Bond} (const {\bf \-Mol\-Atom} \&, const {\bf \-Mol\-Atom} \&) const 
\begin{DoxyCompactList}\small\item\em \-Searches whether a bond between two atoms already exists. \end{DoxyCompactList}\item 
vector$<$ {\bf \-Mol\-Bond} $\ast$ $>$\-::iterator {\bf \-Find\-Bond} (const {\bf \-Mol\-Atom} \&, const {\bf \-Mol\-Atom} \&)
\begin{DoxyCompactList}\small\item\em \-Searches whether a bond between two atoms already exists. \end{DoxyCompactList}\item 
void {\bf \-Add\-Bond\-Angle} ({\bf \-Mol\-Atom} \&atom1, {\bf \-Mol\-Atom} \&atom2, {\bf \-Mol\-Atom} \&atom3, const \-R\-E\-A\-L angle, const \-R\-E\-A\-L sigma, const \-R\-E\-A\-L delta, const bool update\-Display=true)
\begin{DoxyCompactList}\small\item\em \-Add a bond angle restraint. \end{DoxyCompactList}\item 
vector$<$ {\bf \-Mol\-Bond\-Angle} $\ast$ $>$\-::iterator {\bf \-Remove\-Bond\-Angle} (const {\bf \-Mol\-Bond\-Angle} \&, const bool del=true)
\begin{DoxyCompactList}\small\item\em \-Remove a \-Bond\-Angle. \end{DoxyCompactList}\item 
vector$<$ {\bf \-Mol\-Bond\-Angle} $\ast$ $>$\*
\-::const\-\_\-iterator {\bf \-Find\-Bond\-Angle} (const {\bf \-Mol\-Atom} \&at1, const {\bf \-Mol\-Atom} \&at0, const {\bf \-Mol\-Atom} \&at2) const 
\begin{DoxyCompactList}\small\item\em \-Searches whether a bond between three atoms already exists, searching for either (at1,at2,at3) and (at3,at2,at1), as these are equivalent. \end{DoxyCompactList}\item 
void {\bf \-Add\-Dihedral\-Angle} ({\bf \-Mol\-Atom} \&atom1, {\bf \-Mol\-Atom} \&atom2, {\bf \-Mol\-Atom} \&atom3, {\bf \-Mol\-Atom} \&atom4, const \-R\-E\-A\-L angle, const \-R\-E\-A\-L sigma, const \-R\-E\-A\-L delta, const bool update\-Display=true)
\begin{DoxyCompactList}\small\item\em \-Add a dihedral angle restraint. \end{DoxyCompactList}\item 
vector$<$ {\bf \-Mol\-Dihedral\-Angle} $\ast$ $>$\*
\-::iterator {\bf \-Remove\-Dihedral\-Angle} (const {\bf \-Mol\-Dihedral\-Angle} \&, const bool del=true)
\begin{DoxyCompactList}\small\item\em \-Remove a dihedral angle. \end{DoxyCompactList}\item 
vector$<$ {\bf \-Mol\-Dihedral\-Angle} $\ast$ $>$\*
\-::const\-\_\-iterator {\bf \-Find\-Dihedral\-Angle} (const {\bf \-Mol\-Atom} \&at1, const {\bf \-Mol\-Atom} \&at2, const {\bf \-Mol\-Atom} \&at3, const {\bf \-Mol\-Atom} \&at4) const 
\begin{DoxyCompactList}\small\item\em \-Searches whether a dihedral between four atoms already exists, searching for either (at1,at2,at3,at4) and (at4,at3,at2,at1), as these are equivalent. \end{DoxyCompactList}\item 
void {\bf \-Add\-Rigid\-Group} (const {\bf \-Rigid\-Group} \&, const bool update\-Display=true)
\begin{DoxyCompactList}\small\item\em \-Add a rigid group of atoms. \end{DoxyCompactList}\item 
std\-::vector$<$ {\bf \-Rigid\-Group} $\ast$ $>$\*
\-::iterator {\bf \-Remove\-Rigid\-Group} (const {\bf \-Rigid\-Group} \&group, const bool update\-Display=true, const bool del=true)
\begin{DoxyCompactList}\small\item\em \-Remove a rigid group of atoms. \end{DoxyCompactList}\item 
{\bf \-Mol\-Atom} \& {\bfseries \-Get\-Atom} (unsigned int i)\label{a00047_a0fc6f489b5ca70ec72f0968068c409d7}

\item 
const {\bf \-Mol\-Atom} \& {\bfseries \-Get\-Atom} (unsigned int i) const \label{a00047_a73cd31a5e84043b21878c8e6131f528a}

\item 
{\bf \-Mol\-Atom} \& {\bfseries \-Get\-Atom} (const string \&name)\label{a00047_a7532113b6b8d93659e319883bd709cbc}

\item 
const {\bf \-Mol\-Atom} \& {\bfseries \-Get\-Atom} (const string \&name) const \label{a00047_ace9ed3d2234a31be6f44d560e99edd14}

\item 
vector$<$ {\bf \-Mol\-Atom} $\ast$ $>$\*
\-::reverse\-\_\-iterator {\bf \-Find\-Atom} (const string \&name)
\begin{DoxyCompactList}\small\item\em \-Search a \doxyref{\-Mol\-Atom}{p.}{a00043} from its name. \end{DoxyCompactList}\item 
vector$<$ {\bf \-Mol\-Atom} $\ast$ $>$\*
\-::const\-\_\-reverse\-\_\-iterator {\bf \-Find\-Atom} (const string \&name) const 
\begin{DoxyCompactList}\small\item\em \-Search a \doxyref{\-Mol\-Atom}{p.}{a00043} from its name. \end{DoxyCompactList}\item 
void {\bf \-Optimize\-Conformation} (const long nb\-Trial=10000, const \-R\-E\-A\-L stop\-Cost=0.)
\begin{DoxyCompactList}\small\item\em \-Minimize configuration from internal restraints (bond lengths, angles and dihedral angles). \end{DoxyCompactList}\item 
void {\bf \-Optimize\-Conformation\-Steepest\-Descent} (const \-R\-E\-A\-L max\-Step=0.\-1, const unsigned nb\-Step=1)
\begin{DoxyCompactList}\small\item\em \-Optimize the conformation from internal restraints (bond lengths, angles and dihedral angles), using a steepest descent algorithm. \end{DoxyCompactList}\item 
void {\bf \-Molecular\-Dynamics\-Evolve} (std\-::map$<$ {\bf \-Mol\-Atom} $\ast$, {\bf \-X\-Y\-Z} $>$ \&v0, const unsigned nb\-Step, const \-R\-E\-A\-L dt, const std\-::vector$<$ {\bf \-Mol\-Bond} $\ast$ $>$ \&vb, const std\-::vector$<$ {\bf \-Mol\-Bond\-Angle} $\ast$ $>$ \&va, const std\-::vector$<$ {\bf \-Mol\-Dihedral\-Angle} $\ast$ $>$ \&vd, std\-::map$<$ {\bf \-Rigid\-Group} $\ast$, std\-::pair$<$ {\bf \-X\-Y\-Z}, {\bf \-X\-Y\-Z} $>$ $>$ \&vr, \-R\-E\-A\-L nrj0=0)
\begin{DoxyCompactList}\small\item\em \-Change the conformation of the molecule using molecular dynamics principles. \end{DoxyCompactList}\item 
const std\-::vector$<$ {\bf \-Mol\-Atom} $\ast$ $>$ \& {\bfseries \-Get\-Atom\-List} () const \label{a00047_a61a315fb7ee03b2a96864342fe4600c5}

\item 
const std\-::vector$<$ {\bf \-Mol\-Bond} $\ast$ $>$ \& {\bfseries \-Get\-Bond\-List} () const \label{a00047_a275e909fe6ba8357e29b979f6840005c}

\item 
const std\-::vector\*
$<$ {\bf \-Mol\-Bond\-Angle} $\ast$ $>$ \& {\bfseries \-Get\-Bond\-Angle\-List} () const \label{a00047_a3282f5961beef5a6369f4aa70d6272b7}

\item 
const std\-::vector\*
$<$ {\bf \-Mol\-Dihedral\-Angle} $\ast$ $>$ \& {\bfseries \-Get\-Dihedral\-Angle\-List} () const \label{a00047_a95389aeb48405b4b4772c69e5edd9499}

\item 
std\-::vector$<$ {\bf \-Mol\-Atom} $\ast$ $>$ \& {\bfseries \-Get\-Atom\-List} ()\label{a00047_af437a692e431372f8bdb37d23baf97f4}

\item 
std\-::vector$<$ {\bf \-Mol\-Bond} $\ast$ $>$ \& {\bfseries \-Get\-Bond\-List} ()\label{a00047_a900e3d7d54b7d8481f5c24665a3dda3b}

\item 
std\-::vector$<$ {\bf \-Mol\-Bond\-Angle} $\ast$ $>$ \& {\bfseries \-Get\-Bond\-Angle\-List} ()\label{a00047_a66bce84293ff7457a68878281dea862a}

\item 
std\-::vector$<$ {\bf \-Mol\-Dihedral\-Angle} $\ast$ $>$ \& {\bfseries \-Get\-Dihedral\-Angle\-List} ()\label{a00047_a145da462c88c4859e3656872427dbdd4}

\item 
std\-::list\*
$<$ {\bf \-Stretch\-Mode\-Bond\-Length} $>$ \& {\bfseries \-Get\-Stretch\-Mode\-Bond\-Length\-List} ()\label{a00047_a2bde766df8213037d92110e1d61404e5}

\item 
std\-::list$<$ {\bf \-Stretch\-Mode\-Bond\-Angle} $>$ \& {\bfseries \-Get\-Stretch\-Mode\-Bond\-Angle\-List} ()\label{a00047_a3c84c2ee25cd4207b3b0033421382d5d}

\item 
std\-::list$<$ {\bf \-Stretch\-Mode\-Torsion} $>$ \& {\bfseries \-Get\-Stretch\-Mode\-Torsion\-List} ()\label{a00047_aef5aa02c67aef3248c36c86719dd0f75}

\item 
const std\-::list\*
$<$ {\bf \-Stretch\-Mode\-Bond\-Length} $>$ \& {\bfseries \-Get\-Stretch\-Mode\-Bond\-Length\-List} () const \label{a00047_a07fa91c73992177983dc99bab7acd61c}

\item 
const std\-::list\*
$<$ {\bf \-Stretch\-Mode\-Bond\-Angle} $>$ \& {\bfseries \-Get\-Stretch\-Mode\-Bond\-Angle\-List} () const \label{a00047_a60e4c6791d3f45cb18e9895ac272a673}

\item 
const std\-::list\*
$<$ {\bf \-Stretch\-Mode\-Torsion} $>$ \& {\bfseries \-Get\-Stretch\-Mode\-Torsion\-List} () const \label{a00047_a5b08fa7fb5aff3a909e9c836cce6e8ad}

\item 
const std\-::vector$<$ {\bf \-Rigid\-Group} $\ast$ $>$ \& {\bf \-Get\-Rigid\-Group\-List} () const 
\begin{DoxyCompactList}\small\item\em \-List of rigid group of atoms. \end{DoxyCompactList}\item 
std\-::vector$<$ {\bf \-Rigid\-Group} $\ast$ $>$ \& {\bf \-Get\-Rigid\-Group\-List} ()
\begin{DoxyCompactList}\small\item\em \-List of rigid group of atoms. \end{DoxyCompactList}\item 
void {\bf \-Rotate\-Atom\-Group} (const {\bf \-Mol\-Atom} \&at1, const {\bf \-Mol\-Atom} \&at2, const set$<$ {\bf \-Mol\-Atom} $\ast$ $>$ \&atoms, const \-R\-E\-A\-L angle, const bool keep\-Center=true)
\begin{DoxyCompactList}\small\item\em \-Rotate a group of atoms around an axis defined by two atoms. \end{DoxyCompactList}\item 
void {\bf \-Rotate\-Atom\-Group} (const {\bf \-Mol\-Atom} \&at, const \-R\-E\-A\-L vx, const \-R\-E\-A\-L vy, const \-R\-E\-A\-L vz, const set$<$ {\bf \-Mol\-Atom} $\ast$ $>$ \&atoms, const \-R\-E\-A\-L angle, const bool keep\-Center=true)
\begin{DoxyCompactList}\small\item\em \-Rotate a group of atoms around an axis defined by one atom and a vector. \end{DoxyCompactList}\item 
void {\bf \-Translate\-Atom\-Group} (const set$<$ {\bf \-Mol\-Atom} $\ast$ $>$ \&atoms, const \-R\-E\-A\-L dx, const \-R\-E\-A\-L dy, const \-R\-E\-A\-L dz, const bool keep\-Center=true)
\begin{DoxyCompactList}\small\item\em \-Translate a group of atoms in a given direction. \end{DoxyCompactList}\item 
void {\bf \-Restraint\-Status} (ostream \&os) const \label{a00047_ae7311bdcb3ce15284228bfa2ab140e86}

\begin{DoxyCompactList}\small\item\em \-Print the status of all restraints (bond length, angles...) \end{DoxyCompactList}\item 
const map$<$ {\bf \-Mol\-Atom} $\ast$, set\*
$<$ {\bf \-Mol\-Atom} $\ast$ $>$ $>$ \& {\bf \-Get\-Connectivity\-Table} ()\label{a00047_ac558aa9940aec9e33ae710fb45b3d156}

\begin{DoxyCompactList}\small\item\em \-Get the connectivity table. \end{DoxyCompactList}\item 
{\bf \-Refinable\-Obj\-Clock} \& {\bf \-Get\-Bond\-List\-Clock} ()\label{a00047_a5ab539b95ffd60978ae7545ec10cc85b}

\begin{DoxyCompactList}\small\item\em get the clock associated to the list of bonds \end{DoxyCompactList}\item 
const {\bf \-Refinable\-Obj\-Clock} \& {\bf \-Get\-Bond\-List\-Clock} () const \label{a00047_ac754cabe98638a6f9efd0bf63a667c03}

\begin{DoxyCompactList}\small\item\em get the clock associated to the list of bonds \end{DoxyCompactList}\item 
{\bf \-Refinable\-Obj\-Clock} \& {\bf \-Get\-Atom\-Position\-Clock} ()\label{a00047_a46f35ddb18b731cfbb104d45ed96cdc7}

\begin{DoxyCompactList}\small\item\em \-Get the clock associated to the atomic positions. \end{DoxyCompactList}\item 
const {\bf \-Refinable\-Obj\-Clock} \& {\bf \-Get\-Atom\-Position\-Clock} () const \label{a00047_a8c0a4e5e8fbdd2190c2838be9d4ea42e}

\begin{DoxyCompactList}\small\item\em \-Get the clock associated to the atomic positions. \end{DoxyCompactList}\item 
{\bf \-Refinable\-Obj\-Clock} \& {\bf \-Get\-Rigid\-Group\-Clock} ()\label{a00047_a5d5be56a81d49a3e067957b6e959b477}

\begin{DoxyCompactList}\small\item\em \-Get the clock associated to the list of rigid groups (clicked also whenever a rigid group is modified) \end{DoxyCompactList}\item 
const {\bf \-Refinable\-Obj\-Clock} \& {\bf \-Get\-Rigid\-Group\-Clock} () const \label{a00047_ae6b950305c66f518df22e52eb6e1661a}

\begin{DoxyCompactList}\small\item\em \-Get the clock associated to the list of rigid groups (clicked also whenever a rigid group is modified) \end{DoxyCompactList}\item 
void {\bf \-Rigidify\-With\-Dihedral\-Angles} ()
\begin{DoxyCompactList}\small\item\em \-Add dihedral angles so as to rigidify the \doxyref{\-Molecule}{p.}{a00047}. \end{DoxyCompactList}\item 
\-R\-E\-A\-L {\bf \-Bond\-Length\-Random\-Change} (const {\bf \-Stretch\-Mode\-Bond\-Length} \&mode, const \-R\-E\-A\-L amplitude, const bool respect\-Restraint=true)
\begin{DoxyCompactList}\small\item\em \-Stretch a bond, while respecting the \doxyref{\-Restraint}{p.}{a00081} (if any). \end{DoxyCompactList}\item 
\-R\-E\-A\-L {\bf \-Bond\-Angle\-Random\-Change} (const {\bf \-Stretch\-Mode\-Bond\-Angle} \&mode, const \-R\-E\-A\-L amplitude, const bool respect\-Restraint=true)
\begin{DoxyCompactList}\small\item\em change a bond angle, while respecting the \doxyref{\-Restraint}{p.}{a00081} (if any). \end{DoxyCompactList}\item 
\-R\-E\-A\-L {\bf \-Dihedral\-Angle\-Random\-Change} (const {\bf \-Stretch\-Mode\-Torsion} \&mode, const \-R\-E\-A\-L amplitude, const bool respect\-Restraint=true)
\begin{DoxyCompactList}\small\item\em \-Change a dihedral angle, while respecting the \doxyref{\-Restraint}{p.}{a00081} (if any). \end{DoxyCompactList}\item 
const {\bf \-Mol\-Atom} $\ast$ {\bf \-Get\-Center\-Atom} () const 
\begin{DoxyCompactList}\small\item\em \-Get the atom defining the origin of the \doxyref{\-Molecule}{p.}{a00047} \-Equal to 0 if no atom as been set. \end{DoxyCompactList}\item 
void {\bf \-Set\-Center\-Atom} (const {\bf \-Mol\-Atom} \&at)
\begin{DoxyCompactList}\small\item\em \-Get the atom defining the origin of the \doxyref{\-Molecule}{p.}{a00047} \-Equal to 0 if no atom as been set. \end{DoxyCompactList}\item 
const std\-::vector$<$ {\bf \-Mol\-Z\-Atom} $>$ \& {\bf \-As\-Z\-Matrix} (const bool keeporder) const 
\begin{DoxyCompactList}\small\item\em \doxyref{\-Molecule}{p.}{a00047} as \-Z-\/matrix. \end{DoxyCompactList}\item 
void {\bf \-Set\-Delete\-Sub\-Obj\-In\-Destructor} (const bool b)
\begin{DoxyCompactList}\small\item\em \-Set whether to delete the \-Mol\-Atoms, \-Mol\-Bonds, \-Mol\-Bond\-Angles and \-Mol\-Dihedral\-Angles in the destructor. \end{DoxyCompactList}\item 
virtual void {\bf \-Init\-Ref\-Par\-List} ()
\item 
void {\bf \-Build\-Ring\-List} ()
\begin{DoxyCompactList}\small\item\em \-Build the list of rings in the molecule. \end{DoxyCompactList}\item 
void {\bf \-Build\-Connectivity\-Table} () const 
\begin{DoxyCompactList}\small\item\em \-Build the \-Connectivity table. \end{DoxyCompactList}\item 
void {\bf \-Build\-Rotor\-Group} ()
\begin{DoxyCompactList}\small\item\em \-Build the groups of atoms that will be rotated during global optimization. \end{DoxyCompactList}\item 
void {\bf \-Tune\-Global\-Optim\-Rotation\-Amplitude} ()
\begin{DoxyCompactList}\small\item\em \-Tune the rotation amplitude for free torsions and for the overall \doxyref{\-Molecule}{p.}{a00047} \-Rotation. \end{DoxyCompactList}\item 
void {\bf \-Build\-Flip\-Group} ()
\begin{DoxyCompactList}\small\item\em \-Build the groups of atoms that can be flipped. \end{DoxyCompactList}\item 
void {\bf \-Build\-Stretch\-Mode\-Bond\-Length} ()\label{a00047_abb51819a0eae8b612fb4007ffa16d2b7}

\begin{DoxyCompactList}\small\item\em \-Build the groups of atoms moved when stretching a bond length, while respecting the \doxyref{\-Molecule}{p.}{a00047} restraints. \end{DoxyCompactList}\item 
void {\bf \-Build\-Stretch\-Mode\-Bond\-Angle} ()\label{a00047_a3d507a4e25612a7412cbcc84b5a831ae}

\begin{DoxyCompactList}\small\item\em \-Build the groups of atoms moved when changing a bond angle, while respecting the \doxyref{\-Molecule}{p.}{a00047} restraints. \end{DoxyCompactList}\item 
void {\bf \-Build\-Stretch\-Mode\-Torsion} ()\label{a00047_a18d44782b4141dfab334250967d202ad}

\begin{DoxyCompactList}\small\item\em \-Build the groups of atoms moved when changing a dihedral angle, while respecting the \doxyref{\-Molecule}{p.}{a00047} restraints. \end{DoxyCompactList}\item 
void {\bf \-Build\-Stretch\-Mode\-Twist} ()
\begin{DoxyCompactList}\small\item\em \-Build the groups of atoms used to twist internally the \doxyref{\-Molecule}{p.}{a00047}, e.\-g. \end{DoxyCompactList}\item 
void {\bf \-Build\-Stretch\-Mode\-Groups} ()
\begin{DoxyCompactList}\small\item\em \-Separate \doxyref{\-Stretch\-Mode}{p.}{a00097} that break more than their assigned restraint from others. \end{DoxyCompactList}\item 
void {\bf \-Build\-M\-D\-Atom\-Groups} ()
\begin{DoxyCompactList}\small\item\em \-Find groups of atoms that cannot be moved relatively to each other using the free or non-\/free stretch modes. \end{DoxyCompactList}\item 
void {\bf \-Update\-Scatt\-Comp\-List} () const \label{a00047_a2807a35e4746ca9762c009bedb9d02ef}

\begin{DoxyCompactList}\small\item\em \-Update the \doxyref{\-Molecule\-::m\-Scatt\-Comp\-List}{p.}{a00047_ae681f50b04c32c7139727c675dc04b67} from the cartesian coordinates of all atoms, and the orientation parameters. \end{DoxyCompactList}\item 
void {\bf \-Init\-Options} ()\label{a00047_a15f72c789ad6e4cdae3a667d3d81e7eb}

\begin{DoxyCompactList}\small\item\em \-Build options for this object. \end{DoxyCompactList}\item 
void {\bf \-Reset\-Rigid\-Groups\-Par} () const 
\begin{DoxyCompactList}\small\item\em \-Set the orientation \& translation parameters of all rigid groups to 0, after correcting the atomic positions. \end{DoxyCompactList}\item 
void {\bf \-Flip\-Atom\-Group} (const {\bf \-Flip\-Group} \&)\label{a00047_a69fa14ccb89d13905370e0a75b1e83ff}

\begin{DoxyCompactList}\small\item\em \-Flip a group of atom. \-See \doxyref{\-Molecule\-::\-Flip\-Group}{p.}{a00027}. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsubsection*{\-Public \-Attributes}
\begin{DoxyCompactItemize}
\item 
{\bf \-Scattering\-Component\-List} {\bf m\-Scatt\-Comp\-List}
\begin{DoxyCompactList}\small\item\em \-The list of scattering components. \end{DoxyCompactList}\item 
vector$<$ {\bf \-Mol\-Atom} $\ast$ $>$ {\bf mvp\-Atom}
\begin{DoxyCompactList}\small\item\em \-The list of atoms. \end{DoxyCompactList}\item 
vector$<$ {\bf \-Mol\-Bond} $\ast$ $>$ {\bf mvp\-Bond}
\begin{DoxyCompactList}\small\item\em \-The list of bonds. \end{DoxyCompactList}\item 
vector$<$ {\bf \-Mol\-Bond\-Angle} $\ast$ $>$ {\bf mvp\-Bond\-Angle}
\begin{DoxyCompactList}\small\item\em \-The list of bond angles. \end{DoxyCompactList}\item 
vector$<$ {\bf \-Mol\-Dihedral\-Angle} $\ast$ $>$ {\bf mvp\-Dihedral\-Angle}
\begin{DoxyCompactList}\small\item\em \-The list of dihedral angles. \end{DoxyCompactList}\item 
map$<$ {\bf \-Mol\-Atom} $\ast$, std\-::vector\*
$<$ {\bf \-Mol\-Bond} $\ast$ $>$ $>$ {\bf mv\-Atom\-Bond}
\begin{DoxyCompactList}\small\item\em \-List of \-Bonds for each atom. \end{DoxyCompactList}\item 
std\-::vector$<$ {\bf \-Rigid\-Group} $\ast$ $>$ {\bf mv\-Rigid\-Group}
\begin{DoxyCompactList}\small\item\em \-Rigid groups of atoms. \end{DoxyCompactList}\item 
list$<$ {\bf \-Mol\-Ring} $>$ {\bf mv\-Ring}
\begin{DoxyCompactList}\small\item\em \-The list of rings. \end{DoxyCompactList}\item 
{\bf \-Quaternion} {\bf m\-Quat}
\begin{DoxyCompactList}\small\item\em \-The unit quaternion defining the orientation. \end{DoxyCompactList}\item 
bool {\bf m\-Delete\-Sub\-Obj\-In\-Destructor}
\begin{DoxyCompactList}\small\item\em \-Base \-Rotation amplitude (in radians) for the \doxyref{\-Molecule}{p.}{a00047}, so that the average atomic displacement is equal to 0.\-1 \-A. \end{DoxyCompactList}\item 
\-R\-E\-A\-L {\bfseries m\-Base\-Rotation\-Amplitude}\label{a00047_a1c0fdb65e11dc8c46c525b18826e013c}

\item 
{\bf \-Refinable\-Obj\-Clock} {\bfseries m\-Clock\-Atom\-List}\label{a00047_a813452a36a4706a6590ec8be5e50d691}

\item 
{\bf \-Refinable\-Obj\-Clock} {\bfseries m\-Clock\-Bond\-List}\label{a00047_a4276d3c873b3b0a0c86fbaef9f362403}

\item 
{\bf \-Refinable\-Obj\-Clock} {\bfseries m\-Clock\-Bond\-Angle\-List}\label{a00047_a89305fe20d24689db9cef6165300cb3c}

\item 
{\bf \-Refinable\-Obj\-Clock} {\bfseries m\-Clock\-Dihedral\-Angle\-List}\label{a00047_a52cdc04f8a7e0b60f86c1ec6e1dd9c00}

\item 
{\bf \-Refinable\-Obj\-Clock} {\bfseries m\-Clock\-Rigid\-Group}\label{a00047_a031fb163482a63573aa2c0abb721a40c}

\item 
{\bf \-Refinable\-Obj\-Clock} {\bfseries m\-Clock\-Atom\-Position}\label{a00047_a779328aa75fbd492d25d8f1e78ba3120}

\item 
{\bf \-Refinable\-Obj\-Clock} {\bfseries m\-Clock\-Atom\-Scatt\-Pow}\label{a00047_aaa968c9d6b66e7f43784b6373333939d}

\item 
{\bf \-Refinable\-Obj\-Clock} {\bfseries m\-Clock\-Orientation}\label{a00047_a9bd4e0dabed314962e489a29ed20a33c}

\item 
{\bf \-Refinable\-Obj\-Clock} {\bfseries m\-Clock\-Log\-Likelihood}\label{a00047_a853e81d1fd9916d2a8e6cfee07415f7a}

\item 
{\bf \-Refinable\-Obj\-Clock} {\bfseries m\-Clock\-Connectivity\-Table}\label{a00047_a5ab45bcd6837946dde8ef134874ae02b}

\item 
{\bf \-Refinable\-Obj\-Clock} {\bfseries m\-Clock\-Ring\-List}\label{a00047_ab19b748ec7e4ead2947027b2f38b60e2}

\item 
{\bf \-Refinable\-Obj\-Clock} {\bfseries m\-Clock\-Rotor\-Group}\label{a00047_abdfb80e948dc91137f5c568c99b1554a}

\item 
{\bf \-Refinable\-Obj\-Clock} {\bfseries m\-Clock\-Flip\-Group}\label{a00047_a9654156a7376a5265c6555c23fa7316c}

\item 
{\bf \-Refinable\-Obj\-Clock} {\bfseries m\-Clock\-Stretch\-Mode\-Bond\-Length}\label{a00047_a0320d6fc63fdd2d3454f6c93e21fb82d}

\item 
{\bf \-Refinable\-Obj\-Clock} {\bfseries m\-Clock\-Stretch\-Mode\-Bond\-Angle}\label{a00047_ae641b2ae58267ce842c21e9e2c631a7e}

\item 
{\bf \-Refinable\-Obj\-Clock} {\bfseries m\-Clock\-Stretch\-Mode\-Torsion}\label{a00047_ae932e4a8a69c7fb3422b703854478fc2}

\item 
{\bf \-Refinable\-Obj\-Clock} {\bfseries m\-Clock\-Stretch\-Mode\-Twist}\label{a00047_a83e297fa4cd4f1bebe17b9cf26838b7f}

\item 
{\bf \-Refinable\-Obj\-Clock} {\bfseries m\-Clock\-M\-D\-Atom\-Group}\label{a00047_acaeac88a7cea8c699fecb137337e9f2d}

\item 
unsigned long {\bfseries m\-Local\-Param\-Set}\label{a00047_ad176581e146e508869e67776f0e2e3d2}

\item 
unsigned long {\bfseries m\-Random\-Conform\-Change\-Nb\-Test}\label{a00047_a6fe920696fe0d0f811e35fe677c7b664}

\item 
unsigned long {\bfseries m\-Random\-Conform\-Change\-Nb\-Accept}\label{a00047_a3a52a7e8ab51acbe58c21e5f2fac2f21}

\item 
\-R\-E\-A\-L {\bfseries m\-Random\-Conform\-Change\-Temp}\label{a00047_a78242220a03384972970306eab3c84cc}

\item 
\-R\-E\-A\-L {\bfseries m\-Last\-Log\-Like}\label{a00047_ae424310a32f3ed915c33524e9c325549}

\item 
bool {\bfseries m\-Is\-Self\-Optimizing}\label{a00047_a3a266d6dc8d55ee94717b0f2137f20ad}

\item 
{\bf \-Ref\-Obj\-Opt} {\bf m\-Flex\-Model}
\begin{DoxyCompactList}\small\item\em \-O\-Ption for the different types of flexibility possible for this molecule\-: rigid body, free atoms + restraints, torsion angles... \end{DoxyCompactList}\item 
{\bf \-Ref\-Obj\-Opt} {\bf m\-Auto\-Optimize\-Conformation}
\begin{DoxyCompactList}\small\item\em \-Option to automatically optimize the starting conformation, if the total restraint cost is too high. \end{DoxyCompactList}\item 
{\bf \-Ref\-Obj\-Opt} {\bf m\-Optimize\-Orientation}
\begin{DoxyCompactList}\small\item\em \-Option to optimize the \doxyref{\-Molecule}{p.}{a00047}'s orientation. \end{DoxyCompactList}\item 
{\bf \-Ref\-Obj\-Opt} {\bf m\-Molecule\-Center}\label{a00047_a4ac986f017f968e59af58297b4a50d7f}

\begin{DoxyCompactList}\small\item\em \-Option to choose the center of rotation of the \doxyref{\-Molecule}{p.}{a00047} for the global orientation either as the geometrical center, or as a given atom. \end{DoxyCompactList}\item 
const {\bf \-Mol\-Atom} $\ast$ {\bf mp\-Center\-Atom}\label{a00047_a924f7062c1e35790e152a35166121266}

\begin{DoxyCompactList}\small\item\em \doxyref{\-Atom}{p.}{a00008} chosen as center of rotation, if m\-Rotation\-Center is set to use an atom rather than the geometrical center. \end{DoxyCompactList}\item 
map$<$ {\bf \-Mol\-Atom} $\ast$, set$<$ {\bf \-Mol\-Atom} $\ast$ $>$ $>$ {\bf m\-Connectivity\-Table}
\begin{DoxyCompactList}\small\item\em \-Connectivity table\-: for each atom, keep the list of atoms bonded to it. \end{DoxyCompactList}\item 
list$<$ {\bf \-Rotor\-Group} $>$ {\bf mv\-Rotor\-Group\-Torsion}
\begin{DoxyCompactList}\small\item\em \-List of \-Rotor\-Groups corresponding to free torsion bonds. \end{DoxyCompactList}\item 
list$<$ {\bf \-Rotor\-Group} $>$ {\bf mv\-Rotor\-Group\-Torsion\-Single\-Chain}
\begin{DoxyCompactList}\small\item\em \-List of \-Rotor\-Groups corresponding to free torsion bonds, but with only one chain of atoms listed. \end{DoxyCompactList}\item 
list$<$ {\bf \-Rotor\-Group} $>$ {\bf mv\-Rotor\-Group\-Internal}
\begin{DoxyCompactList}\small\item\em \-List of \-Rotor\-Groups for internal rotations. \end{DoxyCompactList}\item 
list$<$ {\bf \-Flip\-Group} $>$ {\bf mv\-Flip\-Group}\label{a00047_a79ffe8ba3222a5f4a56fd9f2447c8fd7}

\begin{DoxyCompactList}\small\item\em \-The list of \-Flip\-Groups. \end{DoxyCompactList}\item 
list$<$ {\bf \-Stretch\-Mode\-Bond\-Length} $>$ {\bf mv\-Stretch\-Mode\-Bond\-Length}\label{a00047_aa3e38a39a6a392456c03f320e1bdaffa}

\begin{DoxyCompactList}\small\item\em \-List of \doxyref{\-Stretch\-Mode\-Bond\-Length}{p.}{a00099}. \end{DoxyCompactList}\item 
list$<$ {\bf \-Stretch\-Mode\-Bond\-Angle} $>$ {\bf mv\-Stretch\-Mode\-Bond\-Angle}\label{a00047_a5673efb9ae9ffc238f25c62805825c63}

\begin{DoxyCompactList}\small\item\em \-List of \doxyref{\-Stretch\-Mode\-Bond\-Length}{p.}{a00099}. \end{DoxyCompactList}\item 
list$<$ {\bf \-Stretch\-Mode\-Torsion} $>$ {\bf mv\-Stretch\-Mode\-Torsion}\label{a00047_a878336f175d85a68d55804ad43a453dc}

\begin{DoxyCompactList}\small\item\em \-List of \doxyref{\-Stretch\-Mode\-Bond\-Length}{p.}{a00099}. \end{DoxyCompactList}\item 
list$<$ {\bf \-Stretch\-Mode\-Twist} $>$ {\bf mv\-Stretch\-Mode\-Twist}\label{a00047_a53def8e47e265fc3dd62af4b07997bd1}

\begin{DoxyCompactList}\small\item\em \-List of \doxyref{\-Stretch\-Mode\-Twist}{p.}{a00102}. \end{DoxyCompactList}\item 
std\-::list$<$ {\bf \-Stretch\-Mode} $\ast$ $>$ {\bf mvp\-Stretch\-Mode\-Free}\label{a00047_a215591f48317322bb1b9203ebad4a011}

\begin{DoxyCompactList}\small\item\em \-Groups of \doxyref{\-Stretch\-Mode}{p.}{a00097} not breaking any restraint (unless the one they are associated to) \end{DoxyCompactList}\item 
std\-::list$<$ {\bf \-Stretch\-Mode} $\ast$ $>$ {\bf mvp\-Stretch\-Mode\-Not\-Free}\label{a00047_ae87a1cece989dc3d433eb7fad925c5de}

\begin{DoxyCompactList}\small\item\em \-Groups of \doxyref{\-Stretch\-Mode}{p.}{a00097} breaking restraints (beyond the one they are associated to) \end{DoxyCompactList}\item 
list$<$ {\bf \-M\-D\-Atom\-Group} $>$ {\bf mv\-M\-D\-Atom\-Group}\label{a00047_a4a3a91c91753e90de67341701df7e081}

\begin{DoxyCompactList}\small\item\em \-Groups of atoms that should be moved according to molecular dynamics principles. \end{DoxyCompactList}\item 
std\-::set$<$ {\bf \-Mol\-Atom} $\ast$ $>$ {\bf mv\-M\-D\-Full\-Atom\-Group}\label{a00047_af3e1420d9c1c4cc3be0e58c5834130e7}

\begin{DoxyCompactList}\small\item\em \-Full list of atoms that can be moved using molecular dynamics \-This excludes any atom part of a rigid group. \end{DoxyCompactList}\item 
\-R\-E\-A\-L {\bf m\-M\-D\-Move\-Freq}\label{a00047_aee36f14d21f12d10581eaaf689136304}

\begin{DoxyCompactList}\small\item\em \-Frequency of using molecular dynamics move during \doxyref{\-Global\-Opt\-Random\-Move()}{p.}{a00047_a11e623f6482b468f6dd05fc0ab2bbb24} \end{DoxyCompactList}\item 
\-R\-E\-A\-L {\bf m\-M\-D\-Move\-Energy}\label{a00047_a600a62199c1e9297d39a53848a155310}

\begin{DoxyCompactList}\small\item\em \-Relative energy of molecule during molecular dynamics move \-Default\-: 40, 10 (slow conformation change), 200 (large changes) \end{DoxyCompactList}\item 
std\-::vector$<$ {\bf \-Mol\-Z\-Atom} $>$ {\bf m\-As\-Z\-Matrix}\label{a00047_a45e0d1e1d54f4474158f270571957d4a}

\begin{DoxyCompactList}\small\item\em \-The \doxyref{\-Molecule}{p.}{a00047}, as a lightweight \-Z\-Matrix, for export purposes. \end{DoxyCompactList}\item 
\-R\-E\-A\-L {\bf m\-Log\-Likelihood}\label{a00047_aca5a25791960a8aa011c1cfa902c589a}

\begin{DoxyCompactList}\small\item\em \-The current log(likelihood) \end{DoxyCompactList}\item 
\-R\-E\-A\-L {\bf m\-Log\-Likelihood\-Scale}
\begin{DoxyCompactList}\small\item\em \-Scale (multiplier) for the log(likelihood) \end{DoxyCompactList}\item 
\-Cryst\-Vector\-\_\-\-R\-E\-A\-L {\bf m\-L\-S\-Q\-Calc}\label{a00047_a9e9be5fe3d3037cdf690df16235e370d}

\begin{DoxyCompactList}\small\item\em \-Current \-L\-S\-Q \-Calc -\/ one value for each restraint (bond distance, angle or dihedral angle) \end{DoxyCompactList}\item 
\-Cryst\-Vector\-\_\-\-R\-E\-A\-L {\bf m\-L\-S\-Q\-Obs}\label{a00047_a6202acc4d02c90999f008c089bf1b21e}

\begin{DoxyCompactList}\small\item\em \-Current \-L\-S\-Q \-Calc -\/ one value for each restraint (bond distance, angle or dihedral angle ideal values) \end{DoxyCompactList}\item 
\-Cryst\-Vector\-\_\-\-R\-E\-A\-L {\bf m\-L\-S\-Q\-Weight}\label{a00047_a7305a71a61c7ceedaf09b28a0d1ed64d}

\begin{DoxyCompactList}\small\item\em \-Current \-L\-S\-Q \-Calc -\/ one value for each restraint(bond distance, angle or dihedral angle sigmas) \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsubsection{\-Detailed \-Description}
\doxyref{\-Molecule}{p.}{a00047} \-: class for complex scatterer descriptions using cartesian coordinates with bond length/angle restraints, and moves either of individual atoms or using torsion bonds. 

\-This can also be used for non-\/organic compounds (polyhedras etc...) \begin{DoxyNote}{\-Note}
the parametrization is very different from \doxyref{\-Z\-Scatterer}{p.}{a00156}\-: we keep a list of x,y,z which do not use limits (they must not), but the coordinates must be restrained or constrained from the expected bond lengths, angles and dihedral angles. \-The list of parameters is re-\/created in \doxyref{\-Begin\-Optimization()}{p.}{a00047_a5fbdadb37966f382a6e33150285819dc} (except for the global x y z parameters for the global position of the \doxyref{\-Molecule}{p.}{a00047}, in fractionnal coordinates).

\-: all atoms must be somehow connected 
\end{DoxyNote}


\subsubsection{\-Constructor \& \-Destructor \-Documentation}
\index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-Molecule@{\-Molecule}}
\index{\-Molecule@{\-Molecule}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-Molecule}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Obj\-Cryst\-::\-Molecule\-::\-Molecule} (
\begin{DoxyParamCaption}
\item[{{\bf \-Crystal} \&}]{cryst, }
\item[{const string \&}]{name = {\ttfamily \char`\"{}\char`\"{}}}
\end{DoxyParamCaption}
)}\label{a00047_ad4132a293e7f253c730676ed3720f961}


\-Constructor. 

\index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-Molecule@{\-Molecule}}
\index{\-Molecule@{\-Molecule}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-Molecule}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Obj\-Cryst\-::\-Molecule\-::\-Molecule} (
\begin{DoxyParamCaption}
\item[{const {\bf \-Molecule} \&}]{old}
\end{DoxyParamCaption}
)}\label{a00047_a896c80a621aa990de3d36e214965cd49}


\-Copy constructor. 

\index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!$\sim$\-Molecule@{$\sim$\-Molecule}}
\index{$\sim$\-Molecule@{$\sim$\-Molecule}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{$\sim$\-Molecule}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Obj\-Cryst\-::\-Molecule\-::$\sim$\-Molecule} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{a00047_ae61d3a9a72c73cd087e330b3c4cdf0be}


\-Destructor. 



\subsubsection{\-Member \-Function \-Documentation}
\index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-Add\-Atom@{\-Add\-Atom}}
\index{\-Add\-Atom@{\-Add\-Atom}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-Add\-Atom}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf \-Obj\-Cryst\-::\-Molecule\-::\-Add\-Atom} (
\begin{DoxyParamCaption}
\item[{const \-R\-E\-A\-L}]{x, }
\item[{const \-R\-E\-A\-L}]{y, }
\item[{const \-R\-E\-A\-L}]{z, }
\item[{const {\bf \-Scattering\-Power} $\ast$}]{p\-Pow, }
\item[{const string \&}]{name, }
\item[{const bool}]{update\-Display = {\ttfamily true}}
\end{DoxyParamCaption}
)}\label{a00047_a7b193eac062233b758887cba671706f7}


\-Add an atom. 

\index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-Add\-Bond@{\-Add\-Bond}}
\index{\-Add\-Bond@{\-Add\-Bond}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-Add\-Bond}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf \-Obj\-Cryst\-::\-Molecule\-::\-Add\-Bond} (
\begin{DoxyParamCaption}
\item[{{\bf \-Mol\-Atom} \&}]{atom1, }
\item[{{\bf \-Mol\-Atom} \&}]{atom2, }
\item[{const \-R\-E\-A\-L}]{length, }
\item[{const \-R\-E\-A\-L}]{sigma, }
\item[{const \-R\-E\-A\-L}]{delta, }
\item[{const \-R\-E\-A\-L}]{bond\-Order = {\ttfamily 1.}, }
\item[{const bool}]{update\-Display = {\ttfamily true}}
\end{DoxyParamCaption}
)}\label{a00047_aa37feb3abde7ca0ff6453b97d910800f}


\-Add a bond. 

\index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-Add\-Bond\-Angle@{\-Add\-Bond\-Angle}}
\index{\-Add\-Bond\-Angle@{\-Add\-Bond\-Angle}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-Add\-Bond\-Angle}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf \-Obj\-Cryst\-::\-Molecule\-::\-Add\-Bond\-Angle} (
\begin{DoxyParamCaption}
\item[{{\bf \-Mol\-Atom} \&}]{atom1, }
\item[{{\bf \-Mol\-Atom} \&}]{atom2, }
\item[{{\bf \-Mol\-Atom} \&}]{atom3, }
\item[{const \-R\-E\-A\-L}]{angle, }
\item[{const \-R\-E\-A\-L}]{sigma, }
\item[{const \-R\-E\-A\-L}]{delta, }
\item[{const bool}]{update\-Display = {\ttfamily true}}
\end{DoxyParamCaption}
)}\label{a00047_a25132c259da4d0bd739ff0ffc008575e}


\-Add a bond angle restraint. 

\index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-Add\-Dihedral\-Angle@{\-Add\-Dihedral\-Angle}}
\index{\-Add\-Dihedral\-Angle@{\-Add\-Dihedral\-Angle}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-Add\-Dihedral\-Angle}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf \-Obj\-Cryst\-::\-Molecule\-::\-Add\-Dihedral\-Angle} (
\begin{DoxyParamCaption}
\item[{{\bf \-Mol\-Atom} \&}]{atom1, }
\item[{{\bf \-Mol\-Atom} \&}]{atom2, }
\item[{{\bf \-Mol\-Atom} \&}]{atom3, }
\item[{{\bf \-Mol\-Atom} \&}]{atom4, }
\item[{const \-R\-E\-A\-L}]{angle, }
\item[{const \-R\-E\-A\-L}]{sigma, }
\item[{const \-R\-E\-A\-L}]{delta, }
\item[{const bool}]{update\-Display = {\ttfamily true}}
\end{DoxyParamCaption}
)}\label{a00047_aae30adce9fdd16e42cab4f8e434f01cf}


\-Add a dihedral angle restraint. 

\index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-Add\-Rigid\-Group@{\-Add\-Rigid\-Group}}
\index{\-Add\-Rigid\-Group@{\-Add\-Rigid\-Group}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-Add\-Rigid\-Group}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf \-Obj\-Cryst\-::\-Molecule\-::\-Add\-Rigid\-Group} (
\begin{DoxyParamCaption}
\item[{const {\bf \-Rigid\-Group} \&}]{, }
\item[{const bool}]{update\-Display = {\ttfamily true}}
\end{DoxyParamCaption}
)}\label{a00047_a8c61827ad3303aca5c0db6698a5f9e06}


\-Add a rigid group of atoms. 

\-See \doxyref{\-Molecule\-::mv\-Rigid\-Group}{p.}{a00047_a43939b3e3ad83065cf7ccb6065a53a12} \index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-As\-Z\-Matrix@{\-As\-Z\-Matrix}}
\index{\-As\-Z\-Matrix@{\-As\-Z\-Matrix}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-As\-Z\-Matrix}]{\setlength{\rightskip}{0pt plus 5cm}const std\-::vector$<${\bf \-Mol\-Z\-Atom}$>$\& {\bf \-Obj\-Cryst\-::\-Molecule\-::\-As\-Z\-Matrix} (
\begin{DoxyParamCaption}
\item[{const bool}]{keeporder}
\end{DoxyParamCaption}
) const}\label{a00047_a3ce93bef9ea4da4d5e0cd47e62418a97}


\doxyref{\-Molecule}{p.}{a00047} as \-Z-\/matrix. 


\begin{DoxyParams}{\-Parameters}
{\em keeporder,\-:} & if true, the order of the atoms is exactly the same as in the \doxyref{\-Molecule}{p.}{a00047}. \\
\hline
\end{DoxyParams}
\index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-Begin\-Optimization@{\-Begin\-Optimization}}
\index{\-Begin\-Optimization@{\-Begin\-Optimization}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-Begin\-Optimization}]{\setlength{\rightskip}{0pt plus 5cm}virtual void {\bf \-Obj\-Cryst\-::\-Molecule\-::\-Begin\-Optimization} (
\begin{DoxyParamCaption}
\item[{const bool}]{allow\-Approximations = {\ttfamily false}, }
\item[{const bool}]{enable\-Restraints = {\ttfamily false}}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  [virtual]}}\label{a00047_a5fbdadb37966f382a6e33150285819dc}


\-This should be called by any optimization class at the begining of an optimization. 

\-This will also check that everything is ready, eg call the \doxyref{\-Refinable\-Obj\-::\-Prepare()}{p.}{a00071_a48d11671e7f8699f7bc24077585c5e0f} function. \-This also affects all sub-\/objects. \begin{DoxyNote}{\-Note}
this may be called several time for some objects which are used by several other objects, or for nested optimizations (e.\-g. least-\/squares optimizations inside a global one).

\doxyref{\-End\-Optimization()}{p.}{a00047_aec0a3ba0d08fdfed38cc757efb635ffb} must be called at the end of the optimization, the same number of time \doxyref{\-Begin\-Optimization()}{p.}{a00047_a5fbdadb37966f382a6e33150285819dc} was called !
\end{DoxyNote}

\begin{DoxyParams}{\-Parameters}
{\em allow\-Approximations,\-:} & if true, then the object can use faster but less precise functions during the optimization. \-This is useful for global optimization not using derivatives. \\
\hline
{\em enable\-Restraints\-:$\backslash$xrefitem} & deprecated 28. \\
\hline
\end{DoxyParams}


\-Reimplemented from {\bf \-Obj\-Cryst\-::\-Refinable\-Obj} \doxyref{}{p.}{a00071_ababd8f2916e41a20d2c1b21f6ffefe96}.

\index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-Bond\-Angle\-Random\-Change@{\-Bond\-Angle\-Random\-Change}}
\index{\-Bond\-Angle\-Random\-Change@{\-Bond\-Angle\-Random\-Change}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-Bond\-Angle\-Random\-Change}]{\setlength{\rightskip}{0pt plus 5cm}\-R\-E\-A\-L {\bf \-Obj\-Cryst\-::\-Molecule\-::\-Bond\-Angle\-Random\-Change} (
\begin{DoxyParamCaption}
\item[{const {\bf \-Stretch\-Mode\-Bond\-Angle} \&}]{mode, }
\item[{const \-R\-E\-A\-L}]{amplitude, }
\item[{const bool}]{respect\-Restraint = {\ttfamily true}}
\end{DoxyParamCaption}
)}\label{a00047_ad6e27c1557962b32355eeadf1bf155d3}


change a bond angle, while respecting the \doxyref{\-Restraint}{p.}{a00081} (if any). 

\begin{DoxyReturn}{\-Returns}
the {\itshape actual\/} change in bond angle. 
\end{DoxyReturn}

\begin{DoxyParams}{\-Parameters}
{\em } & the desired angular change. \-This will be the actual change {\itshape if\/} there is no restraint {\itshape or\/} if the restraint is constant in this range. \\
\hline
\end{DoxyParams}
\index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-Bond\-Length\-Random\-Change@{\-Bond\-Length\-Random\-Change}}
\index{\-Bond\-Length\-Random\-Change@{\-Bond\-Length\-Random\-Change}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-Bond\-Length\-Random\-Change}]{\setlength{\rightskip}{0pt plus 5cm}\-R\-E\-A\-L {\bf \-Obj\-Cryst\-::\-Molecule\-::\-Bond\-Length\-Random\-Change} (
\begin{DoxyParamCaption}
\item[{const {\bf \-Stretch\-Mode\-Bond\-Length} \&}]{mode, }
\item[{const \-R\-E\-A\-L}]{amplitude, }
\item[{const bool}]{respect\-Restraint = {\ttfamily true}}
\end{DoxyParamCaption}
)}\label{a00047_ad7bfddcdf21c1214c5a70c84fc54cdb0}


\-Stretch a bond, while respecting the \doxyref{\-Restraint}{p.}{a00081} (if any). 

\begin{DoxyReturn}{\-Returns}
the {\itshape actual\/} change in bond length. 
\end{DoxyReturn}

\begin{DoxyParams}{\-Parameters}
{\em } & the desired change in bond length. \-This will be the actual change {\itshape if\/} there is no restraint {\itshape or\/} if the restraint is constant in this range. \\
\hline
\end{DoxyParams}
\index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-Build\-Connectivity\-Table@{\-Build\-Connectivity\-Table}}
\index{\-Build\-Connectivity\-Table@{\-Build\-Connectivity\-Table}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-Build\-Connectivity\-Table}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf \-Obj\-Cryst\-::\-Molecule\-::\-Build\-Connectivity\-Table} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const}\label{a00047_ac52190dc78f14df37e9bc5b3c9d713c2}


\-Build the \-Connectivity table. 

\index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-Build\-Flip\-Group@{\-Build\-Flip\-Group}}
\index{\-Build\-Flip\-Group@{\-Build\-Flip\-Group}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-Build\-Flip\-Group}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf \-Obj\-Cryst\-::\-Molecule\-::\-Build\-Flip\-Group} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{a00047_aca2ed46d26209807d587722d131c6315}


\-Build the groups of atoms that can be flipped. 

\-This is not const because we temporarily modify the molecule conformation to test which \-Flip\-Groups are forbidden by restraints (but it should be const). \index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-Build\-M\-D\-Atom\-Groups@{\-Build\-M\-D\-Atom\-Groups}}
\index{\-Build\-M\-D\-Atom\-Groups@{\-Build\-M\-D\-Atom\-Groups}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-Build\-M\-D\-Atom\-Groups}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf \-Obj\-Cryst\-::\-Molecule\-::\-Build\-M\-D\-Atom\-Groups} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{a00047_a0944a68727d85bee4ec0cce453cb451c}


\-Find groups of atoms that cannot be moved relatively to each other using the free or non-\/free stretch modes. 

\-Usually these will correspond to atoms inside a flexible ring.

\-These atoms (if they are not in a rigid group) are stored in a \doxyref{\-M\-D\-Atom\-Group}{p.}{a00042} so that they can still move using molecular dynamics.

{\bfseries this} should be called after \doxyref{\-Build\-Stretch\-Mode\-Groups()}{p.}{a00047_a83b7b9bac2ce9fe7b310b5267232b1ca}, to make sure the list of free/non-\/free stretch mode has been built. \index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-Build\-Ring\-List@{\-Build\-Ring\-List}}
\index{\-Build\-Ring\-List@{\-Build\-Ring\-List}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-Build\-Ring\-List}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf \-Obj\-Cryst\-::\-Molecule\-::\-Build\-Ring\-List} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{a00047_a9623bff2259d45c162ed28af73974f5a}


\-Build the list of rings in the molecule. 

\-The list is {\itshape only\/} rebuilt if the bond or atom list has changed,so it should be safe to call again this function.

\begin{DoxyNote}{\-Note}
\-So far this is a const method as the ring list just reflects the bond list and therefore is mutable (see \doxyref{\-Molecule\-::mv\-Ring}{p.}{a00047_a35cb61305129b6bbda4a0bb014b2c90e})... but maybe this could change... 
\end{DoxyNote}
\index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-Build\-Rotor\-Group@{\-Build\-Rotor\-Group}}
\index{\-Build\-Rotor\-Group@{\-Build\-Rotor\-Group}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-Build\-Rotor\-Group}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf \-Obj\-Cryst\-::\-Molecule\-::\-Build\-Rotor\-Group} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{a00047_a3642fa8104faa1ce84a977600f9d1aeb}


\-Build the groups of atoms that will be rotated during global optimization. 

\-This is not const because we temporarily modify the molecule conformation to test which \-Rotor\-Groups are forbidden by restraints (but it should be const). \index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-Build\-Stretch\-Mode\-Groups@{\-Build\-Stretch\-Mode\-Groups}}
\index{\-Build\-Stretch\-Mode\-Groups@{\-Build\-Stretch\-Mode\-Groups}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-Build\-Stretch\-Mode\-Groups}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf \-Obj\-Cryst\-::\-Molecule\-::\-Build\-Stretch\-Mode\-Groups} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{a00047_a83b7b9bac2ce9fe7b310b5267232b1ca}


\-Separate \doxyref{\-Stretch\-Mode}{p.}{a00097} that break more than their assigned restraint from others. 

\-See \doxyref{\-Molecule\-::mvp\-Stretch\-Mode\-Free}{p.}{a00047_a215591f48317322bb1b9203ebad4a011} and \doxyref{\-Molecule\-::mvp\-Stretch\-Mode\-Not\-Free}{p.}{a00047_ae87a1cece989dc3d433eb7fad925c5de} \index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-Build\-Stretch\-Mode\-Twist@{\-Build\-Stretch\-Mode\-Twist}}
\index{\-Build\-Stretch\-Mode\-Twist@{\-Build\-Stretch\-Mode\-Twist}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-Build\-Stretch\-Mode\-Twist}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf \-Obj\-Cryst\-::\-Molecule\-::\-Build\-Stretch\-Mode\-Twist} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{a00047_a7f4c6bf6e5be59780cb7844e53711fb3}


\-Build the groups of atoms used to twist internally the \doxyref{\-Molecule}{p.}{a00047}, e.\-g. 

by rotating one chain of atoms between 2 given atoms. \index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-Create\-Copy@{\-Create\-Copy}}
\index{\-Create\-Copy@{\-Create\-Copy}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-Create\-Copy}]{\setlength{\rightskip}{0pt plus 5cm}virtual {\bf \-Molecule}$\ast$ {\bf \-Obj\-Cryst\-::\-Molecule\-::\-Create\-Copy} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily  [virtual]}}\label{a00047_a96728865d25881151b7010d3eaf4ec0f}
so-\/called \-Virtual copy constructor, needed to make copies of arrays of \-Scatterers 

\-Implements {\bf \-Obj\-Cryst\-::\-Scatterer} \doxyref{}{p.}{a00085_a4d374adcff97163a24492d362f6def73}.

\index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-Dihedral\-Angle\-Random\-Change@{\-Dihedral\-Angle\-Random\-Change}}
\index{\-Dihedral\-Angle\-Random\-Change@{\-Dihedral\-Angle\-Random\-Change}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-Dihedral\-Angle\-Random\-Change}]{\setlength{\rightskip}{0pt plus 5cm}\-R\-E\-A\-L {\bf \-Obj\-Cryst\-::\-Molecule\-::\-Dihedral\-Angle\-Random\-Change} (
\begin{DoxyParamCaption}
\item[{const {\bf \-Stretch\-Mode\-Torsion} \&}]{mode, }
\item[{const \-R\-E\-A\-L}]{amplitude, }
\item[{const bool}]{respect\-Restraint = {\ttfamily true}}
\end{DoxyParamCaption}
)}\label{a00047_afd88ae76ab528b5dc37f9d2527353904}


\-Change a dihedral angle, while respecting the \doxyref{\-Restraint}{p.}{a00081} (if any). 

\begin{DoxyReturn}{\-Returns}
the {\itshape actual\/} change in bond angle. 
\end{DoxyReturn}

\begin{DoxyParams}{\-Parameters}
{\em } & the desired angular change. \-This will be the actual change {\itshape if\/} there is no restraint {\itshape or\/} if the restraint is constant in this range. \\
\hline
\end{DoxyParams}
\index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-End\-Optimization@{\-End\-Optimization}}
\index{\-End\-Optimization@{\-End\-Optimization}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-End\-Optimization}]{\setlength{\rightskip}{0pt plus 5cm}virtual void {\bf \-Obj\-Cryst\-::\-Molecule\-::\-End\-Optimization} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  [virtual]}}\label{a00047_aec0a3ba0d08fdfed38cc757efb635ffb}


\-This should be called by any optimization class at the end of an optimization. 

\-This also affects all sub-\/objects. \begin{DoxyNote}{\-Note}
this may be called several time for some objects which are used by several other objects. 
\end{DoxyNote}


\-Reimplemented from {\bf \-Obj\-Cryst\-::\-Refinable\-Obj} \doxyref{}{p.}{a00071_ab0035f6164cb24ace67b51b11993a851}.

\index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-Find\-Atom@{\-Find\-Atom}}
\index{\-Find\-Atom@{\-Find\-Atom}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-Find\-Atom}]{\setlength{\rightskip}{0pt plus 5cm}vector$<${\bf \-Mol\-Atom}$\ast$$>$\-::reverse\-\_\-iterator {\bf \-Obj\-Cryst\-::\-Molecule\-::\-Find\-Atom} (
\begin{DoxyParamCaption}
\item[{const string \&}]{name}
\end{DoxyParamCaption}
)}\label{a00047_a20b6239624acf37e771e29c002f63618}


\-Search a \doxyref{\-Mol\-Atom}{p.}{a00043} from its name. 

\-Search begins at the end, and the first match is returned. returns mv\-Atom.\-rend() if no atom matches \index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-Find\-Atom@{\-Find\-Atom}}
\index{\-Find\-Atom@{\-Find\-Atom}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-Find\-Atom}]{\setlength{\rightskip}{0pt plus 5cm}vector$<${\bf \-Mol\-Atom}$\ast$$>$\-::const\-\_\-reverse\-\_\-iterator {\bf \-Obj\-Cryst\-::\-Molecule\-::\-Find\-Atom} (
\begin{DoxyParamCaption}
\item[{const string \&}]{name}
\end{DoxyParamCaption}
) const}\label{a00047_a10cb2cff89dd623e288cfa3376acfcfa}


\-Search a \doxyref{\-Mol\-Atom}{p.}{a00043} from its name. 

\-Search begins at the end, and the first match is returned. returns mv\-Atom.\-rend() if no atom matches \index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-Find\-Bond@{\-Find\-Bond}}
\index{\-Find\-Bond@{\-Find\-Bond}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-Find\-Bond}]{\setlength{\rightskip}{0pt plus 5cm}vector$<${\bf \-Mol\-Bond}$\ast$$>$\-::const\-\_\-iterator {\bf \-Obj\-Cryst\-::\-Molecule\-::\-Find\-Bond} (
\begin{DoxyParamCaption}
\item[{const {\bf \-Mol\-Atom} \&}]{, }
\item[{const {\bf \-Mol\-Atom} \&}]{}
\end{DoxyParamCaption}
) const}\label{a00047_ac121a84c148439786581a103eef4d958}


\-Searches whether a bond between two atoms already exists. 

\-If no bond is found, returns \-Molecule\-::mvp\-Atom.\-end(). \index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-Find\-Bond@{\-Find\-Bond}}
\index{\-Find\-Bond@{\-Find\-Bond}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-Find\-Bond}]{\setlength{\rightskip}{0pt plus 5cm}vector$<${\bf \-Mol\-Bond}$\ast$$>$\-::iterator {\bf \-Obj\-Cryst\-::\-Molecule\-::\-Find\-Bond} (
\begin{DoxyParamCaption}
\item[{const {\bf \-Mol\-Atom} \&}]{, }
\item[{const {\bf \-Mol\-Atom} \&}]{}
\end{DoxyParamCaption}
)}\label{a00047_a099aadd8edb91f148a174333b1636fb5}


\-Searches whether a bond between two atoms already exists. 

\-If no bond is found, returns \-Molecule\-::mvp\-Atom.\-end(). \index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-Find\-Bond\-Angle@{\-Find\-Bond\-Angle}}
\index{\-Find\-Bond\-Angle@{\-Find\-Bond\-Angle}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-Find\-Bond\-Angle}]{\setlength{\rightskip}{0pt plus 5cm}vector$<${\bf \-Mol\-Bond\-Angle}$\ast$$>$\-::const\-\_\-iterator {\bf \-Obj\-Cryst\-::\-Molecule\-::\-Find\-Bond\-Angle} (
\begin{DoxyParamCaption}
\item[{const {\bf \-Mol\-Atom} \&}]{at1, }
\item[{const {\bf \-Mol\-Atom} \&}]{at0, }
\item[{const {\bf \-Mol\-Atom} \&}]{at2}
\end{DoxyParamCaption}
) const}\label{a00047_aa94113e3d0ca15f5a3acbc573198fd59}


\-Searches whether a bond between three atoms already exists, searching for either (at1,at2,at3) and (at3,at2,at1), as these are equivalent. 

\-If no bond angle is found, returns \-Molecule\-::mvp\-Bond\-Angle.\-end(). \index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-Find\-Dihedral\-Angle@{\-Find\-Dihedral\-Angle}}
\index{\-Find\-Dihedral\-Angle@{\-Find\-Dihedral\-Angle}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-Find\-Dihedral\-Angle}]{\setlength{\rightskip}{0pt plus 5cm}vector$<${\bf \-Mol\-Dihedral\-Angle}$\ast$$>$\-::const\-\_\-iterator {\bf \-Obj\-Cryst\-::\-Molecule\-::\-Find\-Dihedral\-Angle} (
\begin{DoxyParamCaption}
\item[{const {\bf \-Mol\-Atom} \&}]{at1, }
\item[{const {\bf \-Mol\-Atom} \&}]{at2, }
\item[{const {\bf \-Mol\-Atom} \&}]{at3, }
\item[{const {\bf \-Mol\-Atom} \&}]{at4}
\end{DoxyParamCaption}
) const}\label{a00047_adb251aaa9a4f9e4e1b7e949e2fab73e4}


\-Searches whether a dihedral between four atoms already exists, searching for either (at1,at2,at3,at4) and (at4,at3,at2,at1), as these are equivalent. 

\-If no dihedral angle is found, returns \-Molecule\-::mvp\-Dihedral\-Angle.\-end(). \index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-Get\-Center\-Atom@{\-Get\-Center\-Atom}}
\index{\-Get\-Center\-Atom@{\-Get\-Center\-Atom}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-Get\-Center\-Atom}]{\setlength{\rightskip}{0pt plus 5cm}const {\bf \-Mol\-Atom}$\ast$ {\bf \-Obj\-Cryst\-::\-Molecule\-::\-Get\-Center\-Atom} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const}\label{a00047_a58e298d1cefcf677748b9c6807956f4a}


\-Get the atom defining the origin of the \doxyref{\-Molecule}{p.}{a00047} \-Equal to 0 if no atom as been set. 

\index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-Get\-Class\-Name@{\-Get\-Class\-Name}}
\index{\-Get\-Class\-Name@{\-Get\-Class\-Name}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-Get\-Class\-Name}]{\setlength{\rightskip}{0pt plus 5cm}virtual const string\& {\bf \-Obj\-Cryst\-::\-Molecule\-::\-Get\-Class\-Name} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily  [virtual]}}\label{a00047_a7f0f1ae6670032f5afc9ccf65d45f8c4}


\-Name for this class (\char`\"{}\-Refinable\-Obj\char`\"{}, \char`\"{}\-Crystal\char`\"{},...). 

\-This is only useful to distinguish different classes when picking up objects from the \doxyref{\-Refinable\-Obj}{p.}{a00071} \-Global \-Registry 

\-Reimplemented from {\bf \-Obj\-Cryst\-::\-Scatterer} \doxyref{}{p.}{a00085_a374fc1bb2887ab1f61d456326d97c05f}.

\index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-Get\-Component\-Name@{\-Get\-Component\-Name}}
\index{\-Get\-Component\-Name@{\-Get\-Component\-Name}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-Get\-Component\-Name}]{\setlength{\rightskip}{0pt plus 5cm}virtual string {\bf \-Obj\-Cryst\-::\-Molecule\-::\-Get\-Component\-Name} (
\begin{DoxyParamCaption}
\item[{const int}]{i}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily  [virtual]}}\label{a00047_a8dae19447740afaa1780e39a61f625c9}


\-Name for the i-\/th component of this scatterer. 

\-If the component is an \doxyref{\-Atom}{p.}{a00008}, \-Then the name is that of the atom. \-Else, it is the name of the scatterer plus the component number in the scatterer plus the name of the \doxyref{\-Scattering\-Power}{p.}{a00090}. \begin{DoxyNote}{\-Note}
\-It would be better to return a reference, but we don't want to keep a name for all components... \-Weeelll, needs some more thinking... see what performance hit results (if any).
\end{DoxyNote}
\begin{DoxyRefDesc}{\-Bug}
\item[{\bf \-Bug}]does not take into account dummy atoms !! \end{DoxyRefDesc}


\-Implements {\bf \-Obj\-Cryst\-::\-Scatterer} \doxyref{}{p.}{a00085_a42bdf508da6a90859a5a61e16c27d47e}.

\index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-Get\-Log\-Likelihood@{\-Get\-Log\-Likelihood}}
\index{\-Get\-Log\-Likelihood@{\-Get\-Log\-Likelihood}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-Get\-Log\-Likelihood}]{\setlength{\rightskip}{0pt plus 5cm}virtual \-R\-E\-A\-L {\bf \-Obj\-Cryst\-::\-Molecule\-::\-Get\-Log\-Likelihood} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily  [virtual]}}\label{a00047_a1c0e8ad2410035c07c4be88315554f3f}


\-Get -\/log(likelihood) of the current configuration for the object. 

\-By default (no likelihood evaluation available), this is equal to 0.

\-This call should not be recursive, it is the task of the algorithm to get the sum of likelihoods for all objects invlolved.

\begin{DoxyNote}{\-Note}
contrary to the old \char`\"{}\-Cost Function\char`\"{} approach, with log(\-Likelihood) there is no 'choice' of cost function, so that it is the task of the object to give the optimized likelihood (possibly with user options).
\end{DoxyNote}
\begin{DoxyWarning}{\-Warning}
\-: this is in under heavy development, so expect changes... 
\end{DoxyWarning}


\-Reimplemented from {\bf \-Obj\-Cryst\-::\-Refinable\-Obj} \doxyref{}{p.}{a00071_a9a9a5ea2b997cd36b44ed35c2bab3245}.

\index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-Get\-L\-S\-Q\-Deriv@{\-Get\-L\-S\-Q\-Deriv}}
\index{\-Get\-L\-S\-Q\-Deriv@{\-Get\-L\-S\-Q\-Deriv}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-Get\-L\-S\-Q\-Deriv}]{\setlength{\rightskip}{0pt plus 5cm}virtual const \-Cryst\-Vector\-\_\-\-R\-E\-A\-L\& {\bf \-Obj\-Cryst\-::\-Molecule\-::\-Get\-L\-S\-Q\-Deriv} (
\begin{DoxyParamCaption}
\item[{const unsigned int}]{int, }
\item[{{\bf \-Refinable\-Par} \&}]{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  [virtual]}}\label{a00047_adef00ca72bec0e4553bbfba0852e1ba1}


\-Get the first derivative values for the \-L\-S\-Q function, for a given parameter. 

\-Note that the default method in the base \doxyref{\-Refinable\-Obj}{p.}{a00071} class is to use numerical derivatives, so it should be overridden for better precision.

\begin{DoxyRefDesc}{\-Todo}
\item[{\bf \-Todo}]\-This should be a const method, and the given \-Ref\-Par should be const too... \end{DoxyRefDesc}


\-Reimplemented from {\bf \-Obj\-Cryst\-::\-Refinable\-Obj} \doxyref{}{p.}{a00071_a24bfb12849c7733a7034928fbb0b14a8}.

\index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-Get\-Rigid\-Group\-List@{\-Get\-Rigid\-Group\-List}}
\index{\-Get\-Rigid\-Group\-List@{\-Get\-Rigid\-Group\-List}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-Get\-Rigid\-Group\-List}]{\setlength{\rightskip}{0pt plus 5cm}const std\-::vector$<${\bf \-Rigid\-Group} $\ast$$>$\& {\bf \-Obj\-Cryst\-::\-Molecule\-::\-Get\-Rigid\-Group\-List} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const}\label{a00047_aa0e2192321dc993ba78fb84d7502e2eb}


\-List of rigid group of atoms. 

\-See \doxyref{\-Molecule\-::mv\-Rigid\-Group}{p.}{a00047_a43939b3e3ad83065cf7ccb6065a53a12} \index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-Get\-Rigid\-Group\-List@{\-Get\-Rigid\-Group\-List}}
\index{\-Get\-Rigid\-Group\-List@{\-Get\-Rigid\-Group\-List}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-Get\-Rigid\-Group\-List}]{\setlength{\rightskip}{0pt plus 5cm}std\-::vector$<${\bf \-Rigid\-Group} $\ast$$>$\& {\bf \-Obj\-Cryst\-::\-Molecule\-::\-Get\-Rigid\-Group\-List} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{a00047_afab17b6b5416c25a1a89b492017a590c}


\-List of rigid group of atoms. 

\-See \doxyref{\-Molecule\-::mv\-Rigid\-Group}{p.}{a00047_a43939b3e3ad83065cf7ccb6065a53a12} \index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-Get\-Scattering\-Component\-List@{\-Get\-Scattering\-Component\-List}}
\index{\-Get\-Scattering\-Component\-List@{\-Get\-Scattering\-Component\-List}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-Get\-Scattering\-Component\-List}]{\setlength{\rightskip}{0pt plus 5cm}virtual const {\bf \-Scattering\-Component\-List}\& {\bf \-Obj\-Cryst\-::\-Molecule\-::\-Get\-Scattering\-Component\-List} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily  [virtual]}}\label{a00047_a3ac17bd45a709c82d9a4d304fde09b88}


\-Get the list of all scattering components for this scatterer. 

\-This is the most important function of this class, giving the list of scattering positions along with the associated \doxyref{\-Scattering\-Power}{p.}{a00090}. 

\-Implements {\bf \-Obj\-Cryst\-::\-Scatterer} \doxyref{}{p.}{a00085_aca0e08e3793cc69d31fce53e481c2a67}.

\index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-G\-L\-Init\-Display\-List@{\-G\-L\-Init\-Display\-List}}
\index{\-G\-L\-Init\-Display\-List@{\-G\-L\-Init\-Display\-List}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-G\-L\-Init\-Display\-List}]{\setlength{\rightskip}{0pt plus 5cm}virtual void {\bf \-Obj\-Cryst\-::\-Molecule\-::\-G\-L\-Init\-Display\-List} (
\begin{DoxyParamCaption}
\item[{const bool}]{no\-Symmetrics = {\ttfamily false}, }
\item[{const \-R\-E\-A\-L}]{x\-Min = {\ttfamily -\/.1}, }
\item[{const \-R\-E\-A\-L}]{x\-Max = {\ttfamily 1.1}, }
\item[{const \-R\-E\-A\-L}]{y\-Min = {\ttfamily -\/.1}, }
\item[{const \-R\-E\-A\-L}]{y\-Max = {\ttfamily 1.1}, }
\item[{const \-R\-E\-A\-L}]{z\-Min = {\ttfamily -\/.1}, }
\item[{const \-R\-E\-A\-L}]{z\-Max = {\ttfamily 1.1}, }
\item[{const bool}]{display\-Enantiomer = {\ttfamily false}, }
\item[{const bool}]{display\-Names = {\ttfamily false}}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily  [virtual]}}\label{a00047_a00aa7620326d8663b1f4e1bd9237ffb8}
\-Create an \-Open\-G\-L \-Display \-List of the scatterer. \-This should only be called by a \doxyref{\-Crystal}{p.}{a00020} object.


\begin{DoxyParams}{\-Parameters}
{\em no\-Symmetrics,\-:} & if false (the default), then all symmetrics are shown in the 3\-D display, within the limits defined by the min/max parameters $\backslash$ param x\-Min,x\-Max,y\-Min,y\-Max,z\-Min,z\-Max\-: in fractionnal coordinates, the region in which we want scaterrer to be displayed. \-The test is made on the center of the scatterer (eg a \doxyref{\-Z\-Scatterer}{p.}{a00156} (molecule) will not be 'cut' on the border). \\
\hline
{\em display\-Names,\-:} & if true, only the names of the scatterers will be displayed, at the position of the scatterers (to actually see them, they will have to be translated with respect to the drawing of the scatterers). \\
\hline
\end{DoxyParams}


\-Implements {\bf \-Obj\-Cryst\-::\-Scatterer} \doxyref{}{p.}{a00085_a4eaf9cf9780bef83e40155810db120a0}.

\index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-Global\-Opt\-Random\-Move@{\-Global\-Opt\-Random\-Move}}
\index{\-Global\-Opt\-Random\-Move@{\-Global\-Opt\-Random\-Move}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-Global\-Opt\-Random\-Move}]{\setlength{\rightskip}{0pt plus 5cm}virtual void {\bf \-Obj\-Cryst\-::\-Molecule\-::\-Global\-Opt\-Random\-Move} (
\begin{DoxyParamCaption}
\item[{const \-R\-E\-A\-L}]{mutation\-Amplitude, }
\item[{const {\bf \-Ref\-Par\-Type} $\ast$}]{type}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  [virtual]}}\label{a00047_a11e623f6482b468f6dd05fc0ab2bbb24}


\-Make a random move of the current configuration. 

\-This is for global optimization algorithms. the moves for each parameter are less than their global optimization step, multiplied by the mutation amplitude.

\begin{DoxyWarning}{\-Warning}
\-: this makes a random move for the parameter declared for this object, and it is the duty of the object to decide whether the included objects should be moved and how. (eg an algorithm should only call for a move with the top object, and this object decides how he and his sub-\/objects moves). \-By default (\doxyref{\-Refinable\-Obj}{p.}{a00071} implementation) all included objects are moved recursively.
\end{DoxyWarning}
\doxyref{\-Refinable\-Obj}{p.}{a00071}\-:\-: 
\begin{DoxyParams}{\-Parameters}
{\em mutation\-Amplitude,\-:} & multiplier for the maximum move amplitude, for all parameters \\
\hline
{\em type,\-:} & restrain the change exclusively to parameters of a given type (same type or descendant from this \doxyref{\-Ref\-Par\-Type}{p.}{a00080}). \\
\hline
\end{DoxyParams}


\-Reimplemented from {\bf \-Obj\-Cryst\-::\-Refinable\-Obj} \doxyref{}{p.}{a00071_a18375c8525ae38c481ba77e9cf9d67c1}.

\index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-Init\-Ref\-Par\-List@{\-Init\-Ref\-Par\-List}}
\index{\-Init\-Ref\-Par\-List@{\-Init\-Ref\-Par\-List}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-Init\-Ref\-Par\-List}]{\setlength{\rightskip}{0pt plus 5cm}virtual void {\bf \-Obj\-Cryst\-::\-Molecule\-::\-Init\-Ref\-Par\-List} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  [virtual]}}\label{a00047_ad96fe78688ce898dc9aeffcc23523967}
\-Prepare refinable parameters for the scatterer object 

\-Implements {\bf \-Obj\-Cryst\-::\-Scatterer} \doxyref{}{p.}{a00085_a45ef328b68a0a68c0228beefc25cda7f}.

\index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-Molecular\-Dynamics\-Evolve@{\-Molecular\-Dynamics\-Evolve}}
\index{\-Molecular\-Dynamics\-Evolve@{\-Molecular\-Dynamics\-Evolve}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-Molecular\-Dynamics\-Evolve}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf \-Obj\-Cryst\-::\-Molecule\-::\-Molecular\-Dynamics\-Evolve} (
\begin{DoxyParamCaption}
\item[{std\-::map$<$ {\bf \-Mol\-Atom} $\ast$, {\bf \-X\-Y\-Z} $>$ \&}]{v0, }
\item[{const unsigned}]{nb\-Step, }
\item[{const \-R\-E\-A\-L}]{dt, }
\item[{const std\-::vector$<$ {\bf \-Mol\-Bond} $\ast$ $>$ \&}]{vb, }
\item[{const std\-::vector$<$ {\bf \-Mol\-Bond\-Angle} $\ast$ $>$ \&}]{va, }
\item[{const std\-::vector$<$ {\bf \-Mol\-Dihedral\-Angle} $\ast$ $>$ \&}]{vd, }
\item[{std\-::map$<$ {\bf \-Rigid\-Group} $\ast$, std\-::pair$<$ {\bf \-X\-Y\-Z}, {\bf \-X\-Y\-Z} $>$ $>$ \&}]{vr, }
\item[{\-R\-E\-A\-L}]{nrj0 = {\ttfamily 0}}
\end{DoxyParamCaption}
)}\label{a00047_a9a43c803d62dc4f5f3b7852bbd75c939}


\-Change the conformation of the molecule using molecular dynamics principles. 

\-Optionnally, move only a subgroup of atoms and only take into account some restraints.

\-The atoms actually moved are those included as keys in v0, and those part of the rigid bodies in vr.


\begin{DoxyParams}{\-Parameters}
{\em v0,\-:} & initial speed of all atoms. \-On return, includes the new speed coordinates. \-Only the atoms used as keys in v0 will be moved, so this should be used to work only on a subgroup of atoms. \\
\hline
{\em nb\-Step,\-:} & number of steps to perform. \\
\hline
{\em dt,\-:} & time step. \-Recommended value are such that v0[].xyz $\ast$ dt = 0.\-001 \\
\hline
{\em vb,va,vd,\-:} & vector of bond, bond angle and dihedral angle restraints to be taken into account. \-If these are empty, the full list of restraints of the \doxyref{\-Molecule}{p.}{a00047} are taken into account, including rigid groups. \-If they are not empty, then it is assumed that no atom moved belongs to a rigid group. \\
\hline
{\em vr,\-:} & initial speed for the angular and translation parameters of rigid groups included in the evolution. \-For each entry of the map the first \doxyref{\-X\-Y\-Z}{p.}{a00152} coordinates are the speed for \doxyref{\-Rigid\-Group\-::m\-X}{p.}{a00082_abda5125459a21cc5534c90d9516312e9},m\-Y,m\-Z, and the second are the speed for the angular coordinates of the quaternion \-Q1,\-Q2,\-Q3 \\
\hline
{\em nrj0,\-:} & the total energy the system should try to maintain. \-If equal to 0, the initial energy will be used. \-The speed will be de/increased to compensate any energy change. \\
\hline
\end{DoxyParams}
\index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-Optimize\-Conformation@{\-Optimize\-Conformation}}
\index{\-Optimize\-Conformation@{\-Optimize\-Conformation}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-Optimize\-Conformation}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf \-Obj\-Cryst\-::\-Molecule\-::\-Optimize\-Conformation} (
\begin{DoxyParamCaption}
\item[{const long}]{nb\-Trial = {\ttfamily 10000}, }
\item[{const \-R\-E\-A\-L}]{stop\-Cost = {\ttfamily 0.}}
\end{DoxyParamCaption}
)}\label{a00047_a8e070563a06e9c375b3b26d2e5828c54}


\-Minimize configuration from internal restraints (bond lengths, angles and dihedral angles). 

\-Useful when adding manually atoms to get an initial reasonable configuration. \index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-Optimize\-Conformation\-Steepest\-Descent@{\-Optimize\-Conformation\-Steepest\-Descent}}
\index{\-Optimize\-Conformation\-Steepest\-Descent@{\-Optimize\-Conformation\-Steepest\-Descent}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-Optimize\-Conformation\-Steepest\-Descent}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf \-Obj\-Cryst\-::\-Molecule\-::\-Optimize\-Conformation\-Steepest\-Descent} (
\begin{DoxyParamCaption}
\item[{const \-R\-E\-A\-L}]{max\-Step = {\ttfamily 0.1}, }
\item[{const unsigned}]{nb\-Step = {\ttfamily 1}}
\end{DoxyParamCaption}
)}\label{a00047_ac275665ed11daea220ef37154b39bf0d}


\-Optimize the conformation from internal restraints (bond lengths, angles and dihedral angles), using a steepest descent algorithm. 


\begin{DoxyParams}{\-Parameters}
{\em max\-Step,\-:} & maximum displacement allowed along any coordinate for all atoms. \\
\hline
{\em nb\-Step,\-:} & number of steps -\/ the gradient is re-\/calculated after each step. \\
\hline
\end{DoxyParams}
\index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-P\-O\-V\-Ray\-Description@{\-P\-O\-V\-Ray\-Description}}
\index{\-P\-O\-V\-Ray\-Description@{\-P\-O\-V\-Ray\-Description}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-P\-O\-V\-Ray\-Description}]{\setlength{\rightskip}{0pt plus 5cm}virtual ostream\& {\bf \-Obj\-Cryst\-::\-Molecule\-::\-P\-O\-V\-Ray\-Description} (
\begin{DoxyParamCaption}
\item[{ostream \&}]{os, }
\item[{const {\bf \-Crystal\-P\-O\-V\-Ray\-Options} \&}]{options}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily  [virtual]}}\label{a00047_a98bd83a14b359c994be9ab1bf4b8453b}
\-Output a description of the scatterer for \-P\-O\-V\-Ray. \-This should only be called by the \doxyref{\-Crystal}{p.}{a00020} \-Object to which belongs this scatterer. 

\-Implements {\bf \-Obj\-Cryst\-::\-Scatterer} \doxyref{}{p.}{a00085_a708cc857f82c9af4cbdf4d9334449d0f}.

\index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-Randomize\-Configuration@{\-Randomize\-Configuration}}
\index{\-Randomize\-Configuration@{\-Randomize\-Configuration}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-Randomize\-Configuration}]{\setlength{\rightskip}{0pt plus 5cm}virtual void {\bf \-Obj\-Cryst\-::\-Molecule\-::\-Randomize\-Configuration} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  [virtual]}}\label{a00047_aaa76da93619174b17db73de9d2374ac7}


\-Randomize \-Configuration (before a global optimization). 

\-This \-Affects only parameters which are limited and not fixed. \-The randomization also affects all sub-\/objects (recursive). 

\-Reimplemented from {\bf \-Obj\-Cryst\-::\-Refinable\-Obj} \doxyref{}{p.}{a00071_a01b02e566db9aebfd0f9ed2647441f40}.

\index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-Remove\-Atom@{\-Remove\-Atom}}
\index{\-Remove\-Atom@{\-Remove\-Atom}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-Remove\-Atom}]{\setlength{\rightskip}{0pt plus 5cm}vector$<${\bf \-Mol\-Atom}$\ast$$>$\-::iterator {\bf \-Obj\-Cryst\-::\-Molecule\-::\-Remove\-Atom} (
\begin{DoxyParamCaption}
\item[{{\bf \-Mol\-Atom} \&}]{, }
\item[{const bool}]{del = {\ttfamily true}}
\end{DoxyParamCaption}
)}\label{a00047_a7d3d1e583bc7d4beb1a8a6c7f74b4811}


\-Remove an atom. 

\-Returns the iterator to the next atom in the list.

\-This also removes all corresponding bonds, bond angles, etc... \-If del is true (default), then the \doxyref{\-Mol\-Atom}{p.}{a00043} object is deleted. \-The del flag gets sent to the \-Remove\-X\-X\-X functions for the corresponding objects. \index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-Remove\-Bond@{\-Remove\-Bond}}
\index{\-Remove\-Bond@{\-Remove\-Bond}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-Remove\-Bond}]{\setlength{\rightskip}{0pt plus 5cm}vector$<${\bf \-Mol\-Bond}$\ast$$>$\-::iterator {\bf \-Obj\-Cryst\-::\-Molecule\-::\-Remove\-Bond} (
\begin{DoxyParamCaption}
\item[{const {\bf \-Mol\-Bond} \&}]{, }
\item[{const bool}]{del = {\ttfamily true}}
\end{DoxyParamCaption}
)}\label{a00047_ad7cc4b6b9eec26f396fc30c517f37e24}


\-Remove a bond. 

\-Returns the iterator to the next bond in the list.

\-If del is true (default), then the \doxyref{\-Mol\-Bond}{p.}{a00044} object is deleted. \index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-Remove\-Bond\-Angle@{\-Remove\-Bond\-Angle}}
\index{\-Remove\-Bond\-Angle@{\-Remove\-Bond\-Angle}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-Remove\-Bond\-Angle}]{\setlength{\rightskip}{0pt plus 5cm}vector$<${\bf \-Mol\-Bond\-Angle}$\ast$$>$\-::iterator {\bf \-Obj\-Cryst\-::\-Molecule\-::\-Remove\-Bond\-Angle} (
\begin{DoxyParamCaption}
\item[{const {\bf \-Mol\-Bond\-Angle} \&}]{, }
\item[{const bool}]{del = {\ttfamily true}}
\end{DoxyParamCaption}
)}\label{a00047_a113af00d52a1cc225803865a82f35512}


\-Remove a \-Bond\-Angle. 

\-If del is true (default), then the \doxyref{\-Mol\-Bond\-Angle}{p.}{a00045} object is deleted. \index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-Remove\-Dihedral\-Angle@{\-Remove\-Dihedral\-Angle}}
\index{\-Remove\-Dihedral\-Angle@{\-Remove\-Dihedral\-Angle}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-Remove\-Dihedral\-Angle}]{\setlength{\rightskip}{0pt plus 5cm}vector$<${\bf \-Mol\-Dihedral\-Angle}$\ast$$>$\-::iterator {\bf \-Obj\-Cryst\-::\-Molecule\-::\-Remove\-Dihedral\-Angle} (
\begin{DoxyParamCaption}
\item[{const {\bf \-Mol\-Dihedral\-Angle} \&}]{, }
\item[{const bool}]{del = {\ttfamily true}}
\end{DoxyParamCaption}
)}\label{a00047_a3f95dc9df0a1547b07854773179d28be}


\-Remove a dihedral angle. 

\-If del is true (default), then the \doxyref{\-Mol\-Dihedral\-Angle}{p.}{a00046} object is deleted. \index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-Remove\-Rigid\-Group@{\-Remove\-Rigid\-Group}}
\index{\-Remove\-Rigid\-Group@{\-Remove\-Rigid\-Group}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-Remove\-Rigid\-Group}]{\setlength{\rightskip}{0pt plus 5cm}std\-::vector$<${\bf \-Rigid\-Group}$\ast$$>$\-::iterator {\bf \-Obj\-Cryst\-::\-Molecule\-::\-Remove\-Rigid\-Group} (
\begin{DoxyParamCaption}
\item[{const {\bf \-Rigid\-Group} \&}]{group, }
\item[{const bool}]{update\-Display = {\ttfamily true}, }
\item[{const bool}]{del = {\ttfamily true}}
\end{DoxyParamCaption}
)}\label{a00047_a0a2c86a36111f22e07356cac6364632a}


\-Remove a rigid group of atoms. 

\-See \doxyref{\-Molecule\-::mv\-Rigid\-Group}{p.}{a00047_a43939b3e3ad83065cf7ccb6065a53a12}

\-If del is true (default), then the \doxyref{\-Rigid\-Group}{p.}{a00082} object is deleted. \index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-Reset\-Rigid\-Groups\-Par@{\-Reset\-Rigid\-Groups\-Par}}
\index{\-Reset\-Rigid\-Groups\-Par@{\-Reset\-Rigid\-Groups\-Par}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-Reset\-Rigid\-Groups\-Par}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf \-Obj\-Cryst\-::\-Molecule\-::\-Reset\-Rigid\-Groups\-Par} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const}\label{a00047_a9daa98a9b4a992d56e0dba41b104b291}


\-Set the orientation \& translation parameters of all rigid groups to 0, after correcting the atomic positions. 

\-This is {\bfseries required} before saving the structure, as these parameters are not saved. \index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-Rigidify\-With\-Dihedral\-Angles@{\-Rigidify\-With\-Dihedral\-Angles}}
\index{\-Rigidify\-With\-Dihedral\-Angles@{\-Rigidify\-With\-Dihedral\-Angles}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-Rigidify\-With\-Dihedral\-Angles}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf \-Obj\-Cryst\-::\-Molecule\-::\-Rigidify\-With\-Dihedral\-Angles} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{a00047_a560c9ffc36d4874b99eb26c198ee485f}


\-Add dihedral angles so as to rigidify the \doxyref{\-Molecule}{p.}{a00047}. 

\-In practice, for every sequence of atoms \-A-\/\-B-\/\-C-\/\-D, add the dihedral angle defined by these 4 atoms, unless either \-A\-B\-C or \-B\-C\-D are aligned (angle below 10�).

\-No duplicate dihedral angle is generated. \index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-Rotate\-Atom\-Group@{\-Rotate\-Atom\-Group}}
\index{\-Rotate\-Atom\-Group@{\-Rotate\-Atom\-Group}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-Rotate\-Atom\-Group}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf \-Obj\-Cryst\-::\-Molecule\-::\-Rotate\-Atom\-Group} (
\begin{DoxyParamCaption}
\item[{const {\bf \-Mol\-Atom} \&}]{at1, }
\item[{const {\bf \-Mol\-Atom} \&}]{at2, }
\item[{const set$<$ {\bf \-Mol\-Atom} $\ast$ $>$ \&}]{atoms, }
\item[{const \-R\-E\-A\-L}]{angle, }
\item[{const bool}]{keep\-Center = {\ttfamily true}}
\end{DoxyParamCaption}
)}\label{a00047_a9bd595a0ad88d6832718f3bffb452866}


\-Rotate a group of atoms around an axis defined by two atoms. 


\begin{DoxyParams}{\-Parameters}
{\em keep\-Center,\-:} & if true, the coordinates of the molecule are modified so that only the rotated atoms are moved. \\
\hline
\end{DoxyParams}
\index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-Rotate\-Atom\-Group@{\-Rotate\-Atom\-Group}}
\index{\-Rotate\-Atom\-Group@{\-Rotate\-Atom\-Group}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-Rotate\-Atom\-Group}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf \-Obj\-Cryst\-::\-Molecule\-::\-Rotate\-Atom\-Group} (
\begin{DoxyParamCaption}
\item[{const {\bf \-Mol\-Atom} \&}]{at, }
\item[{const \-R\-E\-A\-L}]{vx, }
\item[{const \-R\-E\-A\-L}]{vy, }
\item[{const \-R\-E\-A\-L}]{vz, }
\item[{const set$<$ {\bf \-Mol\-Atom} $\ast$ $>$ \&}]{atoms, }
\item[{const \-R\-E\-A\-L}]{angle, }
\item[{const bool}]{keep\-Center = {\ttfamily true}}
\end{DoxyParamCaption}
)}\label{a00047_a84e93db5b81b90fd5befa22caaf8691c}


\-Rotate a group of atoms around an axis defined by one atom and a vector. 


\begin{DoxyParams}{\-Parameters}
{\em keep\-Center,\-:} & if true, the coordinates of the molecule are modified so that only the rotated atoms are moved. \\
\hline
\end{DoxyParams}
\index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-Set\-Center\-Atom@{\-Set\-Center\-Atom}}
\index{\-Set\-Center\-Atom@{\-Set\-Center\-Atom}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-Set\-Center\-Atom}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf \-Obj\-Cryst\-::\-Molecule\-::\-Set\-Center\-Atom} (
\begin{DoxyParamCaption}
\item[{const {\bf \-Mol\-Atom} \&}]{at}
\end{DoxyParamCaption}
)}\label{a00047_a24043736cd4323a31b7bc0fa6fa166da}


\-Get the atom defining the origin of the \doxyref{\-Molecule}{p.}{a00047} \-Equal to 0 if no atom as been set. 

\index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-Set\-Delete\-Sub\-Obj\-In\-Destructor@{\-Set\-Delete\-Sub\-Obj\-In\-Destructor}}
\index{\-Set\-Delete\-Sub\-Obj\-In\-Destructor@{\-Set\-Delete\-Sub\-Obj\-In\-Destructor}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-Set\-Delete\-Sub\-Obj\-In\-Destructor}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf \-Obj\-Cryst\-::\-Molecule\-::\-Set\-Delete\-Sub\-Obj\-In\-Destructor} (
\begin{DoxyParamCaption}
\item[{const bool}]{b}
\end{DoxyParamCaption}
)}\label{a00047_a19afb1f15773fed7a2d9dff35820bafd}


\-Set whether to delete the \-Mol\-Atoms, \-Mol\-Bonds, \-Mol\-Bond\-Angles and \-Mol\-Dihedral\-Angles in the destructor. 

\-By default these sub-\/objects are deleted. \index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-Tag\-New\-Best\-Config@{\-Tag\-New\-Best\-Config}}
\index{\-Tag\-New\-Best\-Config@{\-Tag\-New\-Best\-Config}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-Tag\-New\-Best\-Config}]{\setlength{\rightskip}{0pt plus 5cm}virtual void {\bf \-Obj\-Cryst\-::\-Molecule\-::\-Tag\-New\-Best\-Config} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily  [virtual]}}\label{a00047_a91e2f80f1e4526fbb6cd99f5b229db9e}


\-During a global optimization, tells the object that the current config is the latest \char`\"{}best\char`\"{} config. 

\-This can be used by the object to make more intellingent random moves (use with caution\-: highly experimental !). 

\-Reimplemented from {\bf \-Obj\-Cryst\-::\-Refinable\-Obj} \doxyref{}{p.}{a00071_a3cb4cc924d39576618184eccd4321cf6}.

\index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-Translate\-Atom\-Group@{\-Translate\-Atom\-Group}}
\index{\-Translate\-Atom\-Group@{\-Translate\-Atom\-Group}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-Translate\-Atom\-Group}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf \-Obj\-Cryst\-::\-Molecule\-::\-Translate\-Atom\-Group} (
\begin{DoxyParamCaption}
\item[{const set$<$ {\bf \-Mol\-Atom} $\ast$ $>$ \&}]{atoms, }
\item[{const \-R\-E\-A\-L}]{dx, }
\item[{const \-R\-E\-A\-L}]{dy, }
\item[{const \-R\-E\-A\-L}]{dz, }
\item[{const bool}]{keep\-Center = {\ttfamily true}}
\end{DoxyParamCaption}
)}\label{a00047_a0d3122b53dd81aa23d2aaa2427e6291e}


\-Translate a group of atoms in a given direction. 


\begin{DoxyParams}{\-Parameters}
{\em keep\-Center,\-:} & if true, the coordinates of the molecule are modified so that only the translated atoms are moved. \\
\hline
\end{DoxyParams}
\index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-Tune\-Global\-Optim\-Rotation\-Amplitude@{\-Tune\-Global\-Optim\-Rotation\-Amplitude}}
\index{\-Tune\-Global\-Optim\-Rotation\-Amplitude@{\-Tune\-Global\-Optim\-Rotation\-Amplitude}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-Tune\-Global\-Optim\-Rotation\-Amplitude}]{\setlength{\rightskip}{0pt plus 5cm}void {\bf \-Obj\-Cryst\-::\-Molecule\-::\-Tune\-Global\-Optim\-Rotation\-Amplitude} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{a00047_a9cc198b9cb896d28c7bd90a775db4ec2}


\-Tune the rotation amplitude for free torsions and for the overall \doxyref{\-Molecule}{p.}{a00047} \-Rotation. 

\-This should be done after \doxyref{\-Molecule\-::\-Build\-Rotor\-Group()}{p.}{a00047_a3642fa8104faa1ce84a977600f9d1aeb}; \index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-Update\-Display@{\-Update\-Display}}
\index{\-Update\-Display@{\-Update\-Display}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-Update\-Display}]{\setlength{\rightskip}{0pt plus 5cm}virtual void {\bf \-Obj\-Cryst\-::\-Molecule\-::\-Update\-Display} (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily  [virtual]}}\label{a00047_af1ae2c4f9febbe16019987f807271b58}


\-If there is an interface, this should be automatically be called each time there is a 'new, significant' configuration to report. 



\-Reimplemented from {\bf \-Obj\-Cryst\-::\-Refinable\-Obj} \doxyref{}{p.}{a00071_ab74e2cead734fe1e652c5add46c5e116}.

\index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-X\-M\-L\-Input@{\-X\-M\-L\-Input}}
\index{\-X\-M\-L\-Input@{\-X\-M\-L\-Input}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-X\-M\-L\-Input}]{\setlength{\rightskip}{0pt plus 5cm}virtual void {\bf \-Obj\-Cryst\-::\-Molecule\-::\-X\-M\-L\-Input} (
\begin{DoxyParamCaption}
\item[{istream \&}]{is, }
\item[{const {\bf \-X\-M\-L\-Cryst\-Tag} \&}]{tag}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  [virtual]}}\label{a00047_a701f78d93d495d1102d0bd26700c4a3d}


\-Input \-From stream. 

\begin{DoxyRefDesc}{\-Todo}
\item[{\bf \-Todo}]\-Add an bool \-X\-M\-L\-Input\-Tag(is,tag) function to recognize all the tags from the stream. \-So that each inherited class can use the \-X\-M\-L\-Input\-Tag function from its parent (ie take advantage of inheritance). \-The children class would first try to interpret the tag, then if unsuccessful would pass it to its parent (thus allowing overloading), etc... \end{DoxyRefDesc}


\-Reimplemented from {\bf \-Obj\-Cryst\-::\-Refinable\-Obj} \doxyref{}{p.}{a00071_ac13a4045c3f187879443c8615c38d623}.

\index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!\-X\-M\-L\-Output@{\-X\-M\-L\-Output}}
\index{\-X\-M\-L\-Output@{\-X\-M\-L\-Output}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{\-X\-M\-L\-Output}]{\setlength{\rightskip}{0pt plus 5cm}virtual void {\bf \-Obj\-Cryst\-::\-Molecule\-::\-X\-M\-L\-Output} (
\begin{DoxyParamCaption}
\item[{ostream \&}]{os, }
\item[{int}]{indent = {\ttfamily 0}}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily  [virtual]}}\label{a00047_a47762abe37f3e8f7378b7210916e71ea}


\-Output to stream in well-\/formed \-X\-M\-L. 

\begin{DoxyRefDesc}{\-Todo}
\item[{\bf \-Todo}]\-Use inheritance.. as for \-X\-M\-L\-Input\-Tag()... \end{DoxyRefDesc}


\-Reimplemented from {\bf \-Obj\-Cryst\-::\-Refinable\-Obj} \doxyref{}{p.}{a00071_a7b9b6ed0f8dcf753d398c35e073de973}.



\subsubsection{\-Member \-Data \-Documentation}
\index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!m\-Auto\-Optimize\-Conformation@{m\-Auto\-Optimize\-Conformation}}
\index{m\-Auto\-Optimize\-Conformation@{m\-Auto\-Optimize\-Conformation}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{m\-Auto\-Optimize\-Conformation}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Ref\-Obj\-Opt} {\bf \-Obj\-Cryst\-::\-Molecule\-::m\-Auto\-Optimize\-Conformation}}\label{a00047_ae8459b9f767b0d8bc27b05140c604e0c}


\-Option to automatically optimize the starting conformation, if the total restraint cost is too high. 

\-This is done in \doxyref{\-Begin\-Optimization()}{p.}{a00047_a5fbdadb37966f382a6e33150285819dc}.

\-This is enabled by default, and should be disabled by people who already supply a good starting conformation for their molecule. \index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!m\-Connectivity\-Table@{m\-Connectivity\-Table}}
\index{m\-Connectivity\-Table@{m\-Connectivity\-Table}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{m\-Connectivity\-Table}]{\setlength{\rightskip}{0pt plus 5cm}map$<${\bf \-Mol\-Atom} $\ast$,set$<${\bf \-Mol\-Atom} $\ast$$>$ $>$ {\bf \-Obj\-Cryst\-::\-Molecule\-::m\-Connectivity\-Table}\hspace{0.3cm}{\ttfamily  [mutable]}}\label{a00047_a13cffa530711a868859cfcfc17bce069}


\-Connectivity table\-: for each atom, keep the list of atoms bonded to it. 

\-All atoms are referenced from their index. \index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!m\-Delete\-Sub\-Obj\-In\-Destructor@{m\-Delete\-Sub\-Obj\-In\-Destructor}}
\index{m\-Delete\-Sub\-Obj\-In\-Destructor@{m\-Delete\-Sub\-Obj\-In\-Destructor}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{m\-Delete\-Sub\-Obj\-In\-Destructor}]{\setlength{\rightskip}{0pt plus 5cm}bool {\bf \-Obj\-Cryst\-::\-Molecule\-::m\-Delete\-Sub\-Obj\-In\-Destructor}}\label{a00047_a5b35796cbf31728b39b82c36badaa97b}


\-Base \-Rotation amplitude (in radians) for the \doxyref{\-Molecule}{p.}{a00047}, so that the average atomic displacement is equal to 0.\-1 \-A. 

\-Default=0.\-02$\ast$pi \index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!m\-Flex\-Model@{m\-Flex\-Model}}
\index{m\-Flex\-Model@{m\-Flex\-Model}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{m\-Flex\-Model}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Ref\-Obj\-Opt} {\bf \-Obj\-Cryst\-::\-Molecule\-::m\-Flex\-Model}}\label{a00047_a35881bfb20092d0dcc424553f5671245}


\-O\-Ption for the different types of flexibility possible for this molecule\-: rigid body, free atoms + restraints, torsion angles... 

\begin{DoxyWarning}{\-Warning}
still \-E\-X\-P\-E\-R\-I\-M\-E\-N\-T\-A\-L ! 
\end{DoxyWarning}
\index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!m\-Log\-Likelihood\-Scale@{m\-Log\-Likelihood\-Scale}}
\index{m\-Log\-Likelihood\-Scale@{m\-Log\-Likelihood\-Scale}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{m\-Log\-Likelihood\-Scale}]{\setlength{\rightskip}{0pt plus 5cm}\-R\-E\-A\-L {\bf \-Obj\-Cryst\-::\-Molecule\-::m\-Log\-Likelihood\-Scale}}\label{a00047_a7e69eecc5aa10a9908c3a6450cc2540b}


\-Scale (multiplier) for the log(likelihood) 

\-Changing this scale is equivalent to changing the sigma values of all bonds, bond angles and dihedral angles -\/ but it allows a simple global scaling for the user. \index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!m\-Optimize\-Orientation@{m\-Optimize\-Orientation}}
\index{m\-Optimize\-Orientation@{m\-Optimize\-Orientation}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{m\-Optimize\-Orientation}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Ref\-Obj\-Opt} {\bf \-Obj\-Cryst\-::\-Molecule\-::m\-Optimize\-Orientation}}\label{a00047_a8c82ea548f4c0f29e868776c88c5eab8}


\-Option to optimize the \doxyref{\-Molecule}{p.}{a00047}'s orientation. 

\-Useful to completely fix the \doxyref{\-Molecule}{p.}{a00047}. \index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!m\-Quat@{m\-Quat}}
\index{m\-Quat@{m\-Quat}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{m\-Quat}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Quaternion} {\bf \-Obj\-Cryst\-::\-Molecule\-::m\-Quat}}\label{a00047_a61b83701b288c4fdbcda97b14608af7d}


\-The unit quaternion defining the orientation. 

\index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!m\-Scatt\-Comp\-List@{m\-Scatt\-Comp\-List}}
\index{m\-Scatt\-Comp\-List@{m\-Scatt\-Comp\-List}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{m\-Scatt\-Comp\-List}]{\setlength{\rightskip}{0pt plus 5cm}{\bf \-Scattering\-Component\-List} {\bf \-Obj\-Cryst\-::\-Molecule\-::m\-Scatt\-Comp\-List}\hspace{0.3cm}{\ttfamily  [mutable]}}\label{a00047_ae681f50b04c32c7139727c675dc04b67}


\-The list of scattering components. 

this is mutable since it only reflects the list of atoms. \index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!mv\-Atom\-Bond@{mv\-Atom\-Bond}}
\index{mv\-Atom\-Bond@{mv\-Atom\-Bond}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{mv\-Atom\-Bond}]{\setlength{\rightskip}{0pt plus 5cm}map$<${\bf \-Mol\-Atom}$\ast$ , std\-::vector$<${\bf \-Mol\-Bond}$\ast$$>$ $>$ {\bf \-Obj\-Cryst\-::\-Molecule\-::mv\-Atom\-Bond}}\label{a00047_ad67f767fe62aeef49aef1c5760d69294}


\-List of \-Bonds for each atom. 

\-This duplicates the information in \-Molecule\-::mv\-Bond \index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!mvp\-Atom@{mvp\-Atom}}
\index{mvp\-Atom@{mvp\-Atom}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{mvp\-Atom}]{\setlength{\rightskip}{0pt plus 5cm}vector$<${\bf \-Mol\-Atom}$\ast$$>$ {\bf \-Obj\-Cryst\-::\-Molecule\-::mvp\-Atom}}\label{a00047_ad498c51ecf4ee0b4482e5fe41cd52be7}


\-The list of atoms. 

\index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!mvp\-Bond@{mvp\-Bond}}
\index{mvp\-Bond@{mvp\-Bond}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{mvp\-Bond}]{\setlength{\rightskip}{0pt plus 5cm}vector$<${\bf \-Mol\-Bond}$\ast$$>$ {\bf \-Obj\-Cryst\-::\-Molecule\-::mvp\-Bond}}\label{a00047_aabf6e0daf6f90f4052a44888f2bc3d7b}


\-The list of bonds. 

\index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!mvp\-Bond\-Angle@{mvp\-Bond\-Angle}}
\index{mvp\-Bond\-Angle@{mvp\-Bond\-Angle}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{mvp\-Bond\-Angle}]{\setlength{\rightskip}{0pt plus 5cm}vector$<${\bf \-Mol\-Bond\-Angle}$\ast$$>$ {\bf \-Obj\-Cryst\-::\-Molecule\-::mvp\-Bond\-Angle}}\label{a00047_a9c195054308e17604a24a3127e0cb307}


\-The list of bond angles. 

\index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!mvp\-Dihedral\-Angle@{mvp\-Dihedral\-Angle}}
\index{mvp\-Dihedral\-Angle@{mvp\-Dihedral\-Angle}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{mvp\-Dihedral\-Angle}]{\setlength{\rightskip}{0pt plus 5cm}vector$<${\bf \-Mol\-Dihedral\-Angle}$\ast$$>$ {\bf \-Obj\-Cryst\-::\-Molecule\-::mvp\-Dihedral\-Angle}}\label{a00047_a21384a0b8be7bf3fc539c57d90d5c9a2}


\-The list of dihedral angles. 

\index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!mv\-Rigid\-Group@{mv\-Rigid\-Group}}
\index{mv\-Rigid\-Group@{mv\-Rigid\-Group}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{mv\-Rigid\-Group}]{\setlength{\rightskip}{0pt plus 5cm}std\-::vector$<${\bf \-Rigid\-Group}$\ast$$>$ {\bf \-Obj\-Cryst\-::\-Molecule\-::mv\-Rigid\-Group}}\label{a00047_a43939b3e3ad83065cf7ccb6065a53a12}


\-Rigid groups of atoms. 

\-This group will be kept {\itshape strictly\/} rigid, preventing the use of any stretch mode altering their relative position. \-The entire group of atoms can however be rotated or translated. \index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!mv\-Ring@{mv\-Ring}}
\index{mv\-Ring@{mv\-Ring}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{mv\-Ring}]{\setlength{\rightskip}{0pt plus 5cm}list$<${\bf \-Mol\-Ring}$>$ {\bf \-Obj\-Cryst\-::\-Molecule\-::mv\-Ring}\hspace{0.3cm}{\ttfamily  [mutable]}}\label{a00047_a35cb61305129b6bbda4a0bb014b2c90e}


\-The list of rings. 

\begin{DoxyNote}{\-Note}
this only reflects the bond list, so it is mutable. 
\end{DoxyNote}
\index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!mv\-Rotor\-Group\-Internal@{mv\-Rotor\-Group\-Internal}}
\index{mv\-Rotor\-Group\-Internal@{mv\-Rotor\-Group\-Internal}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{mv\-Rotor\-Group\-Internal}]{\setlength{\rightskip}{0pt plus 5cm}list$<${\bf \-Rotor\-Group}$>$ {\bf \-Obj\-Cryst\-::\-Molecule\-::mv\-Rotor\-Group\-Internal}\hspace{0.3cm}{\ttfamily  [mutable]}}\label{a00047_ac54d8a074549f7710a1823b0ecefcde8}


\-List of \-Rotor\-Groups for internal rotations. 

\-This lists groups of atoms that can be rotated {\itshape between\/} two given atoms. \-This is useful to alter the conformation of large rings, where no free torsion bonds exists, and also for long flexible chains. \index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!mv\-Rotor\-Group\-Torsion@{mv\-Rotor\-Group\-Torsion}}
\index{mv\-Rotor\-Group\-Torsion@{mv\-Rotor\-Group\-Torsion}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{mv\-Rotor\-Group\-Torsion}]{\setlength{\rightskip}{0pt plus 5cm}list$<${\bf \-Rotor\-Group}$>$ {\bf \-Obj\-Cryst\-::\-Molecule\-::mv\-Rotor\-Group\-Torsion}\hspace{0.3cm}{\ttfamily  [mutable]}}\label{a00047_afc51d36109a8d96a626f3c2251345c13}


\-List of \-Rotor\-Groups corresponding to free torsion bonds. 

\-In this list are list of atoms on one side of a bond, that can be rotated freely around this bond. \-Each bond is listed only once, with the side which has the smallest number of atoms. \index{\-Obj\-Cryst\-::\-Molecule@{\-Obj\-Cryst\-::\-Molecule}!mv\-Rotor\-Group\-Torsion\-Single\-Chain@{mv\-Rotor\-Group\-Torsion\-Single\-Chain}}
\index{mv\-Rotor\-Group\-Torsion\-Single\-Chain@{mv\-Rotor\-Group\-Torsion\-Single\-Chain}!ObjCryst::Molecule@{\-Obj\-Cryst\-::\-Molecule}}
\paragraph[{mv\-Rotor\-Group\-Torsion\-Single\-Chain}]{\setlength{\rightskip}{0pt plus 5cm}list$<${\bf \-Rotor\-Group}$>$ {\bf \-Obj\-Cryst\-::\-Molecule\-::mv\-Rotor\-Group\-Torsion\-Single\-Chain}\hspace{0.3cm}{\ttfamily  [mutable]}}\label{a00047_a22a07ddc2dbfeb90238b29bcca1e915d}


\-List of \-Rotor\-Groups corresponding to free torsion bonds, but with only one chain of atoms listed. 

\-The difference with \-Molecule\-::m\-Rotor\-Group\-Torsion is that if the bond is \-A-\/\-B, with atom \-A linked with atoms \-A1,\-A2,\-A3, in this list only one chain (starting either from \-A1, \-A2 or \-A3) will be rotated, instead of the 3 chains. \-This is useful when searching for the absolute configuration of atoms. 

\-The documentation for this class was generated from the following file\-:\begin{DoxyCompactItemize}
\item 
\-Molecule.\-h\end{DoxyCompactItemize}
